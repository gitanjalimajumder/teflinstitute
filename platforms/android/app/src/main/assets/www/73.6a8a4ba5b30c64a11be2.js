(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{KBMx:function(e,o,t){"use strict";t.r(o),t.d(o,"AddonStorageManagerLazyModule",(function(){return R}));var n=t("tyNb"),a=t("L3Fv"),i=t("mrSG"),r=t("BaYo"),c=t("ULAo"),d=t("GBcW"),s=t("zbKZ"),l=t("Xzvb"),g=t("1gmh"),_=t("SV+s"),u=t("pHTc"),h=t("9+EE"),m=t("3LXp"),f=t("j3ag"),S=t("Wsfw"),p=t("fjkH"),C=t("fXoL"),b=t("TEn/"),D=t("nt/U"),M=t("PgjG"),P=t("ofXK"),w=t("ACYt"),v=t("3CSS"),O=t("sYmb"),I=t("1iFe");function AddonStorageManagerCoursesStoragePage_div_11_Template(e,o){1&e&&(C.Ec(0,"div",6),C.Ec(1,"h2"),C.pd(2),C.Pc(3,"translate"),C.Dc(),C.Dc()),2&e&&(C.lc(2),C.qd(C.Qc(3,1,"addon.storagemanager.alldata")))}function AddonStorageManagerCoursesStoragePage_ion_card_12_ion_badge_6_Template(e,o){if(1&e&&(C.Ec(0,"ion-badge",9),C.pd(1),C.Pc(2,"coreBytesToSize"),C.Dc()),2&e){const e=C.Oc(2);C.lc(1),C.qd(C.Qc(2,1,e.spaceUsage.spaceUsage))}}function AddonStorageManagerCoursesStoragePage_ion_card_12_Template(e,o){if(1&e){const e=C.Fc();C.Ec(0,"ion-card"),C.Ec(1,"ion-item",13),C.Ec(2,"ion-label"),C.Ec(3,"p",14),C.pd(4),C.Pc(5,"translate"),C.Dc(),C.nd(6,AddonStorageManagerCoursesStoragePage_ion_card_12_ion_badge_6_Template,3,3,"ion-badge",15),C.Dc(),C.Ec(7,"ion-button",16),C.Mc("click",(function AddonStorageManagerCoursesStoragePage_ion_card_12_Template_ion_button_click_7_listener(o){C.fd(e);return C.Oc().deleteSiteStorage(o)})),C.Pc(8,"translate"),C.zc(9,"ion-icon",17),C.Dc(),C.Dc(),C.Dc()}if(2&e){const e=C.Oc();C.lc(4),C.qd(C.Qc(5,4,"addon.storagemanager.totalspaceusage")),C.lc(2),C.Vc("ngIf",e.spaceUsage.spaceUsage),C.lc(1),C.Vc("hidden",e.spaceUsage.spaceUsage+e.spaceUsage.cacheEntries<=0),C.mc("aria-label",C.Qc(8,6,"addon.storagemanager.deleteallsitedata"))}}function AddonStorageManagerCoursesStoragePage_ion_item_29_p_4_Template(e,o){1&e&&(C.Ec(0,"p",22),C.pd(1),C.Pc(2,"translate"),C.Dc()),2&e&&(C.lc(1),C.rd(" ",C.Qc(2,1,"core.downloading")," "))}const _c0=function(e){return{name:e}};function AddonStorageManagerCoursesStoragePage_ion_item_29_Template(e,o){if(1&e){const e=C.Fc();C.Ec(0,"ion-item",18),C.Mc("click",(function AddonStorageManagerCoursesStoragePage_ion_item_29_Template_ion_item_click_0_listener(){C.fd(e);const t=o.$implicit;return C.Oc().openCourse(t.id,t.title)})),C.Ec(1,"ion-label",19),C.Ec(2,"p",8),C.pd(3),C.Dc(),C.nd(4,AddonStorageManagerCoursesStoragePage_ion_item_29_p_4_Template,3,3,"p",20),C.Ec(5,"ion-badge",9),C.pd(6),C.Pc(7,"coreBytesToSize"),C.Dc(),C.Dc(),C.Ec(8,"ion-button",10),C.Mc("click",(function AddonStorageManagerCoursesStoragePage_ion_item_29_Template_ion_button_click_8_listener(t){C.fd(e);const n=o.$implicit;return C.Oc().deleteCourse(t,n)})),C.zc(9,"ion-icon",21),C.Pc(10,"translate"),C.Dc(),C.Dc()}if(2&e){const e=o.$implicit;C.lc(3),C.qd(e.title),C.lc(1),C.Vc("ngIf",e.isDownloading),C.lc(2),C.rd(" ",C.Qc(7,5,e.totalSize)," "),C.lc(2),C.Vc("disabled",e.isDownloading),C.lc(1),C.mc("aria-label",C.Rc(10,7,"addon.storagemanager.deletedatafrom",C.ad(10,_c0,e.title)))}}let y=(()=>{class AddonStorageManagerCoursesStoragePage{constructor(){this.userCourses=[],this.downloadedCourses=[],this.completelyDownloadedCourses=[],this.totalSize=0,this.loaded=!1,this.spaceUsage={cacheEntries:0,spaceUsage:0},this.siteId=h.b.getCurrentSiteId()}ngOnInit(){return Object(i.a)(this,void 0,void 0,(function*(){this.userCourses=yield l.a.getUserCourses(),this.courseStatusObserver=p.b.on(p.b.COURSE_STATUS_CHANGED,(({courseId:e,status:o})=>this.onCourseUpdated(e,o)));const e=yield c.a.getDownloadedCourseIds(),o=yield Promise.all(this.userCourses.filter((o=>-1!==e.indexOf(o.id))).map((e=>this.getDownloadedCourse(e))));if(yield _.a.isAvailable(this.siteId)){const e=h.b.getCurrentSiteHomeId(),t=yield this.calculateDownloadedCourseSize(e);if(t>0){const n=yield c.a.getCourseStatus(e);o.push({id:e,title:f.I.instant("core.sitehome.sitehome"),totalSize:t,isDownloading:n===r.a.DOWNLOADING})}}this.spaceUsage=yield g.a.getSiteSpaceUsage(this.siteId),this.setDownloadedCourses(o),this.loaded=!0}))}ngOnDestroy(){var e;null===(e=this.courseStatusObserver)||void 0===e?void 0:e.off()}deleteCompletelyDownloadedCourses(e){return Object(i.a)(this,void 0,void 0,(function*(){e.preventDefault(),e.stopPropagation();try{yield m.a.showDeleteConfirm("addon.storagemanager.confirmdeletecourses")}catch(e){if(!m.a.isCanceledError(e))throw e;return}const o=yield m.a.showModalLoading("core.deleting",!0),t=this.completelyDownloadedCourses.map((e=>e.id));try{yield Promise.all(t.map((e=>d.a.deleteCourseFiles(e)))),this.setDownloadedCourses(this.downloadedCourses.filter((e=>!t.includes(e.id))))}catch(e){m.a.showErrorModalDefault(e,f.I.instant("core.errordeletefile"))}finally{o.dismiss()}}))}deleteCourse(e,o){return Object(i.a)(this,void 0,void 0,(function*(){e.preventDefault(),e.stopPropagation();try{yield m.a.showDeleteConfirm("addon.storagemanager.confirmdeletedatafrom",{name:o.title})}catch(e){if(!m.a.isCanceledError(e))throw e;return}const t=yield m.a.showModalLoading("core.deleting",!0);try{yield d.a.deleteCourseFiles(o.id),this.setDownloadedCourses(S.a.withoutItem(this.downloadedCourses,o))}catch(e){m.a.showErrorModalDefault(e,f.I.instant("core.errordeletefile"))}finally{t.dismiss()}}))}onCourseUpdated(e,o){return Object(i.a)(this,void 0,void 0,(function*(){if(e==c.e.ALL_COURSES_CLEARED)return this.setDownloadedCourses([]),void 0;const t=this.downloadedCourses.find((o=>o.id===e));t&&(t.isDownloading=o===r.a.DOWNLOADING,t.totalSize=yield this.calculateDownloadedCourseSize(t.id),this.setDownloadedCourses(this.downloadedCourses))}))}setDownloadedCourses(e){this.downloadedCourses=e.sort(((e,o)=>o.totalSize-e.totalSize)),this.completelyDownloadedCourses=e.filter((e=>!e.isDownloading)),this.totalSize=this.downloadedCourses.reduce(((e,o)=>e+o.totalSize),0)}getDownloadedCourse(e){return Object(i.a)(this,void 0,void 0,(function*(){const o=yield this.calculateDownloadedCourseSize(e.id),t=yield c.a.getCourseStatus(e.id);return{id:e.id,title:e.displayname||e.fullname,totalSize:o,isDownloading:t===r.a.DOWNLOADING}}))}calculateDownloadedCourseSize(e){return Object(i.a)(this,void 0,void 0,(function*(){const o=yield c.a.getSections(e),t=S.a.flatten(o.map((e=>e.modules))).map((o=>Object(i.a)(this,void 0,void 0,(function*(){const t=yield s.a.getModuleStoredSize(o,e);return isNaN(t)?0:t}))));return(yield Promise.all(t)).reduce(((e,o)=>e+o),0)}))}openCourse(e,o){u.a.navigateToSitePath("/storage/"+e,{params:{title:o}})}deleteSiteStorage(e){return Object(i.a)(this,void 0,void 0,(function*(){e.preventDefault(),e.stopPropagation();try{const e=h.b.getRequiredCurrentSite(),o=yield e.getSiteName();this.spaceUsage=yield g.a.deleteSiteStorage(o,this.siteId)}catch(e){}}))}}return AddonStorageManagerCoursesStoragePage.ɵfac=function AddonStorageManagerCoursesStoragePage_Factory(e){return new(e||AddonStorageManagerCoursesStoragePage)},AddonStorageManagerCoursesStoragePage.ɵcmp=C.sc({type:AddonStorageManagerCoursesStoragePage,selectors:[["page-addon-storagemanager-courses-storage"]],decls:30,vars:23,consts:[["slot","start"],[3,"text"],[1,"limited-width"],[3,"hideUntil"],["class","ion-padding-horizontal ion-text-wrap",4,"ngIf"],[4,"ngIf"],[1,"ion-padding-horizontal","ion-text-wrap"],["lines","full",1,"size","courses","ion-text-wrap"],[1,"item-heading"],["color","light"],["slot","end","color","danger","fill","clear",3,"disabled","click"],["name","fas-trash","slot","icon-only",3,"ariaLabel"],["class","course","button","",3,"click",4,"ngFor","ngForOf"],[1,"ion-text-wrap","total"],[1,"item-heading","ion-text-wrap"],["color","light",4,"ngIf"],["fill","clear","color","danger","slot","end",3,"hidden","click"],["name","fas-trash","slot","icon-only","aria-hidden","true"],["button","",1,"course",3,"click"],[1,"ion-text-wrap"],["class","item-heading item-heading-secondary",4,"ngIf"],["name","fas-trash","slot","icon-only"],[1,"item-heading","item-heading-secondary"]],template:function AddonStorageManagerCoursesStoragePage_Template(e,o){1&e&&(C.Ec(0,"ion-header"),C.Ec(1,"ion-toolbar"),C.Ec(2,"ion-buttons",0),C.zc(3,"ion-back-button",1),C.Pc(4,"translate"),C.Dc(),C.Ec(5,"ion-title"),C.Ec(6,"h1"),C.pd(7),C.Pc(8,"translate"),C.Dc(),C.Dc(),C.Dc(),C.Dc(),C.Ec(9,"ion-content",2),C.Ec(10,"core-loading",3),C.nd(11,AddonStorageManagerCoursesStoragePage_div_11_Template,4,3,"div",4),C.nd(12,AddonStorageManagerCoursesStoragePage_ion_card_12_Template,10,8,"ion-card",5),C.Ec(13,"div",6),C.Ec(14,"h2"),C.pd(15),C.Pc(16,"translate"),C.Dc(),C.Dc(),C.Ec(17,"ion-card"),C.Ec(18,"ion-item",7),C.Ec(19,"ion-label"),C.Ec(20,"p",8),C.pd(21),C.Pc(22,"translate"),C.Dc(),C.Ec(23,"ion-badge",9),C.pd(24),C.Pc(25,"coreBytesToSize"),C.Dc(),C.Dc(),C.Ec(26,"ion-button",10),C.Mc("click",(function AddonStorageManagerCoursesStoragePage_Template_ion_button_click_26_listener(e){return o.deleteCompletelyDownloadedCourses(e)})),C.zc(27,"ion-icon",11),C.Pc(28,"translate"),C.Dc(),C.Dc(),C.nd(29,AddonStorageManagerCoursesStoragePage_ion_item_29_Template,11,12,"ion-item",12),C.Dc(),C.Dc(),C.Dc()),2&e&&(C.lc(3),C.Vc("text",C.Qc(4,11,"core.back")),C.lc(4),C.qd(C.Qc(8,13,"addon.storagemanager.managedownloads")),C.lc(3),C.Vc("hideUntil",o.loaded),C.lc(1),C.Vc("ngIf",o.spaceUsage),C.lc(1),C.Vc("ngIf",o.spaceUsage),C.lc(3),C.qd(C.Qc(16,15,"addon.storagemanager.downloadedcourses")),C.lc(6),C.qd(C.Qc(22,17,"addon.storagemanager.totalspaceusage")),C.lc(3),C.qd(C.Qc(25,19,o.totalSize)),C.lc(2),C.Vc("disabled",0===o.completelyDownloadedCourses.length),C.lc(1),C.Wc("ariaLabel",C.Qc(28,21,"addon.storagemanager.deletecourses")),C.lc(2),C.Vc("ngForOf",o.downloadedCourses))},directives:[b.C,b.Ab,b.m,b.h,b.i,b.yb,D.a,b.v,M.a,P.t,b.n,b.I,b.O,b.k,w.a,b.l,b.D,v.a,P.s],pipes:[O.d,I.a],styles:["ion-item.courses[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%], ion-item.total[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]{font-weight:700}"]}),AddonStorageManagerCoursesStoragePage})();var E=t("bFG1"),A=t("6s78"),z=t("hMzs"),T=t("TKc2"),k=t("uHIS"),x=t("eAud");function AddonStorageManagerCourseStoragePage_ion_item_11_Template(e,o){1&e&&(C.Ec(0,"ion-item",14),C.Ec(1,"ion-label"),C.Ec(2,"p"),C.pd(3),C.Pc(4,"translate"),C.Dc(),C.Dc(),C.Dc()),2&e&&(C.lc(3),C.qd(C.Qc(4,1,"addon.storagemanager.courseinfo")))}function AddonStorageManagerCourseStoragePage_ng_container_22_Template(e,o){if(1&e&&(C.Cc(0),C.pd(1),C.Pc(2,"coreBytesToSize"),C.Bc()),2&e){const e=C.Oc();C.lc(1),C.qd(C.Qc(2,1,e.totalSize))}}function AddonStorageManagerCourseStoragePage_ng_container_23_Template(e,o){1&e&&(C.Cc(0),C.pd(1),C.Pc(2,"translate"),C.Bc()),2&e&&(C.lc(1),C.qd(C.Qc(2,1,"core.calculating")))}function AddonStorageManagerCourseStoragePage_ion_button_24_ion_icon_1_Template(e,o){if(1&e&&C.zc(0,"ion-icon",18),2&e){const e=C.Oc(2);C.Vc("name",e.prefetchCourseData.icon)}}function AddonStorageManagerCourseStoragePage_ion_button_24_ion_spinner_2_Template(e,o){1&e&&C.zc(0,"ion-spinner",0)}function AddonStorageManagerCourseStoragePage_ion_button_24_Template(e,o){if(1&e){const e=C.Fc();C.Ec(0,"ion-button",15),C.Mc("click",(function AddonStorageManagerCourseStoragePage_ion_button_24_Template_ion_button_click_0_listener(o){C.fd(e);return C.Oc().prefetchCourse(o)})),C.nd(1,AddonStorageManagerCourseStoragePage_ion_button_24_ion_icon_1_Template,1,1,"ion-icon",16),C.nd(2,AddonStorageManagerCourseStoragePage_ion_button_24_ion_spinner_2_Template,1,0,"ion-spinner",17),C.pd(3),C.Pc(4,"translate"),C.Dc()}if(2&e){const e=C.Oc();C.Vc("disabled",e.prefetchCourseData.loading),C.lc(1),C.Vc("ngIf",!e.prefetchCourseData.loading),C.lc(1),C.Vc("ngIf",e.prefetchCourseData.loading),C.lc(1),C.rd(" ",C.Qc(4,4,e.prefetchCourseData.statusTranslatable)," ")}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ion_badge_8_ion_icon_1_Template(e,o){1&e&&(C.zc(0,"ion-icon",30),C.Pc(1,"translate")),2&e&&C.mc("aria-label",C.Qc(1,1,"core.downloaded"))}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ion_badge_8_Template(e,o){if(1&e&&(C.Ec(0,"ion-badge",28),C.nd(1,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ion_badge_8_ion_icon_1_Template,2,3,"ion-icon",29),C.pd(2),C.Pc(3,"coreBytesToSize"),C.Dc()),2&e){const e=C.Oc(2).$implicit,o=C.Oc();C.Vc("color",e.downloadStatus==o.statusDownloaded?"success":"light"),C.lc(1),C.Vc("ngIf",e.downloadStatus==o.statusDownloaded),C.lc(1),C.rd("",C.Qc(3,3,e.totalSize)," ")}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ion_badge_9_Template(e,o){1&e&&(C.Ec(0,"ion-badge",31),C.pd(1),C.Pc(2,"translate"),C.Dc()),2&e&&(C.lc(1),C.rd(" ",C.Qc(2,1,"core.calculating")," "))}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_p_10_Template(e,o){if(1&e&&(C.Ec(0,"p"),C.zc(1,"core-progress-bar",32),C.Dc()),2&e){const e=C.Oc(2).$implicit;C.lc(1),C.Vc("progress",0==e.total?-1:e.count/e.total)}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_div_1_core_download_refresh_1_Template(e,o){if(1&e){const e=C.Fc();C.Ec(0,"core-download-refresh",39),C.Mc("action",(function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_div_1_core_download_refresh_1_Template_core_download_refresh_action_0_listener(){C.fd(e);const o=C.Oc(4).$implicit;return C.Oc().prefecthSection(o)})),C.Dc()}if(2&e){const e=C.Oc(4).$implicit;C.Vc("status",e.downloadStatus)("enabled",!0)("loading",e.isDownloading||e.isCalculating)("canTrustDownload",!0)}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_div_1_ion_badge_2_Template(e,o){if(1&e&&(C.Ec(0,"ion-badge",40),C.Pc(1,"translate"),C.pd(2),C.Dc()),2&e){const e=C.Oc(4).$implicit;C.mc("aria-valuemax",e.total)("aria-valuenow",e.count)("aria-valuetext",C.Rc(1,5,"core.course.downloadsectionprogressdescription",e)),C.lc(2),C.sd(" ",e.count," / ",e.total," ")}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_div_1_Template(e,o){if(1&e&&(C.Ec(0,"div",36),C.nd(1,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_div_1_core_download_refresh_1_Template,1,4,"core-download-refresh",37),C.nd(2,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_div_1_ion_badge_2_Template,3,8,"ion-badge",38),C.Dc()),2&e){const e=C.Oc(3).$implicit,o=C.Oc();C.lc(1),C.Vc("ngIf",!e.isDownloading&&e.downloadStatus!=o.statusDownloaded),C.lc(1),C.Vc("ngIf",e.isDownloading&&e.count<e.total)}}const course_storage_c0=function(e){return{name:e}};function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_ion_button_2_Template(e,o){if(1&e){const e=C.Fc();C.Ec(0,"ion-button",41),C.Mc("click",(function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_ion_button_2_Template_ion_button_click_0_listener(o){C.fd(e);const t=C.Oc(3).$implicit;return C.Oc().deleteForSection(o,t)})),C.zc(1,"ion-icon",42),C.Pc(2,"translate"),C.Dc()}if(2&e){const e=C.Oc(3).$implicit;C.lc(1),C.mc("aria-label",C.Rc(2,1,"addon.storagemanager.deletedatafrom",C.ad(4,course_storage_c0,e.name)))}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_Template(e,o){if(1&e&&(C.Ec(0,"div",33),C.nd(1,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_div_1_Template,3,2,"div",34),C.nd(2,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_ion_button_2_Template,3,6,"ion-button",35),C.Dc()),2&e){const e=C.Oc(2).$implicit,o=C.Oc();C.lc(1),C.Vc("ngIf",o.downloadEnabled),C.lc(1),C.Vc("ngIf",!e.calculatingSize&&e.totalSize>0)}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_core_mod_icon_1_Template(e,o){if(1&e&&C.zc(0,"core-mod-icon",50),2&e){const e=C.Oc(2).$implicit;C.Vc("modicon",e.handlerData.icon)("modname",e.modname)("componentId",e.instance)("fallbackTranslation",e.modplural)}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_ion_badge_5_ion_icon_1_Template(e,o){1&e&&(C.zc(0,"ion-icon",30),C.Pc(1,"translate")),2&e&&C.mc("aria-label",C.Qc(1,1,"core.downloaded"))}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_ion_badge_5_Template(e,o){if(1&e&&(C.Ec(0,"ion-badge",28),C.nd(1,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_ion_badge_5_ion_icon_1_Template,2,3,"ion-icon",29),C.pd(2),C.Pc(3,"coreBytesToSize"),C.Dc()),2&e){const e=C.Oc(2).$implicit,o=C.Oc(4);C.Vc("color",e.downloadStatus==o.statusDownloaded?"success":"light"),C.lc(1),C.Vc("ngIf",e.downloadStatus==o.statusDownloaded),C.lc(1),C.rd("",C.Qc(3,3,e.totalSize)," ")}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_ion_badge_6_Template(e,o){1&e&&(C.Ec(0,"ion-badge",31),C.pd(1),C.Pc(2,"translate"),C.Dc()),2&e&&(C.lc(1),C.rd(" ",C.Qc(2,1,"core.calculating")," "))}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_core_download_refresh_8_Template(e,o){if(1&e){const e=C.Fc();C.Ec(0,"core-download-refresh",51),C.Mc("action",(function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_core_download_refresh_8_Template_core_download_refresh_action_0_listener(){C.fd(e);const o=C.Oc(2).$implicit;return C.Oc(4).prefetchModule(o)})),C.Dc()}if(2&e){const e=C.Oc(2).$implicit;C.Vc("status",e.downloadStatus)("enabled",!0)("canTrustDownload",!0)("loading",e.spinner||e.handlerData.spinner)}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_ion_button_9_Template(e,o){if(1&e){const e=C.Fc();C.Ec(0,"ion-button",52),C.Mc("click",(function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_ion_button_9_Template_ion_button_click_0_listener(o){C.fd(e);const t=C.Oc(2).$implicit,n=C.Oc(3).$implicit;return C.Oc().deleteForModule(o,t,n)})),C.zc(1,"ion-icon",42),C.Pc(2,"translate"),C.Dc()}if(2&e){const e=C.Oc(2).$implicit;C.lc(1),C.mc("aria-label",C.Rc(2,1,"addon.storagemanager.deletedatafrom",C.ad(4,course_storage_c0,e.name)))}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_p_10_Template(e,o){1&e&&(C.Ec(0,"p",53),C.pd(1),C.Pc(2,"translate"),C.Dc()),2&e&&(C.lc(1),C.rd(" ",C.Qc(2,1,"core.notdownloadable")," "))}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_Template(e,o){if(1&e&&(C.Ec(0,"ion-item",44),C.nd(1,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_core_mod_icon_1_Template,1,4,"core-mod-icon",45),C.Ec(2,"ion-label",14),C.Ec(3,"p"),C.zc(4,"core-format-text",46),C.Dc(),C.nd(5,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_ion_badge_5_Template,4,5,"ion-badge",24),C.nd(6,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_ion_badge_6_Template,3,3,"ion-badge",25),C.Dc(),C.Ec(7,"div",33),C.nd(8,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_core_download_refresh_8_Template,1,4,"core-download-refresh",47),C.nd(9,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_ion_button_9_Template,3,6,"ion-button",48),C.nd(10,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_p_10_Template,3,3,"p",49),C.Dc(),C.Dc()),2&e){const e=C.Oc().$implicit,o=C.Oc(4);C.lc(1),C.Vc("ngIf",e.handlerData.icon),C.lc(2),C.oc("item-heading ",e.handlerData.class," addon-storagemanager-module-size"),C.lc(1),C.Vc("text",e.handlerData.title)("courseId",e.course)("contextInstanceId",e.id)("adaptImg",!1),C.lc(1),C.Vc("ngIf",!e.calculatingSize&&e.totalSize>0),C.lc(1),C.Vc("ngIf",e.calculatingSize),C.lc(2),C.Vc("ngIf",o.downloadEnabled&&(null==e.handlerData?null:e.handlerData.showDownloadButton)&&e.downloadStatus!=o.statusDownloaded),C.lc(1),C.Vc("ngIf",!e.calculatingSize&&e.totalSize>0),C.lc(1),C.Vc("ngIf",!o.downloadEnabled||!(null!=e.handlerData&&e.handlerData.showDownloadButton))}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_Template(e,o){if(1&e&&(C.Cc(0),C.nd(1,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_Template,11,13,"ion-item",43),C.Bc()),2&e){const e=o.$implicit,t=C.Oc(4);C.lc(1),C.Vc("ngIf",t.downloadEnabled||!e.calculatingSize&&e.totalSize>0)}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_Template(e,o){if(1&e&&(C.Cc(0),C.nd(1,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_Template,2,1,"ng-container",13),C.Bc()),2&e){const e=C.Oc(2).$implicit;C.lc(1),C.Vc("ngForOf",e.modules)}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_Template(e,o){if(1&e){const e=C.Fc();C.Ec(0,"ion-card",20),C.Ec(1,"ion-card-header"),C.Ec(2,"ion-item",21),C.Mc("click",(function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_Template_ion_item_click_2_listener(o){C.fd(e);const t=C.Oc().$implicit;return C.Oc().toggleExpand(o,t)})),C.Pc(3,"translate"),C.zc(4,"ion-icon",22),C.Ec(5,"ion-label"),C.Ec(6,"p",7),C.zc(7,"core-format-text",23),C.Dc(),C.nd(8,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ion_badge_8_Template,4,5,"ion-badge",24),C.nd(9,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ion_badge_9_Template,3,3,"ion-badge",25),C.nd(10,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_p_10_Template,2,1,"p",9),C.Dc(),C.nd(11,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_Template,3,2,"div",26),C.Dc(),C.Dc(),C.Ec(12,"ion-card-content",27),C.nd(13,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_Template,2,1,"ng-container",9),C.Dc(),C.Dc()}if(2&e){const e=C.Oc().$implicit,o=C.Oc();C.lc(2),C.qc("core-course-storage-section-expanded",e.expanded),C.Vc("lines",e.expanded?"full":"none"),C.mc("aria-label",C.Qc(3,17,e.expanded?"core.collapse":"core.expand"))("aria-expanded",e.expanded)("aria-controls","core-course-storage-section-"+e.id),C.lc(2),C.qc("expandable-status-icon-expanded",e.expanded),C.lc(3),C.Vc("text",e.name)("contextInstanceId",e.course)("adaptImg",!1),C.lc(1),C.Vc("ngIf",!e.calculatingSize&&e.totalSize>0),C.lc(1),C.Vc("ngIf",e.calculatingSize),C.lc(1),C.Vc("ngIf",o.downloadEnabled&&e.isDownloading),C.lc(1),C.Vc("ngIf",!e.calculatingSize&&e.totalSize>0||o.downloadEnabled),C.lc(1),C.Xc("id","core-course-storage-section-",e.id,""),C.lc(1),C.Vc("ngIf",e.expanded)}}function AddonStorageManagerCourseStoragePage_ng_container_30_Template(e,o){if(1&e&&(C.Cc(0),C.nd(1,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_Template,14,19,"ion-card",19),C.Bc()),2&e){const e=o.$implicit;C.lc(1),C.Vc("ngIf",e.modules.length>0)}}let V=(()=>{class AddonStorageManagerCourseStoragePage{constructor(e,o){this.elementRef=e,this.changeDetectorRef=o,this.title="",this.loaded=!1,this.sections=[],this.totalSize=0,this.calculatingSize=!0,this.downloadEnabled=!1,this.downloadCourseEnabled=!1,this.prefetchCourseData={icon:r.a.ICON_LOADING,statusTranslatable:"core.course.downloadcourse",status:"",loading:!0},this.statusDownloaded=r.a.DOWNLOADED,this.isDestroyed=!1,this.isGuest=!1,this.siteUpdatedObserver=p.b.on(p.b.SITE_UPDATED,(()=>{this.downloadCourseEnabled=!l.a.isDownloadCourseDisabledInSite(),this.downloadEnabled=!h.b.getRequiredCurrentSite().isOfflineDisabled(),this.initCoursePrefetch(),this.initModulePrefetch(),this.changeDetectorRef.markForCheck()}),h.b.getCurrentSiteId())}ngOnInit(){var e;return Object(i.a)(this,void 0,void 0,(function*(){try{this.courseId=u.a.getRequiredRouteParam("courseId")}catch(e){return m.a.showErrorModal(e),u.a.back(),void 0}this.title=u.a.getRouteParam("title")||"",this.title||this.courseId!=h.b.getCurrentSiteHomeId()||(this.title=f.I.instant("core.sitehome.sitehome")),this.isGuest=null!==(e=u.a.getRouteBooleanParam("isGuest"))&&void 0!==e?e:(yield d.a.courseUsesGuestAccessInfo(this.courseId)).guestAccess,this.initialSectionId=u.a.getRouteNumberParam("sectionId"),this.downloadCourseEnabled=!l.a.isDownloadCourseDisabledInSite(),this.downloadEnabled=!h.b.getRequiredCurrentSite().isOfflineDisabled();const o=(yield c.a.getSections(this.courseId,!1,!0)).filter((e=>!d.a.isSectionStealth(e)));this.sections=(yield d.a.addHandlerDataForModules(o,this.courseId)).sections.map((e=>Object.assign(Object.assign({},e),{totalSize:0,calculatingSize:!0,expanded:e.id===this.initialSectionId,modules:e.modules.map((e=>Object.assign(Object.assign({},e),{calculatingSize:!0})))}))),this.loaded=!0,A.a.scrollToElement(this.elementRef.nativeElement,".core-course-storage-section-expanded",{addYAxis:-10}),yield Promise.all([this.initSizes(),this.initCoursePrefetch(),this.initModulePrefetch()]),this.changeDetectorRef.markForCheck()}))}initCoursePrefetch(){return Object(i.a)(this,void 0,void 0,(function*(){if(!this.downloadCourseEnabled||this.courseStatusObserver)return;if(this.courseStatusObserver=p.b.on(p.b.COURSE_STATUS_CHANGED,(e=>{e.courseId!=this.courseId&&e.courseId!=c.e.ALL_COURSES_CLEARED||this.updateCourseStatus(e.status)}),h.b.getCurrentSiteId()),yield this.determineCoursePrefetchIcon(),this.prefetchCourseData.icon!=r.a.ICON_LOADING)return;const e=d.a.getCourseDownloadPromise(this.courseId);if(e)e.catch((e=>{this.isDestroyed||m.a.showErrorModalDefault(e,"core.course.errordownloadingcourse",!0)}));else{const e=yield c.a.setCoursePreviousStatus(this.courseId);this.updateCourseStatus(e)}}))}initModulePrefetch(){return Object(i.a)(this,void 0,void 0,(function*(){this.downloadEnabled&&!this.sectionStatusObserver&&(this.sectionStatusObserver=p.b.on(p.b.SECTION_STATUS_CHANGED,(e=>Object(i.a)(this,void 0,void 0,(function*(){if(!this.downloadEnabled||!this.sections.length||!e.sectionId||e.courseId!=this.courseId)return;const o=d.a.getSectionDownloadId({id:e.sectionId});if(s.a.isBeingDownloaded(o))return;const t=this.sections.find((o=>o.id==e.sectionId));t&&(yield d.a.calculateSectionStatus(t,this.courseId,!1),t.isDownloading&&!s.a.isBeingDownloaded(o)&&this.prefecthSection(t))}))),h.b.getCurrentSiteId()),d.a.calculateSectionsStatus(this.sections,this.courseId,!1,!1),this.sections.forEach((e=>{e.modules.forEach((e=>{var o;(null===(o=e.handlerData)||void 0===o?void 0:o.showDownloadButton)&&(e.spinner=!0,e.prefetchHandler=s.a.getPrefetchHandlerFor(e.modname),this.calculateModuleStatus(e))}))})),this.moduleStatusObserver=p.b.on(p.b.PACKAGE_STATUS_CHANGED,(e=>{let o;if(this.sections.some((t=>(o=t.modules.find((o=>{var t;return o.id==e.componentId&&o.prefetchHandler&&e.component==(null===(t=o.prefetchHandler)||void 0===t?void 0:t.component)})),!!o))),!o)return;const t=s.a.determineModuleStatus(o,e.status);this.updateModuleStatus(o,t)}),h.b.getCurrentSiteId()))}))}initSizes(){return Object(i.a)(this,void 0,void 0,(function*(){yield Promise.all(this.sections.map((e=>Object(i.a)(this,void 0,void 0,(function*(){yield Promise.all(e.modules.map((o=>Object(i.a)(this,void 0,void 0,(function*(){const t=yield s.a.getModuleStoredSize(o,this.courseId);isNaN(t)||(o.totalSize=Number(t),e.totalSize+=t,this.totalSize+=t),o.calculatingSize=!1}))))),e.calculatingSize=!1}))))),this.calculatingSize=!1,0==this.totalSize&&this.markCourseAsNotDownloaded()}))}updateModulesSizes(e,o){return Object(i.a)(this,void 0,void 0,(function*(){this.calculatingSize=!0,yield Promise.all(e.map((e=>Object(i.a)(this,void 0,void 0,(function*(){var t;if(!e.calculatingSize){e.calculatingSize=!0,this.changeDetectorRef.markForCheck(),o||(o=this.sections.find((o=>o.modules.some((o=>o.id===e.id)))))&&(o.calculatingSize=!0,this.changeDetectorRef.markForCheck());try{const n=yield s.a.getModuleStoredSize(e,this.courseId),a=(isNaN(n)?0:n)-(null!==(t=e.totalSize)&&void 0!==t?t:0);e.totalSize=Number(n),this.totalSize+=a,o&&(o.totalSize+=a)}catch(e){}finally{e.calculatingSize=!1,this.changeDetectorRef.markForCheck()}}}))))),this.calculatingSize=!1,o&&(o.calculatingSize=!1),this.changeDetectorRef.markForCheck()}))}deleteForCourse(e){return Object(i.a)(this,void 0,void 0,(function*(){e.stopPropagation(),e.preventDefault();try{yield m.a.showDeleteConfirm("addon.storagemanager.confirmdeletedatafrom",{name:this.title})}catch(e){if(!m.a.isCanceledError(e))throw e;return}const o=[];this.sections.forEach((e=>{e.modules.forEach((e=>{e.totalSize&&e.totalSize>0&&o.push(e)}))})),this.deleteModules(o)}))}deleteForSection(e,o){return Object(i.a)(this,void 0,void 0,(function*(){e.stopPropagation(),e.preventDefault();try{yield m.a.showDeleteConfirm("addon.storagemanager.confirmdeletedatafrom",{name:o.name})}catch(e){if(!m.a.isCanceledError(e))throw e;return}const t=[];o.modules.forEach((e=>{e.totalSize&&e.totalSize>0&&t.push(e)})),this.deleteModules(t,o)}))}deleteForModule(e,o,t){return Object(i.a)(this,void 0,void 0,(function*(){if(e.stopPropagation(),e.preventDefault(),0!==o.totalSize){try{yield m.a.showDeleteConfirm("addon.storagemanager.confirmdeletedatafrom",{name:o.name})}catch(e){if(!m.a.isCanceledError(e))throw e;return}this.deleteModules([o],t)}}))}deleteModules(e,o){return Object(i.a)(this,void 0,void 0,(function*(){const t=yield m.a.showModalLoading("core.deleting",!0),n=[];e.forEach((e=>{const t=d.a.removeModuleStoredData(e,this.courseId).then((()=>{const t=e.totalSize||0;o&&(o.totalSize-=t),this.totalSize-=t,e.totalSize=0}));n.push(t)}));try{yield Promise.all(n)}catch(e){m.a.showErrorModalDefault(e,f.I.instant("core.errordeletefile"))}finally{t.dismiss(),yield this.updateModulesSizes(e,o),d.a.calculateSectionsStatus(this.sections,this.courseId,!1,!1),0===this.totalSize&&this.sections.map((e=>e.totalSize=0)),this.changeDetectorRef.markForCheck()}}))}markCourseAsNotDownloaded(){c.a.setCourseStatus(this.courseId,r.a.NOT_DOWNLOADED)}calculateSectionsStatus(e){this.sections&&E.a.ignoreErrors(d.a.calculateSectionsStatus(this.sections,this.courseId,e))}prefecthSection(e){return Object(i.a)(this,void 0,void 0,(function*(){e.isCalculating=!0,this.changeDetectorRef.markForCheck();try{yield d.a.confirmDownloadSizeSection(this.courseId,e,this.sections);try{yield d.a.prefetchSection(e,this.courseId,this.sections)}catch(e){this.isDestroyed||m.a.showErrorModalDefault(e,"core.course.errordownloadingsection",!0)}finally{yield this.updateModulesSizes(e.modules,e),this.changeDetectorRef.markForCheck()}}catch(e){if(!this.isDestroyed&&e)return m.a.showErrorModal(e),this.changeDetectorRef.markForCheck(),void 0}finally{e.isCalculating=!1,this.changeDetectorRef.markForCheck()}}))}prefetchModule(e,o=!1){return Object(i.a)(this,void 0,void 0,(function*(){if(e.prefetchHandler){e.spinner=!0;try{const t=yield e.prefetchHandler.getDownloadSize(e,e.course,!0);yield d.a.prefetchModule(e.prefetchHandler,e,t,e.course,o),d.a.calculateSectionsStatus(this.sections,this.courseId,!1,!1)}catch(e){this.isDestroyed||m.a.showErrorModalDefault(e,"core.errordownloading",!0)}finally{e.spinner=!1,yield this.updateModulesSizes([e])}}}))}updateModuleStatus(e,o){var t,n;o&&(e.spinner=!1,e.downloadStatus=o,null===(n=null===(t=e.handlerData)||void 0===t?void 0:t.updateStatus)||void 0===n||n.call(t,o),this.changeDetectorRef.markForCheck())}calculateModuleStatus(e){return Object(i.a)(this,void 0,void 0,(function*(){if(!e)return;const o=yield s.a.getModuleStatus(e,this.courseId);this.updateModuleStatus(e,o)}))}determineCoursePrefetchIcon(){return Object(i.a)(this,void 0,void 0,(function*(){this.prefetchCourseData=yield d.a.getCourseStatusIconAndTitle(this.courseId)}))}updateCourseStatus(e){const o=d.a.getCoursePrefetchStatusInfo(e);this.prefetchCourseData.status=o.status,this.prefetchCourseData.icon=o.icon,this.prefetchCourseData.statusTranslatable=o.statusTranslatable,this.prefetchCourseData.loading=o.loading,this.changeDetectorRef.markForCheck()}getCourse(e){return Object(i.a)(this,void 0,void 0,(function*(){try{return yield l.a.getUserCourse(e,!0)}catch(e){}try{return yield l.a.getCourse(e)}catch(e){}return yield l.a.getCourseByField("id",this.courseId)}))}prefetchCourse(e){return Object(i.a)(this,void 0,void 0,(function*(){e.stopPropagation(),e.preventDefault();const o=yield this.getCourse(this.courseId);if(!o)return m.a.showErrorModal("core.course.errordownloadingcourse",!0),void 0;try{this.changeDetectorRef.markForCheck(),yield d.a.confirmAndPrefetchCourse(this.prefetchCourseData,o,{sections:this.sections,isGuest:this.isGuest}),yield Promise.all(this.sections.map((e=>this.updateModulesSizes(e.modules,e)))),this.changeDetectorRef.markForCheck()}catch(e){if(this.isDestroyed)return;m.a.showErrorModalDefault(e,"core.course.errordownloadingcourse",!0)}}))}toggleExpand(e,o){o.expanded=!o.expanded,e.stopPropagation(),e.preventDefault()}ngOnDestroy(){var e,o,t,n;null===(e=this.courseStatusObserver)||void 0===e?void 0:e.off(),null===(o=this.sectionStatusObserver)||void 0===o||o.off(),null===(t=this.moduleStatusObserver)||void 0===t||t.off(),null===(n=this.siteUpdatedObserver)||void 0===n||n.off(),this.sections.forEach((e=>{e.modules.forEach((e=>{var o,t;null===(t=null===(o=e.handlerData)||void 0===o?void 0:o.onDestroy)||void 0===t?void 0:t.call(o)}))})),this.isDestroyed=!0}}return AddonStorageManagerCourseStoragePage.ɵfac=function AddonStorageManagerCourseStoragePage_Factory(e){return new(e||AddonStorageManagerCourseStoragePage)(C.yc(C.r),C.yc(C.j))},AddonStorageManagerCourseStoragePage.ɵcmp=C.sc({type:AddonStorageManagerCourseStoragePage,selectors:[["page-addon-storagemanager-course-storage"]],decls:31,vars:26,consts:[["slot","start"],[3,"text"],[1,"limited-width"],[3,"hideUntil"],["class","ion-text-wrap",4,"ngIf"],[1,"wholecourse"],[1,"size","ion-text-wrap","ion-no-padding"],[1,"item-heading","ion-text-wrap"],["color","light","slot","end"],[4,"ngIf"],["expand","block","fill","outline","class","ion-no-margin",3,"disabled","click",4,"ngIf"],["expand","block","color","danger",1,"ion-no-margin","ion-margin-top",3,"disabled","click"],["name","fas-trash","slot","start"],[4,"ngFor","ngForOf"],[1,"ion-text-wrap"],["expand","block","fill","outline",1,"ion-no-margin",3,"disabled","click"],["slot","start",3,"name",4,"ngIf"],["slot","start",4,"ngIf"],["slot","start",3,"name"],["class","section",4,"ngIf"],[1,"section"],["button","","detail","false",3,"lines","click"],["name","fas-chevron-right","flip-rtl","","slot","start",1,"expandable-status-icon"],["contextLevel","course",3,"text","contextInstanceId","adaptImg"],[3,"color",4,"ngIf"],["color","light",4,"ngIf"],["class","storage-buttons","slot","end",4,"ngIf"],[3,"id"],[3,"color"],["name","fam-cloud-done",4,"ngIf"],["name","fam-cloud-done"],["color","light"],[3,"progress"],["slot","end",1,"storage-buttons"],["slot","end","class","core-button-spinner",4,"ngIf"],["color","danger","fill","clear",3,"click",4,"ngIf"],["slot","end",1,"core-button-spinner"],[3,"status","enabled","loading","canTrustDownload","action",4,"ngIf"],["class","core-course-download-section-progress","role","progressbar",4,"ngIf"],[3,"status","enabled","loading","canTrustDownload","action"],["role","progressbar",1,"core-course-download-section-progress"],["color","danger","fill","clear",3,"click"],["name","fas-trash","slot","icon-only"],["class","core-course-storage-activity",4,"ngIf"],[1,"core-course-storage-activity"],["slot","start",3,"modicon","modname","componentId","fallbackTranslation",4,"ngIf"],["contextLevel","module",3,"text","courseId","contextInstanceId","adaptImg"],[3,"status","enabled","canTrustDownload","loading","action",4,"ngIf"],["fill","clear","color","danger",3,"click",4,"ngIf"],["class","sr-only",4,"ngIf"],["slot","start",3,"modicon","modname","componentId","fallbackTranslation"],[3,"status","enabled","canTrustDownload","loading","action"],["fill","clear","color","danger",3,"click"],[1,"sr-only"]],template:function AddonStorageManagerCourseStoragePage_Template(e,o){1&e&&(C.Ec(0,"ion-header"),C.Ec(1,"ion-toolbar"),C.Ec(2,"ion-buttons",0),C.zc(3,"ion-back-button",1),C.Pc(4,"translate"),C.Dc(),C.Ec(5,"ion-title"),C.Ec(6,"h1"),C.pd(7),C.Pc(8,"translate"),C.Dc(),C.Dc(),C.Dc(),C.Dc(),C.Ec(9,"ion-content",2),C.Ec(10,"core-loading",3),C.nd(11,AddonStorageManagerCourseStoragePage_ion_item_11_Template,5,3,"ion-item",4),C.Ec(12,"ion-card",5),C.Ec(13,"ion-card-header"),C.Ec(14,"ion-card-title"),C.pd(15),C.Dc(),C.Ec(16,"ion-item",6),C.Ec(17,"ion-label"),C.Ec(18,"p",7),C.pd(19),C.Pc(20,"translate"),C.Dc(),C.Dc(),C.Ec(21,"ion-badge",8),C.nd(22,AddonStorageManagerCourseStoragePage_ng_container_22_Template,3,3,"ng-container",9),C.nd(23,AddonStorageManagerCourseStoragePage_ng_container_23_Template,3,3,"ng-container",9),C.Dc(),C.Dc(),C.nd(24,AddonStorageManagerCourseStoragePage_ion_button_24_Template,5,6,"ion-button",10),C.Ec(25,"ion-button",11),C.Mc("click",(function AddonStorageManagerCourseStoragePage_Template_ion_button_click_25_listener(e){return o.deleteForCourse(e)})),C.zc(26,"ion-icon",12),C.Pc(27,"translate"),C.pd(28),C.Pc(29,"translate"),C.Dc(),C.Dc(),C.Dc(),C.nd(30,AddonStorageManagerCourseStoragePage_ng_container_30_Template,2,1,"ng-container",13),C.Dc(),C.Dc()),2&e&&(C.lc(3),C.Vc("text",C.Qc(4,13,"core.back")),C.lc(4),C.qd(C.Qc(8,15,"addon.storagemanager.coursedownloads")),C.lc(3),C.Vc("hideUntil",o.loaded),C.lc(1),C.Vc("ngIf",o.downloadCourseEnabled),C.lc(4),C.qd(o.title),C.lc(4),C.qd(C.Qc(20,17,"addon.storagemanager.totaldownloads")),C.lc(3),C.Vc("ngIf",!o.calculatingSize),C.lc(1),C.Vc("ngIf",o.calculatingSize),C.lc(1),C.Vc("ngIf",o.downloadCourseEnabled),C.lc(1),C.Vc("disabled",o.calculatingSize||o.totalSize<=0),C.lc(1),C.mc("aria-label",C.Rc(27,19,"addon.storagemanager.deletedatafrom",C.ad(24,course_storage_c0,o.title))),C.lc(2),C.rd(" ",C.Qc(29,22,"addon.storagemanager.deleteall")," "),C.lc(2),C.Vc("ngForOf",o.sections))},directives:[b.C,b.Ab,b.m,b.h,b.i,b.yb,D.a,b.v,M.a,P.t,b.n,b.p,b.r,b.I,b.O,b.k,w.a,b.l,b.D,v.a,P.s,b.qb,z.a,b.o,T.a,k.a,x.a],pipes:[O.d,I.a],styles:['[_nghost-%COMP%]{--course-storage-max-activity-height:120px}[_nghost-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-item.size[_ngcontent-%COMP%]{--inner-padding-end:0px}[_nghost-%COMP%]   ion-card.section[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%], [_nghost-%COMP%]   ion-card.section[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{padding:0}[_nghost-%COMP%]   ion-card.section[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .core-course-storage-activity[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{position:relative;max-height:var(--course-storage-max-activity-height);overflow:hidden}[_nghost-%COMP%]   ion-card.section[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .core-course-storage-activity[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]     *{pointer-events:none!important}[_nghost-%COMP%]   ion-card.section[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .core-course-storage-activity[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]:before{content:"";height:var(--course-storage-max-activity-height);position:absolute;left:0;right:0;top:0;background:linear-gradient(180deg,rgba(var(--background-gradient-rgb),0) calc(100% - 30px),rgba(var(--background-gradient-rgb),1) calc(100% - 20px));z-index:6;pointer-events:none}[_nghost-%COMP%]   ion-card.section[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]{font-weight:700;font-size:1.2rem}ion-badge[_ngcontent-%COMP%]{margin-top:8px}ion-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:8px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){ion-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:unset;-webkit-margin-end:8px;margin-inline-end:8px}}ion-item[_ngcontent-%COMP%]   core-mod-icon[_ngcontent-%COMP%]{--size:18px;padding:9px;--margin-vertical:8px;--margin-end:8px}.storage-buttons[_ngcontent-%COMP%]{display:flex;align-items:center}'],changeDetection:0}),AddonStorageManagerCourseStoragePage})();const F=[{path:"storage",component:y},{path:"storage/:courseId",component:V}];let R=(()=>{class AddonStorageManagerLazyModule{}return AddonStorageManagerLazyModule.ɵmod=C.wc({type:AddonStorageManagerLazyModule}),AddonStorageManagerLazyModule.ɵinj=C.vc({factory:function AddonStorageManagerLazyModule_Factory(e){return new(e||AddonStorageManagerLazyModule)},imports:[[n.m.forChild(F),a.a],n.m]}),AddonStorageManagerLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&C.kd(R,{declarations:[y,V],imports:[n.m,a.a],exports:[n.m]}))}}]);