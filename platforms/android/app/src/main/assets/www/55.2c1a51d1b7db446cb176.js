(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{SHY4:function(t,e,n){"use strict";n.r(e),n.d(e,"AddonModH5PActivityLazyModule",(function(){return q}));var i=n("tyNb"),c=n("L3Fv"),o=n("MLi9"),a=n("SqOg"),d=n("mrSG"),s=n("ghUQ"),r=n("3LXp"),_=n("j3ag"),l=n("ArZS"),m=n("fXoL"),p=n("TEn/"),g=n("4JiN"),u=n("hMzs"),A=n("nt/U"),h=n("sYmb");let P=(()=>{class AddonModH5PActivityIndexPage extends s.a{constructor(){super(...arguments),this.canLeaveSafely=!1}canLeave(){var t;return Object(d.a)(this,void 0,void 0,(function*(){if(!(null===(t=this.activityComponent)||void 0===t?void 0:t.playing)||this.activityComponent.isOpeningPage||this.activityComponent.saveStateEnabled)return!0;if(!this.canLeaveSafely)try{return yield r.a.showConfirm(_.I.instant("core.confirmleaveunknownchanges")),!0}catch(t){return!1}return!0}))}setCanleaveSafely(t){this.canLeaveSafely=t,this.remainingTimeout&&clearTimeout(this.remainingTimeout),this.remainingTimeout=window.setTimeout((()=>{this.canLeaveSafely=!1}),1e4)}ngOnDestroy(){this.remainingTimeout&&clearTimeout(this.remainingTimeout)}}return AddonModH5PActivityIndexPage.ɵfac=function AddonModH5PActivityIndexPage_Factory(t){return v(t||AddonModH5PActivityIndexPage)},AddonModH5PActivityIndexPage.ɵcmp=m.sc({type:AddonModH5PActivityIndexPage,selectors:[["page-addon-mod-h5pactivity-index"]],viewQuery:function AddonModH5PActivityIndexPage_Query(t,e){var n;(1&t&&m.ud(l.a,!0),2&t)&&(m.dd(n=m.Nc())&&(e.activityComponent=n.first))},features:[m.ic],decls:14,vars:12,consts:[["collapsible",""],["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["slot","end"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"module","courseId","dataRetrieved","onActivityFinish"]],template:function AddonModH5PActivityIndexPage_Template(t,e){1&t&&(m.Ec(0,"ion-header",0),m.Ec(1,"ion-toolbar"),m.Ec(2,"ion-buttons",1),m.zc(3,"ion-back-button",2),m.Pc(4,"translate"),m.Dc(),m.Ec(5,"ion-title"),m.Ec(6,"h1"),m.zc(7,"core-format-text",3),m.Dc(),m.Dc(),m.zc(8,"ion-buttons",4),m.Dc(),m.Dc(),m.Ec(9,"ion-content"),m.Ec(10,"ion-refresher",5),m.Mc("ionRefresh",(function AddonModH5PActivityIndexPage_Template_ion_refresher_ionRefresh_10_listener(t){return null==e.activityComponent?null:e.activityComponent.doRefresh(t.target)})),m.zc(11,"ion-refresher-content",6),m.Pc(12,"translate"),m.Dc(),m.Ec(13,"addon-mod-h5pactivity-index",7),m.Mc("dataRetrieved",(function AddonModH5PActivityIndexPage_Template_addon_mod_h5pactivity_index_dataRetrieved_13_listener(t){return e.updateData(t)}))("onActivityFinish",(function AddonModH5PActivityIndexPage_Template_addon_mod_h5pactivity_index_onActivityFinish_13_listener(t){return e.setCanleaveSafely(t)})),m.Dc(),m.Dc()),2&t&&(m.lc(3),m.Vc("text",m.Qc(4,8,"core.back")),m.lc(4),m.Vc("text",e.title)("contextInstanceId",e.module.id)("courseId",e.courseId),m.lc(3),m.Vc("disabled",null==e.activityComponent?null:e.activityComponent.showLoading),m.lc(1),m.Wc("pullingText",m.Qc(12,10,"core.pulltorefresh")),m.lc(2),m.Vc("module",e.module)("courseId",e.courseId))},directives:[p.C,g.b,p.Ab,p.m,p.h,p.i,p.yb,u.a,A.a,p.v,p.bb,p.cb,l.a],pipes:[h.d],encapsulation:2}),AddonModH5PActivityIndexPage})();const v=m.Gc(P);var y=n("4pns"),f=n("pHTc"),I=n("9+EE"),M=n("bFG1"),D=n("pOwY"),b=n("8vmT"),E=n("D7J2"),H=n("ofXK"),T=n("PgjG"),x=n("nu3w"),O=n("FeAf"),R=n("r8G5"),w=n("3CSS"),U=n("uYHD");function AddonModH5PActivityUserAttemptsPage_core_format_text_7_Template(t,e){if(1&t&&m.zc(0,"core-format-text",11),2&t){const t=m.Oc();m.Vc("text",t.h5pActivity.name)("contextInstanceId",t.h5pActivity.coursemodule)("courseId",t.courseId)}}function AddonModH5PActivityUserAttemptsPage_ion_item_13_Template(t,e){if(1&t&&(m.Ec(0,"ion-item",12),m.zc(1,"core-user-avatar",13),m.Ec(2,"ion-label"),m.Ec(3,"h2"),m.pd(4),m.Dc(),m.Dc(),m.Dc()),2&t){const t=m.Oc();m.Vc("userId",t.user.id)("courseId",t.courseId),m.mc("aria-label",t.user.fullname),m.lc(1),m.Vc("user",t.user)("courseId",t.courseId)("linkProfile",!1),m.lc(3),m.qd(t.user.fullname)}}function AddonModH5PActivityUserAttemptsPage_ion_item_14_Template(t,e){if(1&t&&(m.Ec(0,"ion-item",14),m.zc(1,"core-user-avatar",15),m.Ec(2,"ion-label"),m.Ec(3,"h2"),m.pd(4),m.Pc(5,"translate"),m.Dc(),m.Dc(),m.Dc()),2&t){const t=m.Oc();m.lc(1),m.Vc("user",t.user)("courseId",t.courseId),m.lc(3),m.qd(m.Qc(5,3,"addon.mod_h5pactivity.myattempts"))}}function AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_1_ng_container_5_Template(t,e){1&t&&m.Ac(0)}const _c0=function(t){return{attempts:t}};function AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_1_Template(t,e){if(1&t&&(m.Cc(0),m.Ec(1,"ion-item-divider"),m.Ec(2,"ion-label"),m.Ec(3,"h3",16),m.pd(4),m.Dc(),m.Dc(),m.Dc(),m.nd(5,AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_1_ng_container_5_Template,1,0,"ng-container",17),m.Bc()),2&t){const t=m.Oc(2),e=m.ed(18);m.lc(4),m.qd(t.attemptsData.scored.title),m.lc(1),m.Vc("ngTemplateOutlet",e)("ngTemplateOutletContext",m.ad(3,_c0,t.attemptsData.scored.attempts))}}function AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_2_ng_container_6_Template(t,e){1&t&&m.Ac(0)}function AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_2_Template(t,e){if(1&t&&(m.Cc(0),m.Ec(1,"ion-item-divider"),m.Ec(2,"ion-label"),m.Ec(3,"h3",16),m.pd(4),m.Pc(5,"translate"),m.Dc(),m.Dc(),m.Dc(),m.nd(6,AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_2_ng_container_6_Template,1,0,"ng-container",17),m.Bc()),2&t){const t=m.Oc(2),e=m.ed(18);m.lc(4),m.qd(m.Qc(5,3,"addon.mod_h5pactivity.all_attempts")),m.lc(2),m.Vc("ngTemplateOutlet",e)("ngTemplateOutletContext",m.ad(5,_c0,t.attemptsData.attempts))}}function AddonModH5PActivityUserAttemptsPage_ion_list_15_Template(t,e){if(1&t&&(m.Ec(0,"ion-list"),m.nd(1,AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_1_Template,6,5,"ng-container",8),m.nd(2,AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_2_Template,7,7,"ng-container",8),m.Dc()),2&t){const t=m.Oc();m.lc(1),m.Vc("ngIf",t.attemptsData.scored),m.lc(1),m.Vc("ngIf",t.attemptsData.attempts&&t.attemptsData.attempts.length)}}function AddonModH5PActivityUserAttemptsPage_core_empty_box_16_Template(t,e){1&t&&(m.zc(0,"core-empty-box",18),m.Pc(1,"translate")),2&t&&m.Vc("message",m.Qc(1,1,"addon.mod_h5pactivity.attempts_none"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_18_Template(t,e){1&t&&(m.zc(0,"img",33),m.Pc(1,"translate")),2&t&&m.Vc("alt",m.Qc(1,1,"addon.mod_h5pactivity.attempt_completion_yes"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_19_Template(t,e){1&t&&(m.zc(0,"img",34),m.Pc(1,"translate")),2&t&&m.Vc("alt",m.Qc(1,1,"addon.mod_h5pactivity.attempt_completion_no"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_ion_icon_21_Template(t,e){1&t&&(m.zc(0,"ion-icon",35),m.Pc(1,"translate")),2&t&&m.mc("aria-label",m.Qc(1,1,"addon.mod_h5pactivity.attempt_success_pass"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_ion_icon_22_Template(t,e){1&t&&(m.zc(0,"ion-icon",36),m.Pc(1,"translate")),2&t&&m.mc("aria-label",m.Qc(1,1,"addon.mod_h5pactivity.attempt_success_fail"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_23_Template(t,e){1&t&&(m.zc(0,"img",37),m.Pc(1,"translate")),2&t&&m.Vc("alt",m.Qc(1,1,"addon.mod_h5pactivity.attempt_success_unknown"))}const _c1=function(t){return{$a:t}};function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_Template(t,e){if(1&t){const t=m.Fc();m.Ec(0,"ion-item",25),m.Mc("click",(function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_Template_ion_item_click_0_listener(){m.fd(t);const n=e.$implicit;return m.Oc(2).openAttempt(n)})),m.Pc(1,"translate"),m.Ec(2,"ion-label"),m.Ec(3,"ion-row",20),m.Ec(4,"ion-col",21),m.pd(5),m.Dc(),m.Ec(6,"ion-col",22),m.pd(7),m.Pc(8,"coreFormatDate"),m.Dc(),m.Ec(9,"ion-col",21),m.pd(10),m.Ec(11,"span",26),m.pd(12),m.Dc(),m.Dc(),m.Ec(13,"ion-col",23),m.pd(14),m.Dc(),m.Ec(15,"ion-col",23),m.pd(16),m.Dc(),m.Ec(17,"ion-col",23),m.nd(18,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_18_Template,2,3,"img",27),m.nd(19,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_19_Template,2,3,"img",28),m.Dc(),m.Ec(20,"ion-col",29),m.nd(21,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_ion_icon_21_Template,2,3,"ion-icon",30),m.nd(22,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_ion_icon_22_Template,2,3,"ion-icon",31),m.nd(23,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_23_Template,2,3,"img",32),m.Dc(),m.Dc(),m.Dc(),m.Dc()}if(2&t){const t=e.$implicit;m.mc("aria-label",m.Rc(1,12,"addon.mod_h5pactivity.viewattempt",m.ad(18,_c1,t.attempt))),m.lc(5),m.qd(t.attempt),m.lc(2),m.rd(" ",m.Rc(8,15,t.timemodified,"strftimedatetimeshort")," "),m.lc(3),m.rd(" ",t.rawscore,""),m.lc(2),m.rd(" / ",t.maxscore,""),m.lc(2),m.qd(t.maxscore),m.lc(2),m.qd(t.durationReadable),m.lc(2),m.Vc("ngIf",t.completion),m.lc(1),m.Vc("ngIf",!t.completion),m.lc(2),m.Vc("ngIf",null!==t.success&&t.success),m.lc(1),m.Vc("ngIf",null!==t.success&&!t.success),m.lc(1),m.Vc("ngIf",null===t.success)}}function AddonModH5PActivityUserAttemptsPage_ng_template_17_Template(t,e){if(1&t&&(m.Ec(0,"ion-item",19),m.Ec(1,"ion-label"),m.Ec(2,"ion-row",20),m.Ec(3,"ion-col",21),m.pd(4,"#"),m.Dc(),m.Ec(5,"ion-col",22),m.pd(6),m.Pc(7,"translate"),m.Dc(),m.Ec(8,"ion-col",21),m.pd(9),m.Pc(10,"translate"),m.Dc(),m.Ec(11,"ion-col",23),m.pd(12),m.Pc(13,"translate"),m.Dc(),m.Ec(14,"ion-col",23),m.pd(15),m.Pc(16,"translate"),m.Dc(),m.Ec(17,"ion-col",23),m.pd(18),m.Pc(19,"translate"),m.Dc(),m.Ec(20,"ion-col",21),m.pd(21),m.Pc(22,"translate"),m.Dc(),m.Dc(),m.Dc(),m.Dc(),m.nd(23,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_Template,24,20,"ion-item",24)),2&t){const t=e.attempts;m.lc(6),m.qd(m.Qc(7,7,"core.date")),m.lc(3),m.qd(m.Qc(10,9,"addon.mod_h5pactivity.score")),m.lc(3),m.qd(m.Qc(13,11,"addon.mod_h5pactivity.maxscore")),m.lc(3),m.qd(m.Qc(16,13,"addon.mod_h5pactivity.duration")),m.lc(3),m.qd(m.Qc(19,15,"addon.mod_h5pactivity.completion")),m.lc(3),m.qd(m.Qc(22,17,"core.success")),m.lc(2),m.Vc("ngForOf",t)}}let V=(()=>{class AddonModH5PActivityUserAttemptsPage{constructor(){this.loaded=!1,this.isCurrentUser=!1,this.logView=b.a.once((()=>Object(d.a)(this,void 0,void 0,(function*(){this.h5pActivity&&(yield M.a.ignoreErrors(D.a.logViewReport(this.h5pActivity.id,{userId:this.userId})),E.a.logEvent({type:E.b.VIEW_ITEM,ws:"mod_h5pactivity_log_report_viewed",name:this.h5pActivity.name,data:{id:this.h5pActivity.id,userid:this.userId,category:"h5pactivity"},url:`/mod/h5pactivity/report.php?a=${this.h5pActivity.id}&userid=${this.userId}`}))}))))}ngOnInit(){return Object(d.a)(this,void 0,void 0,(function*(){try{this.courseId=f.a.getRequiredRouteNumberParam("courseId"),this.cmId=f.a.getRequiredRouteNumberParam("cmId"),this.userId=f.a.getRouteNumberParam("userId")||I.b.getCurrentSiteUserId()}catch(t){return r.a.showErrorModal(t),f.a.back(),void 0}this.isCurrentUser=this.userId==I.b.getCurrentSiteUserId(),yield this.fetchData()}))}doRefresh(t){this.refreshData().finally((()=>{t.complete()}))}fetchData(){return Object(d.a)(this,void 0,void 0,(function*(){try{this.h5pActivity=yield D.a.getH5PActivity(this.courseId,this.cmId),yield Promise.all([this.fetchAttempts(),this.fetchUserProfile()]),this.logView()}catch(t){r.a.showErrorModalDefault(t,"Error loading attempts.")}finally{this.loaded=!0}}))}fetchAttempts(){return Object(d.a)(this,void 0,void 0,(function*(){this.h5pActivity&&(this.attemptsData=yield D.a.getUserAttempts(this.h5pActivity.id,{cmId:this.cmId,userId:this.userId}))}))}fetchUserProfile(){return Object(d.a)(this,void 0,void 0,(function*(){try{this.user=yield y.a.getProfile(this.userId,this.courseId,!0)}catch(t){}}))}refreshData(){return Object(d.a)(this,void 0,void 0,(function*(){const t=[D.a.invalidateActivityData(this.courseId)];this.h5pActivity&&t.push(D.a.invalidateUserAttempts(this.h5pActivity.id,this.userId)),yield M.a.ignoreErrors(Promise.all(t)),yield this.fetchData()}))}openAttempt(t){f.a.navigate(`../../attemptresults/${t.id}`)}}return AddonModH5PActivityUserAttemptsPage.ɵfac=function AddonModH5PActivityUserAttemptsPage_Factory(t){return new(t||AddonModH5PActivityUserAttemptsPage)},AddonModH5PActivityUserAttemptsPage.ɵcmp=m.sc({type:AddonModH5PActivityUserAttemptsPage,selectors:[["page-addon-mod-h5pactivity-user-attempts"]],decls:19,vars:13,consts:[["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId",4,"ngIf"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["class","ion-text-wrap","core-user-link","","button","","detail","true",3,"userId","courseId",4,"ngIf"],["class","ion-text-wrap",4,"ngIf"],[4,"ngIf"],["icon","fas-chart-bar",3,"message",4,"ngIf"],["attemptsTemplate",""],["contextLevel","module",3,"text","contextInstanceId","courseId"],["core-user-link","","button","","detail","true",1,"ion-text-wrap",3,"userId","courseId"],["slot","start",3,"user","courseId","linkProfile"],[1,"ion-text-wrap"],["slot","start",3,"user","courseId"],[1,"item-heading"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["icon","fas-chart-bar",3,"message"],["detail","true",1,"addon-mod_h5pactivity-table-header","hide-detail"],[1,"ion-align-items-center"],[1,"ion-text-center"],["size","5","size-md","2",1,"ion-text-center"],[1,"ion-text-center","ion-hide-md-down"],["class","ion-text-wrap addon-mod_h5pactivity-table-row","button","","detail","true",3,"click",4,"ngFor","ngForOf"],["button","","detail","true",1,"ion-text-wrap","addon-mod_h5pactivity-table-row",3,"click"],[1,"ion-hide-md-up"],["src","assets/img/completion/completion-auto-y.svg",3,"alt",4,"ngIf"],["src","assets/img/completion/completion-auto-n.svg",3,"alt",4,"ngIf"],[1,"ion-text-center","addon-mod_h5pactivity-table-success-col"],["name","fas-circle-check",4,"ngIf"],["name","far-circle",4,"ngIf"],["src","assets/img/icons/empty.svg",3,"alt",4,"ngIf"],["src","assets/img/completion/completion-auto-y.svg",3,"alt"],["src","assets/img/completion/completion-auto-n.svg",3,"alt"],["name","fas-circle-check"],["name","far-circle"],["src","assets/img/icons/empty.svg",3,"alt"]],template:function AddonModH5PActivityUserAttemptsPage_Template(t,e){1&t&&(m.Ec(0,"ion-header"),m.Ec(1,"ion-toolbar"),m.Ec(2,"ion-buttons",0),m.zc(3,"ion-back-button",1),m.Pc(4,"translate"),m.Dc(),m.Ec(5,"ion-title"),m.Ec(6,"h1"),m.nd(7,AddonModH5PActivityUserAttemptsPage_core_format_text_7_Template,1,3,"core-format-text",2),m.Dc(),m.Dc(),m.Dc(),m.Dc(),m.Ec(8,"ion-content"),m.Ec(9,"ion-refresher",3),m.Mc("ionRefresh",(function AddonModH5PActivityUserAttemptsPage_Template_ion_refresher_ionRefresh_9_listener(t){return e.doRefresh(t.target)})),m.zc(10,"ion-refresher-content",4),m.Pc(11,"translate"),m.Dc(),m.Ec(12,"core-loading",5),m.nd(13,AddonModH5PActivityUserAttemptsPage_ion_item_13_Template,5,7,"ion-item",6),m.nd(14,AddonModH5PActivityUserAttemptsPage_ion_item_14_Template,6,5,"ion-item",7),m.nd(15,AddonModH5PActivityUserAttemptsPage_ion_list_15_Template,3,2,"ion-list",8),m.nd(16,AddonModH5PActivityUserAttemptsPage_core_empty_box_16_Template,2,3,"core-empty-box",9),m.Dc(),m.Dc(),m.nd(17,AddonModH5PActivityUserAttemptsPage_ng_template_17_Template,24,19,"ng-template",null,10,m.od)),2&t&&(m.lc(3),m.Vc("text",m.Qc(4,9,"core.back")),m.lc(4),m.Vc("ngIf",e.h5pActivity),m.lc(2),m.Vc("disabled",!e.loaded),m.lc(1),m.Wc("pullingText",m.Qc(11,11,"core.pulltorefresh")),m.lc(2),m.Vc("hideUntil",e.loaded),m.lc(1),m.Vc("ngIf",e.user&&!e.isCurrentUser),m.lc(1),m.Vc("ngIf",e.user&&e.isCurrentUser),m.lc(1),m.Vc("ngIf",e.attemptsData),m.lc(1),m.Vc("ngIf",e.attemptsData&&(!e.attemptsData.attempts||!e.attemptsData.attempts.length)))},directives:[p.C,p.Ab,p.m,p.h,p.i,p.yb,H.t,A.a,p.v,p.bb,p.cb,T.a,u.a,p.I,x.a,O.a,p.O,p.P,p.J,H.A,R.a,p.hb,p.u,H.s,p.D,w.a],pipes:[h.d,U.a],styles:["[_nghost-%COMP%]   .addon-mod_h5pactivity-table-header[_ngcontent-%COMP%]{font-weight:700}[_nghost-%COMP%]   .addon-mod_h5pactivity-table-header[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]   .addon-mod_h5pactivity-table-row[_ngcontent-%COMP%]   .addon-mod_h5pactivity-table-success-col[_ngcontent-%COMP%]{font-size:1.2em}"]}),AddonModH5PActivityUserAttemptsPage})();function AddonModH5PActivityAttemptResultsPage_core_format_text_7_Template(t,e){if(1&t&&m.zc(0,"core-format-text",8),2&t){const t=m.Oc();m.Vc("text",t.h5pActivity.name)("contextInstanceId",t.h5pActivity.coursemodule)("courseId",t.courseId)}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ion_item_1_Template(t,e){if(1&t&&(m.Ec(0,"ion-item",14),m.zc(1,"core-user-avatar",15),m.Ec(2,"ion-label"),m.Ec(3,"p",13),m.pd(4),m.Pc(5,"translate"),m.Dc(),m.Dc(),m.Dc()),2&t){const t=m.Oc(2);m.Vc("userId",t.user.id)("courseId",t.courseId),m.mc("aria-label",t.user.fullname),m.lc(1),m.Vc("user",t.user)("courseId",t.courseId)("linkProfile",!1),m.lc(3),m.td("",m.Qc(5,9,"addon.mod_h5pactivity.attempt")," #",t.attempt.attempt,": ",t.user.fullname,"")}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ion_item_2_Template(t,e){if(1&t&&(m.Ec(0,"ion-item",12),m.Ec(1,"ion-label"),m.Ec(2,"p",13),m.pd(3),m.Pc(4,"translate"),m.Dc(),m.Dc(),m.Dc()),2&t){const t=m.Oc(2);m.lc(3),m.sd("",m.Qc(4,2,"addon.mod_h5pactivity.attempt")," #",t.attempt.attempt,"")}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_p_18_Template(t,e){1&t&&(m.Ec(0,"p"),m.zc(1,"img",16),m.pd(2),m.Pc(3,"translate"),m.Dc()),2&t&&(m.lc(2),m.rd(" ",m.Qc(3,1,"addon.mod_h5pactivity.attempt_completion_yes")," "))}function AddonModH5PActivityAttemptResultsPage_ng_container_13_p_19_Template(t,e){1&t&&(m.Ec(0,"p"),m.zc(1,"img",17),m.pd(2),m.Pc(3,"translate"),m.Dc()),2&t&&(m.lc(2),m.rd(" ",m.Qc(3,1,"addon.mod_h5pactivity.attempt_completion_no")," "))}function AddonModH5PActivityAttemptResultsPage_ng_container_13_p_32_Template(t,e){1&t&&(m.Ec(0,"p"),m.zc(1,"ion-icon",18),m.pd(2),m.Pc(3,"translate"),m.Dc()),2&t&&(m.lc(2),m.rd(" ",m.Qc(3,1,"addon.mod_h5pactivity.attempt_success_pass")," "))}function AddonModH5PActivityAttemptResultsPage_ng_container_13_p_33_Template(t,e){1&t&&(m.Ec(0,"p"),m.zc(1,"ion-icon",19),m.pd(2),m.Pc(3,"translate"),m.Dc()),2&t&&(m.lc(2),m.rd(" ",m.Qc(3,1,"addon.mod_h5pactivity.attempt_success_fail")," "))}function AddonModH5PActivityAttemptResultsPage_ng_container_13_p_34_Template(t,e){1&t&&(m.Ec(0,"p"),m.pd(1),m.Pc(2,"translate"),m.Dc()),2&t&&(m.lc(1),m.rd(" ",m.Qc(2,1,"addon.mod_h5pactivity.attempt_success_unknown")," "))}const attempt_results_c0=function(t){return{$a:t}};function AddonModH5PActivityAttemptResultsPage_ng_container_13_ion_item_35_Template(t,e){if(1&t&&(m.Ec(0,"ion-item",12),m.Ec(1,"ion-label"),m.Ec(2,"p",13),m.pd(3),m.Pc(4,"translate"),m.Dc(),m.Ec(5,"p"),m.pd(6),m.Pc(7,"translate"),m.Dc(),m.Dc(),m.Dc()),2&t){const t=m.Oc(2);m.lc(3),m.qd(m.Qc(4,2,"addon.mod_h5pactivity.totalscore")),m.lc(3),m.qd(m.Rc(7,4,"addon.mod_h5pactivity.score_out_of",m.ad(7,attempt_results_c0,t.attempt)))}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ion_item_4_Template(t,e){if(1&t&&(m.Ec(0,"ion-item",12),m.Ec(1,"ion-label"),m.zc(2,"core-format-text",21),m.Dc(),m.Dc()),2&t){const t=m.Oc().$implicit,e=m.Oc(3);m.lc(2),m.Vc("text",t.content)("component",e.component)("componentId",e.cmId)("contextInstanceId",e.cmId)("courseId",e.courseId)}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_6_ng_container_1_Template(t,e){1&t&&m.Ac(0)}const attempt_results_c1=function(t){return{answer:t}};function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_6_Template(t,e){if(1&t&&(m.Cc(0),m.nd(1,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_6_ng_container_1_Template,1,0,"ng-container",30),m.Bc()),2&t){const t=m.Oc().$implicit;m.Oc(5);const e=m.ed(15);m.lc(1),m.Vc("ngTemplateOutlet",e)("ngTemplateOutletContext",m.ad(2,attempt_results_c1,t.correctanswer))}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_8_ng_container_1_Template(t,e){1&t&&m.Ac(0)}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_8_Template(t,e){if(1&t&&(m.Cc(0),m.nd(1,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_8_ng_container_1_Template,1,0,"ng-container",30),m.Bc()),2&t){const t=m.Oc().$implicit;m.Oc(5);const e=m.ed(15);m.lc(1),m.Vc("ngTemplateOutlet",e)("ngTemplateOutletContext",m.ad(2,attempt_results_c1,t.useranswer))}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_Template(t,e){if(1&t&&(m.Ec(0,"ion-item",29),m.Ec(1,"ion-label"),m.Ec(2,"ion-row",24),m.Ec(3,"ion-col",25),m.zc(4,"core-format-text",21),m.Dc(),m.Ec(5,"ion-col",26),m.nd(6,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_6_Template,2,4,"ng-container",6),m.Dc(),m.Ec(7,"ion-col",26),m.nd(8,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_8_Template,2,4,"ng-container",6),m.Dc(),m.Dc(),m.Dc(),m.Dc()),2&t){const t=e.$implicit,n=m.Oc(5);m.lc(4),m.Vc("text",t.description)("component",n.component)("componentId",n.cmId)("contextInstanceId",n.cmId)("courseId",n.courseId),m.lc(2),m.Vc("ngIf",t.correctanswer),m.lc(2),m.Vc("ngIf",t.useranswer)}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_11_Template(t,e){if(1&t&&(m.Ec(0,"ion-item",31),m.Ec(1,"ion-label"),m.Ec(2,"p"),m.Ec(3,"strong"),m.pd(4),m.Pc(5,"translate"),m.Pc(6,"translate"),m.Dc(),m.Dc(),m.Dc(),m.Dc()),2&t){const t=m.Oc(2).$implicit;m.lc(4),m.sd(" ",m.Qc(5,2,"addon.mod_h5pactivity.score"),": ",m.Rc(6,4,"addon.mod_h5pactivity.score_out_of",m.ad(7,attempt_results_c0,t))," ")}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_Template(t,e){if(1&t&&(m.Cc(0),m.Ec(1,"ion-item",23),m.Ec(2,"ion-label"),m.Ec(3,"ion-row",24),m.Ec(4,"ion-col",25),m.pd(5),m.Dc(),m.Ec(6,"ion-col",26),m.pd(7),m.Dc(),m.Ec(8,"ion-col",26),m.pd(9),m.Dc(),m.Dc(),m.Dc(),m.Dc(),m.nd(10,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_Template,9,7,"ion-item",27),m.nd(11,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_11_Template,7,9,"ion-item",28),m.Bc()),2&t){const t=m.Oc().$implicit;m.lc(5),m.qd(t.optionslabel),m.lc(2),m.qd(t.correctlabel),m.lc(2),m.qd(t.answerlabel),m.lc(1),m.Vc("ngForOf",t.options),m.lc(1),m.Vc("ngIf",t.maxscore)}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ion_item_6_Template(t,e){if(1&t&&(m.Ec(0,"ion-item",32),m.zc(1,"ion-icon",33),m.Ec(2,"ion-label"),m.pd(3),m.Pc(4,"translate"),m.Dc(),m.Dc()),2&t){const t=m.Oc().$implicit;m.lc(3),m.rd(" ",m.Rc(4,1,"addon.mod_h5pactivity.no_compatible_track",m.ad(4,attempt_results_c0,t.interactiontype))," ")}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_Template(t,e){if(1&t&&(m.Ec(0,"ion-card"),m.Ec(1,"ion-card-header",12),m.Ec(2,"ion-card-title"),m.zc(3,"core-format-text",21),m.Dc(),m.Dc(),m.nd(4,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ion_item_4_Template,3,5,"ion-item",10),m.nd(5,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_Template,12,5,"ng-container",6),m.nd(6,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ion_item_6_Template,5,6,"ion-item",22),m.Dc()),2&t){const t=e.$implicit,n=m.Oc(3);m.lc(3),m.Vc("text",t.description)("component",n.component)("componentId",n.cmId)("contextInstanceId",n.cmId)("courseId",n.courseId),m.lc(1),m.Vc("ngIf",t.content),m.lc(1),m.Vc("ngIf",t.options&&t.options.length),m.lc(1),m.Vc("ngIf",!t.track)}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_Template(t,e){if(1&t&&(m.Cc(0),m.nd(1,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_Template,7,8,"ion-card",20),m.Bc()),2&t){const t=m.Oc(2);m.lc(1),m.Vc("ngForOf",t.attempt.results)}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_Template(t,e){if(1&t&&(m.Cc(0),m.nd(1,AddonModH5PActivityAttemptResultsPage_ng_container_13_ion_item_1_Template,6,11,"ion-item",9),m.nd(2,AddonModH5PActivityAttemptResultsPage_ng_container_13_ion_item_2_Template,5,4,"ion-item",10),m.Ec(3,"ion-card",11),m.Ec(4,"ion-list"),m.Ec(5,"ion-item",12),m.Ec(6,"ion-label"),m.Ec(7,"p",13),m.pd(8),m.Pc(9,"translate"),m.Dc(),m.Ec(10,"p"),m.pd(11),m.Pc(12,"coreFormatDate"),m.Dc(),m.Dc(),m.Dc(),m.Ec(13,"ion-item",12),m.Ec(14,"ion-label"),m.Ec(15,"p",13),m.pd(16),m.Pc(17,"translate"),m.Dc(),m.nd(18,AddonModH5PActivityAttemptResultsPage_ng_container_13_p_18_Template,4,3,"p",6),m.nd(19,AddonModH5PActivityAttemptResultsPage_ng_container_13_p_19_Template,4,3,"p",6),m.Dc(),m.Dc(),m.Ec(20,"ion-item",12),m.Ec(21,"ion-label"),m.Ec(22,"p",13),m.pd(23),m.Pc(24,"translate"),m.Dc(),m.Ec(25,"p"),m.pd(26),m.Dc(),m.Dc(),m.Dc(),m.Ec(27,"ion-item",12),m.Ec(28,"ion-label"),m.Ec(29,"p",13),m.pd(30),m.Pc(31,"translate"),m.Dc(),m.nd(32,AddonModH5PActivityAttemptResultsPage_ng_container_13_p_32_Template,4,3,"p",6),m.nd(33,AddonModH5PActivityAttemptResultsPage_ng_container_13_p_33_Template,4,3,"p",6),m.nd(34,AddonModH5PActivityAttemptResultsPage_ng_container_13_p_34_Template,3,3,"p",6),m.Dc(),m.Dc(),m.nd(35,AddonModH5PActivityAttemptResultsPage_ng_container_13_ion_item_35_Template,8,9,"ion-item",10),m.Dc(),m.Dc(),m.nd(36,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_Template,2,1,"ng-container",6),m.Bc()),2&t){const t=m.Oc();m.lc(1),m.Vc("ngIf",t.user),m.lc(1),m.Vc("ngIf",!t.user),m.lc(6),m.qd(m.Qc(9,15,"addon.mod_h5pactivity.startdate")),m.lc(3),m.qd(m.Rc(12,17,t.attempt.timecreated,"strftimedatetime")),m.lc(5),m.qd(m.Qc(17,20,"addon.mod_h5pactivity.completion")),m.lc(2),m.Vc("ngIf",t.attempt.completion),m.lc(1),m.Vc("ngIf",!t.attempt.completion),m.lc(4),m.qd(m.Qc(24,22,"addon.mod_h5pactivity.duration")),m.lc(3),m.qd(t.attempt.durationReadable),m.lc(4),m.qd(m.Qc(31,24,"addon.mod_h5pactivity.outcome")),m.lc(2),m.Vc("ngIf",null!==t.attempt.success&&t.attempt.success),m.lc(1),m.Vc("ngIf",null!==t.attempt.success&&!t.attempt.success),m.lc(1),m.Vc("ngIf",null===t.attempt.success),m.lc(1),m.Vc("ngIf",t.attempt.maxscore),m.lc(1),m.Vc("ngIf",t.attempt.results)}}function AddonModH5PActivityAttemptResultsPage_ng_template_14_p_0_Template(t,e){if(1&t&&(m.Ec(0,"p"),m.zc(1,"ion-icon",34),m.Pc(2,"translate"),m.pd(3),m.Dc()),2&t){const t=m.Oc().answer;m.lc(1),m.mc("aria-label",m.Qc(2,2,"addon.mod_h5pactivity.answer_correct")),m.lc(2),m.rd(" ",t.answer," ")}}function AddonModH5PActivityAttemptResultsPage_ng_template_14_p_1_Template(t,e){if(1&t&&(m.Ec(0,"p"),m.zc(1,"ion-icon",35),m.Pc(2,"translate"),m.pd(3),m.Dc()),2&t){const t=m.Oc().answer;m.lc(1),m.mc("aria-label",m.Qc(2,2,"addon.mod_h5pactivity.answer_incorrect")),m.lc(2),m.rd(" ",t.answer," ")}}function AddonModH5PActivityAttemptResultsPage_ng_template_14_p_2_Template(t,e){if(1&t&&(m.Ec(0,"p"),m.pd(1),m.Dc()),2&t){const t=m.Oc().answer;m.lc(1),m.rd(" ",t.answer," ")}}function AddonModH5PActivityAttemptResultsPage_ng_template_14_p_3_Template(t,e){1&t&&(m.Ec(0,"p"),m.zc(1,"ion-icon",36),m.Pc(2,"translate"),m.Dc()),2&t&&(m.lc(1),m.mc("aria-label",m.Qc(2,1,"addon.mod_h5pactivity.answer_checked")))}function AddonModH5PActivityAttemptResultsPage_ng_template_14_p_4_Template(t,e){1&t&&(m.Ec(0,"p"),m.zc(1,"ion-icon",34),m.Pc(2,"translate"),m.Dc()),2&t&&(m.lc(1),m.mc("aria-label",m.Qc(2,1,"addon.mod_h5pactivity.answer_pass")))}function AddonModH5PActivityAttemptResultsPage_ng_template_14_p_5_Template(t,e){1&t&&(m.Ec(0,"p"),m.zc(1,"ion-icon",35),m.Pc(2,"translate"),m.Dc()),2&t&&(m.lc(1),m.mc("aria-label",m.Qc(2,1,"addon.mod_h5pactivity.answer_fail")))}function AddonModH5PActivityAttemptResultsPage_ng_template_14_Template(t,e){if(1&t&&(m.nd(0,AddonModH5PActivityAttemptResultsPage_ng_template_14_p_0_Template,4,4,"p",6),m.nd(1,AddonModH5PActivityAttemptResultsPage_ng_template_14_p_1_Template,4,4,"p",6),m.nd(2,AddonModH5PActivityAttemptResultsPage_ng_template_14_p_2_Template,2,1,"p",6),m.nd(3,AddonModH5PActivityAttemptResultsPage_ng_template_14_p_3_Template,3,3,"p",6),m.nd(4,AddonModH5PActivityAttemptResultsPage_ng_template_14_p_4_Template,3,3,"p",6),m.nd(5,AddonModH5PActivityAttemptResultsPage_ng_template_14_p_5_Template,3,3,"p",6)),2&t){const t=e.answer;m.Vc("ngIf",t.correct),m.lc(1),m.Vc("ngIf",t.incorrect),m.lc(1),m.Vc("ngIf",t.text),m.lc(1),m.Vc("ngIf",t.checked),m.lc(1),m.Vc("ngIf",t.pass),m.lc(1),m.Vc("ngIf",t.fail)}}let C=(()=>{class AddonModH5PActivityAttemptResultsPage{constructor(){this.loaded=!1,this.component=D.b.COMPONENT,this.logView=b.a.once((()=>Object(d.a)(this,void 0,void 0,(function*(){this.h5pActivity&&(yield M.a.ignoreErrors(D.a.logViewReport(this.h5pActivity.id,{attemptId:this.attemptId})),E.a.logEvent({type:E.b.VIEW_ITEM,ws:"mod_h5pactivity_log_report_viewed",name:this.h5pActivity.name,data:{id:this.h5pActivity.id,attemptid:this.attemptId,category:"h5pactivity"},url:`/mod/h5pactivity/report.php?a=${this.h5pActivity.id}&attemptid=${this.attemptId}`}))}))))}ngOnInit(){return Object(d.a)(this,void 0,void 0,(function*(){try{this.courseId=f.a.getRequiredRouteNumberParam("courseId"),this.cmId=f.a.getRequiredRouteNumberParam("cmId"),this.attemptId=f.a.getRequiredRouteNumberParam("attemptId")}catch(t){return r.a.showErrorModal(t),f.a.back(),void 0}yield this.fetchData()}))}doRefresh(t){this.refreshData().finally((()=>{t.complete()}))}fetchData(){return Object(d.a)(this,void 0,void 0,(function*(){try{this.h5pActivity=yield D.a.getH5PActivity(this.courseId,this.cmId),this.attempt=yield D.a.getAttemptResults(this.h5pActivity.id,this.attemptId,{cmId:this.cmId}),yield this.fetchUserProfile(),this.logView()}catch(t){r.a.showErrorModalDefault(t,"Error loading attempt.")}finally{this.loaded=!0}}))}fetchUserProfile(){return Object(d.a)(this,void 0,void 0,(function*(){if(this.attempt)try{this.user=yield y.a.getProfile(this.attempt.userid,this.courseId,!0)}catch(t){}}))}refreshData(){return Object(d.a)(this,void 0,void 0,(function*(){const t=[D.a.invalidateActivityData(this.courseId)];this.h5pActivity&&t.push(D.a.invalidateAttemptResults(this.h5pActivity.id,this.attemptId)),yield M.a.ignoreErrors(Promise.all(t)),yield this.fetchData()}))}}return AddonModH5PActivityAttemptResultsPage.ɵfac=function AddonModH5PActivityAttemptResultsPage_Factory(t){return new(t||AddonModH5PActivityAttemptResultsPage)},AddonModH5PActivityAttemptResultsPage.ɵcmp=m.sc({type:AddonModH5PActivityAttemptResultsPage,selectors:[["page-addon-mod-h5pactivity-attempt-results"]],decls:16,vars:10,consts:[["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId",4,"ngIf"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[4,"ngIf"],["answerTemplate",""],["contextLevel","module",3,"text","contextInstanceId","courseId"],["class","ion-text-wrap","core-user-link","",3,"userId","courseId",4,"ngIf"],["class","ion-text-wrap",4,"ngIf"],[1,"addon-mod_h5pactivity-attempt-result-summary"],[1,"ion-text-wrap"],[1,"item-heading"],["core-user-link","",1,"ion-text-wrap",3,"userId","courseId"],["slot","start",3,"user","courseId","linkProfile"],["src","assets/img/completion/completion-auto-y.svg","role","presentation","alt",""],["src","assets/img/completion/completion-auto-n.svg","role","presentation","alt",""],["name","fas-circle-check","aria-hidden","true"],["name","far-circle","aria-hidden","true"],[4,"ngFor","ngForOf"],["contextLevel","module",3,"text","component","componentId","contextInstanceId","courseId"],["class","ion-text-wrap core-warning-item",4,"ngIf"],[1,"ion-text-wrap","addon-mod_h5pactivity-result-table-header"],[1,"ion-align-items-center"],[1,"ion-text-start"],[1,"ion-text-center"],["class","ion-text-wrap addon-mod_h5pactivity-result-table-row",4,"ngFor","ngForOf"],["class","ion-text-wrap ion-text-end addon-mod_h5pactivity-result-score",4,"ngIf"],[1,"ion-text-wrap","addon-mod_h5pactivity-result-table-row"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"ion-text-wrap","ion-text-end","addon-mod_h5pactivity-result-score"],[1,"ion-text-wrap","core-warning-item"],["slot","start","name","fas-triangle-exclamation","color","warning","aria-hidden","true"],["name","fas-check","color","success"],["name","fas-xmark","color","danger"],["name","fas-circle-check"]],template:function AddonModH5PActivityAttemptResultsPage_Template(t,e){1&t&&(m.Ec(0,"ion-header"),m.Ec(1,"ion-toolbar"),m.Ec(2,"ion-buttons",0),m.zc(3,"ion-back-button",1),m.Pc(4,"translate"),m.Dc(),m.Ec(5,"ion-title"),m.Ec(6,"h1"),m.nd(7,AddonModH5PActivityAttemptResultsPage_core_format_text_7_Template,1,3,"core-format-text",2),m.Dc(),m.Dc(),m.Dc(),m.Dc(),m.Ec(8,"ion-content"),m.Ec(9,"ion-refresher",3),m.Mc("ionRefresh",(function AddonModH5PActivityAttemptResultsPage_Template_ion_refresher_ionRefresh_9_listener(t){return e.doRefresh(t.target)})),m.zc(10,"ion-refresher-content",4),m.Pc(11,"translate"),m.Dc(),m.Ec(12,"core-loading",5),m.nd(13,AddonModH5PActivityAttemptResultsPage_ng_container_13_Template,37,26,"ng-container",6),m.Dc(),m.Dc(),m.nd(14,AddonModH5PActivityAttemptResultsPage_ng_template_14_Template,6,6,"ng-template",null,7,m.od)),2&t&&(m.lc(3),m.Vc("text",m.Qc(4,6,"core.back")),m.lc(4),m.Vc("ngIf",e.h5pActivity),m.lc(2),m.Vc("disabled",!e.loaded),m.lc(1),m.Wc("pullingText",m.Qc(11,8,"core.pulltorefresh")),m.lc(2),m.Vc("hideUntil",e.loaded),m.lc(1),m.Vc("ngIf",e.attempt))},directives:[p.C,p.Ab,p.m,p.h,p.i,p.yb,H.t,A.a,p.v,p.bb,p.cb,T.a,u.a,p.n,p.P,p.I,p.O,x.a,O.a,p.D,w.a,H.s,p.p,p.r,p.hb,p.u,H.A],pipes:[h.d,U.a],styles:["[_nghost-%COMP%]   .core-warning-item[_ngcontent-%COMP%]{--inner-border-width:0px}[_nghost-%COMP%]   .addon-mod_h5pactivity-attempt-result-summary[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:16px;height:16px;display:inline;margin-left:0;margin-right:4px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){[_nghost-%COMP%]   .addon-mod_h5pactivity-attempt-result-summary[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:4px;margin-inline-end:4px}}[_nghost-%COMP%]   .addon-mod_h5pactivity-attempt-result-summary[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-mod_h5pactivity-result-table-header[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-mod_h5pactivity-result-table-row[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.2em}[_nghost-%COMP%]   .addon-mod_h5pactivity-result-table-header[_ngcontent-%COMP%]{font-weight:700}[_nghost-%COMP%]   .addon-mod_h5pactivity-result-table-row.item[_ngcontent-%COMP%]:nth-child(2n){--background:var(--light)}[_nghost-%COMP%]   .addon-mod_h5pactivity-result-score[_ngcontent-%COMP%]{border-top:1px solid #000}html.dark[_nghost-%COMP%]   .addon-mod_h5pactivity-result-table-row.item[_ngcontent-%COMP%]:nth-child(2n), html.dark   [_nghost-%COMP%]   .addon-mod_h5pactivity-result-table-row.item[_ngcontent-%COMP%]:nth-child(2n){--background:var(--gray-900)}"]}),AddonModH5PActivityAttemptResultsPage})();var z=n("xpMl");function AddonModH5PActivityUsersAttemptsPage_core_format_text_7_Template(t,e){if(1&t&&m.zc(0,"core-format-text",9),2&t){const t=m.Oc();m.Vc("text",t.h5pActivity.name)("contextInstanceId",t.h5pActivity.coursemodule)("courseId",t.courseId)}}function AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_9_Template(t,e){if(1&t&&(m.Ec(0,"span"),m.pd(1),m.Pc(2,"coreFormatDate"),m.Dc()),2&t){const t=m.Oc().$implicit;m.lc(1),m.rd(" ",m.Rc(2,1,t.attempts[t.attempts.length-1].timemodified,"strftimedatetimeshort")," ")}}function AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_10_Template(t,e){1&t&&(m.Ec(0,"span"),m.pd(1,"-"),m.Dc())}const users_attempts_c0=function(t){return{$a:t}};function AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_12_Template(t,e){if(1&t&&(m.Ec(0,"span"),m.pd(1),m.Pc(2,"translate"),m.Dc()),2&t){const t=m.Oc().$implicit;m.lc(1),m.rd(" ",m.Rc(2,1,"core.percentagenumber",m.ad(4,users_attempts_c0,t.score))," ")}}function AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_13_Template(t,e){1&t&&(m.Ec(0,"span"),m.pd(1,"-"),m.Dc())}function AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_Template(t,e){if(1&t){const t=m.Fc();m.Ec(0,"ion-item",15),m.Mc("click",(function AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_Template_ion_item_click_0_listener(){m.fd(t);const n=e.$implicit;return m.Oc(2).openUser(n)})),m.Pc(1,"translate"),m.Ec(2,"ion-label"),m.Ec(3,"ion-row",11),m.Ec(4,"ion-col",12),m.Ec(5,"p"),m.zc(6,"core-user-avatar",16),m.Dc(),m.pd(7),m.Dc(),m.Ec(8,"ion-col",12),m.nd(9,AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_9_Template,3,4,"span",6),m.nd(10,AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_10_Template,2,0,"span",6),m.Dc(),m.Ec(11,"ion-col",13),m.nd(12,AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_12_Template,3,6,"span",6),m.nd(13,AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_13_Template,2,0,"span",6),m.Dc(),m.Ec(14,"ion-col",13),m.pd(15),m.Dc(),m.Dc(),m.Dc(),m.Dc()}if(2&t){const t=e.$implicit,n=m.Oc(2);m.qc("hide-detail",!t.attempts.length),m.Vc("button",t.attempts.length>0),m.mc("aria-label",m.Rc(1,12,"addon.mod_h5pactivity.review_user_attempts",m.ad(15,users_attempts_c0,t.attempts.length))),m.lc(6),m.Vc("user",t.user)("courseId",n.courseId),m.lc(1),m.rd(" ",t.user.fullname," "),m.lc(2),m.Vc("ngIf",t.attempts.length),m.lc(1),m.Vc("ngIf",!t.attempts.length),m.lc(2),m.Vc("ngIf",void 0!==t.score),m.lc(1),m.Vc("ngIf",void 0===t.score),m.lc(2),m.rd(" ",t.attempts.length," ")}}function AddonModH5PActivityUsersAttemptsPage_ion_list_13_Template(t,e){if(1&t&&(m.Ec(0,"ion-list"),m.Ec(1,"ion-item",10),m.Ec(2,"ion-label"),m.Ec(3,"ion-row",11),m.Ec(4,"ion-col",12),m.pd(5),m.Pc(6,"translate"),m.Dc(),m.Ec(7,"ion-col",12),m.pd(8),m.Pc(9,"translate"),m.Dc(),m.Ec(10,"ion-col",13),m.pd(11),m.Pc(12,"translate"),m.Dc(),m.Ec(13,"ion-col",13),m.pd(14),m.Pc(15,"translate"),m.Dc(),m.Dc(),m.Dc(),m.Dc(),m.nd(16,AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_Template,16,17,"ion-item",14),m.Dc()),2&t){const t=m.Oc();m.lc(5),m.qd(m.Qc(6,5,"core.user")),m.lc(3),m.qd(m.Qc(9,7,"core.date")),m.lc(3),m.qd(m.Qc(12,9,"addon.mod_h5pactivity.score")),m.lc(3),m.qd(m.Qc(15,11,"addon.mod_h5pactivity.attempts")),m.lc(2),m.Vc("ngForOf",t.users)}}function AddonModH5PActivityUsersAttemptsPage_core_empty_box_14_Template(t,e){1&t&&(m.zc(0,"core-empty-box",17),m.Pc(1,"translate")),2&t&&m.Vc("message",m.Qc(1,1,"addon.mod_h5pactivity.noparticipants"))}let k=(()=>{class AddonModH5PActivityUsersAttemptsPage{constructor(){this.loaded=!1,this.users=[],this.fetchMoreUsersFailed=!1,this.canLoadMore=!1,this.page=0,this.logView=b.a.once((()=>Object(d.a)(this,void 0,void 0,(function*(){this.h5pActivity&&(yield M.a.ignoreErrors(D.a.logViewReport(this.h5pActivity.id)),E.a.logEvent({type:E.b.VIEW_ITEM_LIST,ws:"mod_h5pactivity_log_report_viewed",name:this.h5pActivity.name,data:{id:this.h5pActivity.id,category:"h5pactivity"},url:`/mod/h5pactivity/report.php?a=${this.h5pActivity.id}`}))}))))}ngOnInit(){return Object(d.a)(this,void 0,void 0,(function*(){try{this.courseId=f.a.getRequiredRouteNumberParam("courseId"),this.cmId=f.a.getRequiredRouteNumberParam("cmId")}catch(t){return r.a.showErrorModal(t),f.a.back(),void 0}this.fetchData()}))}doRefresh(t){this.refreshData().finally((()=>{t.complete()}))}fetchData(t){return Object(d.a)(this,void 0,void 0,(function*(){try{this.h5pActivity=yield D.a.getH5PActivity(this.courseId,this.cmId),yield Promise.all([this.fetchUsers(t)]),this.logView()}catch(t){r.a.showErrorModalDefault(t,"Error loading attempts.")}finally{this.loaded=!0}}))}fetchUsers(t){return Object(d.a)(this,void 0,void 0,(function*(){if(!this.h5pActivity)return;t&&(this.page=0);const e=yield D.a.getUsersAttempts(this.h5pActivity.id,{cmId:this.cmId,page:this.page}),n=yield this.formatUsers(this.h5pActivity,e.users);this.users=0===this.page?n:this.users.concat(n),this.canLoadMore=e.canLoadMore,this.page++}))}formatUsers(t,e){return Object(d.a)(this,void 0,void 0,(function*(){return Promise.all(e.map((e=>Object(d.a)(this,void 0,void 0,(function*(){var n;if(e.user=yield y.a.getProfile(e.userid,this.courseId,!0),t.grademethod===D.b.GRADEMANUAL);else if(t.grademethod===D.b.GRADEAVERAGEATTEMPT){if(e.attempts.length){const t=e.attempts.reduce(((t,e)=>t+100*e.rawscore/e.maxscore),0);e.score=Math.round(t/e.attempts.length)}}else(null===(n=e.scored)||void 0===n?void 0:n.attempts[0])&&(e.score=Math.round(100*e.scored.attempts[0].rawscore/e.scored.attempts[0].maxscore));return e})))))}))}fetchMoreUsers(t){return Object(d.a)(this,void 0,void 0,(function*(){try{yield this.fetchUsers(!1)}catch(t){r.a.showErrorModalDefault(t,"Error loading more users"),this.fetchMoreUsersFailed=!0}t()}))}refreshData(){return Object(d.a)(this,void 0,void 0,(function*(){const t=[D.a.invalidateActivityData(this.courseId)];this.h5pActivity&&t.push(D.a.invalidateAllUsersAttempts(this.h5pActivity.id)),yield M.a.ignoreErrors(Promise.all(t)),yield this.fetchData(!0)}))}openUser(t){t.attempts.length&&f.a.navigate(`../userattempts/${t.userid}`)}}return AddonModH5PActivityUsersAttemptsPage.ɵfac=function AddonModH5PActivityUsersAttemptsPage_Factory(t){return new(t||AddonModH5PActivityUsersAttemptsPage)},AddonModH5PActivityUsersAttemptsPage.ɵcmp=m.sc({type:AddonModH5PActivityUsersAttemptsPage,selectors:[["page-addon-mod-h5pactivity-users-attempts"]],decls:16,vars:13,consts:[["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId",4,"ngIf"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[4,"ngIf"],["icon","fas-chart-bar",3,"message",4,"ngIf"],[3,"enabled","error","action"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["detail","true",1,"addon-mod_h5pactivity-table-header","hide-detail","font-bold"],[1,"ion-align-items-center"],["size","4",1,"ion-text-center"],["size","2",1,"ion-text-center"],["class","ion-text-wrap addon-mod_h5pactivity-table-row","detail","true",3,"hide-detail","button","click",4,"ngFor","ngForOf"],["detail","true",1,"ion-text-wrap","addon-mod_h5pactivity-table-row",3,"button","click"],[3,"user","courseId"],["icon","fas-chart-bar",3,"message"]],template:function AddonModH5PActivityUsersAttemptsPage_Template(t,e){1&t&&(m.Ec(0,"ion-header"),m.Ec(1,"ion-toolbar"),m.Ec(2,"ion-buttons",0),m.zc(3,"ion-back-button",1),m.Pc(4,"translate"),m.Dc(),m.Ec(5,"ion-title"),m.Ec(6,"h1"),m.nd(7,AddonModH5PActivityUsersAttemptsPage_core_format_text_7_Template,1,3,"core-format-text",2),m.Dc(),m.Dc(),m.Dc(),m.Dc(),m.Ec(8,"ion-content"),m.Ec(9,"ion-refresher",3),m.Mc("ionRefresh",(function AddonModH5PActivityUsersAttemptsPage_Template_ion_refresher_ionRefresh_9_listener(t){return e.doRefresh(t.target)})),m.zc(10,"ion-refresher-content",4),m.Pc(11,"translate"),m.Dc(),m.Ec(12,"core-loading",5),m.nd(13,AddonModH5PActivityUsersAttemptsPage_ion_list_13_Template,17,13,"ion-list",6),m.nd(14,AddonModH5PActivityUsersAttemptsPage_core_empty_box_14_Template,2,3,"core-empty-box",7),m.Ec(15,"core-infinite-loading",8),m.Mc("action",(function AddonModH5PActivityUsersAttemptsPage_Template_core_infinite_loading_action_15_listener(t){return e.fetchMoreUsers(t)})),m.Dc(),m.Dc(),m.Dc()),2&t&&(m.lc(3),m.Vc("text",m.Qc(4,9,"core.back")),m.lc(4),m.Vc("ngIf",e.h5pActivity),m.lc(2),m.Vc("disabled",!e.loaded),m.lc(1),m.Wc("pullingText",m.Qc(11,11,"core.pulltorefresh")),m.lc(2),m.Vc("hideUntil",e.loaded),m.lc(1),m.Vc("ngIf",e.users.length),m.lc(1),m.Vc("ngIf",!e.users.length&&!e.canLoadMore),m.lc(1),m.Vc("enabled",e.loaded&&e.canLoadMore)("error",e.fetchMoreUsersFailed))},directives:[p.C,p.Ab,p.m,p.h,p.i,p.yb,H.t,A.a,p.v,p.bb,p.cb,T.a,z.a,u.a,p.P,p.I,p.O,p.hb,p.u,H.s,O.a,R.a],pipes:[h.d,U.a],styles:["[_nghost-%COMP%]   .addon-mod_h5pactivity-table-header[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}"]}),AddonModH5PActivityUsersAttemptsPage})();const Q=[{path:":courseId/:cmId",component:P,canDeactivate:[o.a]},{path:":courseId/:cmId/userattempts/:userId",component:V},{path:":courseId/:cmId/attemptresults/:attemptId",component:C},{path:":courseId/:cmId/users",component:k}];let q=(()=>{class AddonModH5PActivityLazyModule{}return AddonModH5PActivityLazyModule.ɵmod=m.wc({type:AddonModH5PActivityLazyModule}),AddonModH5PActivityLazyModule.ɵinj=m.vc({factory:function AddonModH5PActivityLazyModule_Factory(t){return new(t||AddonModH5PActivityLazyModule)},imports:[[i.m.forChild(Q),c.a,a.a]]}),AddonModH5PActivityLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&m.kd(q,{declarations:[P,V,C,k],imports:[i.m,c.a,a.a]}))}}]);