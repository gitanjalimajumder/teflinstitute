(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{OzlW:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("L3Fv"),a=n("wxbA"),o=n("fXoL");let i=(()=>{class CoreGradesCoursePageModule{}return CoreGradesCoursePageModule.ɵmod=o.wc({type:CoreGradesCoursePageModule}),CoreGradesCoursePageModule.ɵinj=o.vc({factory:function CoreGradesCoursePageModule_Factory(e){return new(e||CoreGradesCoursePageModule)},imports:[[r.a]]}),CoreGradesCoursePageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&o.kd(i,{declarations:[a.a],imports:[r.a]}))},eoiU:function(e,t,n){"use strict";n.d(t,"a",(function(){return CoreSwipeNavigationItemsManager}));var r=n("mrSG"),a=n("pHTc"),o=n("CtbY");class CoreSwipeNavigationItemsManager extends o.a{start(){return Object(r.a)(this,void 0,void 0,(function*(){this.updateSelectedItem()}))}navigateToNextItem(){return Object(r.a)(this,void 0,void 0,(function*(){yield this.navigateToItemBy(1,"forward")}))}navigateToPreviousItem(){return Object(r.a)(this,void 0,void 0,(function*(){yield this.navigateToItemBy(-1,"back")}))}hasNextItem(){return Object(r.a)(this,void 0,void 0,(function*(){return!!(yield this.getItemBy(1))}))}hasPreviousItem(){return Object(r.a)(this,void 0,void 0,(function*(){return!!(yield this.getItemBy(-1))}))}getCurrentPageRoute(){return a.a.getCurrentRoute()}getSelectedItemPathFromRoute(e){const t=[];for(;e&&(t.push(...e.url),e.firstChild);)e=e.firstChild;return t.map((e=>e.path)).join("/").replace(/\/+/,"/").trim()||null}navigateToItemBy(e,t){return Object(r.a)(this,void 0,void 0,(function*(){const n=yield this.getItemBy(e);n&&(yield this.navigateToItem(n,{animationDirection:t,replace:!0}))}))}getItemBy(e){var t;return Object(r.a)(this,void 0,void 0,(function*(){const n=this.getSource().getItems(),r=null!==(t=this.selectedItem&&(null==n?void 0:n.indexOf(this.selectedItem)))&&void 0!==t?t:-1;if(-1===r||null===n)return null;const a=e>0?1:-1;let o=r,i=0;for(;i!==e;){if(o+=a,o<0)return null;if(o>=n.length)break;this.skipItemInSwipe(n[o])||(i+=a)}return i===e?n[o]:this.getSource().isCompleted()?null:(yield this.getSource().load(),this.getItemBy(e))}))}skipItemInSwipe(e){return!1}}},"q5/S":function(e,t,n){"use strict";n.d(t,"a",(function(){return CoreGradesCoursesSource}));var r=n("mrSG"),a=n("CvRw"),o=n("wo9T"),i=n("FvYb");class CoreGradesCoursesSource extends a.a{loadPageItems(){return Object(r.a)(this,void 0,void 0,(function*(){const e=yield o.a.getCoursesGrades();return{items:yield i.a.getGradesCourseData(e)}}))}getItemPath(e){return e.courseid.toString()}}},wxbA:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r=n("mrSG"),a=n("3LXp"),o=n("wo9T"),i=n("FvYb"),c=n("9+EE"),s=n("bFG1"),d=n("pHTc"),_=n("Y+03"),g=n("j3ag"),l=n("eoiU"),u=n("baaQ"),m=n("xtzZ"),p=n("q5/S"),C=n("6s78"),b=n("8vmT"),h=n("D7J2"),P=n("fXoL"),f=n("tyNb"),v=n("TEn/"),O=n("nt/U"),M=n("OZH1"),w=n("PgjG"),I=n("ofXK"),x=n("r8G5"),G=n("xpMl"),T=n("saTE"),y=n("3CSS"),k=n("eAud"),E=n("hMzs"),V=n("edOc"),D=n("sYmb");function CoreGradesCoursePage_core_empty_box_13_Template(e,t){1&e&&(P.zc(0,"core-empty-box",8),P.Pc(1,"translate")),2&e&&P.Vc("message",P.Qc(1,1,"core.grades.nogradesreturned"))}function CoreGradesCoursePage_div_14_th_4_Template(e,t){if(1&e&&(P.Ec(0,"th",14),P.pd(1),P.Pc(2,"translate"),P.Dc()),2&e){const e=t.$implicit;P.qc("ion-hide-md-down",e.hiddenPhone),P.Wc("id",e.name),P.mc("colspan",e.colspan),P.lc(1),P.rd(" ",P.Qc(2,5,"core.grades."+e.name)," ")}}function CoreGradesCoursePage_div_14_ng_container_6_tr_1_Template(e,t){if(1&e&&(P.Ec(0,"tr"),P.zc(1,"td",18),P.Dc()),2&e){const e=P.Oc().$implicit;P.lc(1),P.mc("rowspan",e.rowspan)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_td_1_Template(e,t){if(1&e&&P.zc(0,"td",27),2&e){const e=P.Oc(3).$implicit;P.mc("rowspan",e.rowspan)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ion_icon_3_Template(e,t){if(1&e&&P.zc(0,"ion-icon",28),2&e){const e=P.Oc(3).$implicit;P.qc("expandable-status-icon-expanded",e.expanded)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ion_icon_4_Template(e,t){if(1&e&&P.zc(0,"ion-icon",29),2&e){const e=P.Oc(3).$implicit;P.Wc("name",e.icon),P.mc("aria-label",e.iconAlt)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_img_5_Template(e,t){if(1&e&&P.zc(0,"img",30),2&e){const e=P.Oc(3).$implicit;P.Vc("src",e.image,P.id)("alt",e.iconAlt)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_core_mod_icon_6_Template(e,t){if(1&e&&P.zc(0,"core-mod-icon",31),2&e){const e=P.Oc(3).$implicit;P.Vc("modicon",e.image)("modname",e.itemmodule)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_1_Template(e,t){if(1&e&&P.zc(0,"td",26),2&e){const e=P.Oc().$implicit,t=P.Oc(4).$implicit;P.nc("ion-text-start core-grades-table-"+e.name),P.qc("ion-hide-md-down",e.hiddenPhone),P.Vc("innerHTML",t[e.name],P.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_2_Template(e,t){if(1&e&&(P.Ec(0,"td",35),P.zc(1,"core-format-text",36),P.Dc()),2&e){const e=P.Oc().$implicit,t=P.Oc(4).$implicit,n=P.Oc(2);P.qc("ion-hide-md-down",e.hiddenPhone),P.lc(1),P.Vc("text",t.feedback)("contextInstanceId",n.courseId)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_3_ion_icon_1_Template(e,t){if(1&e&&P.zc(0,"ion-icon",38),2&e){const e=P.Oc(6).$implicit;P.Vc("name",e.gradeIcon),P.mc("aria-label",e.gradeIconAlt)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_3_Template(e,t){if(1&e&&(P.Ec(0,"td"),P.nd(1,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_3_ion_icon_1_Template,1,2,"ion-icon",37),P.zc(2,"span",26),P.Dc()),2&e){const e=P.Oc().$implicit,t=P.Oc(4).$implicit;P.oc("ion-text-start core-grades-table-grade ",t.gradeClass,""),P.qc("ion-hide-md-down",e.hiddenPhone),P.lc(1),P.Vc("ngIf",t.gradeIcon),P.lc(1),P.Vc("innerHTML",t[e.name],P.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_Template(e,t){if(1&e&&(P.Cc(0),P.nd(1,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_1_Template,1,5,"td",32),P.nd(2,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_2_Template,2,4,"td",33),P.nd(3,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_3_Template,3,7,"td",34),P.Bc()),2&e){const e=t.$implicit,n=P.Oc(4).$implicit;P.lc(1),P.Vc("ngIf","gradeitem"!==e.name&&"feedback"!==e.name&&"grade"!==e.name&&void 0!==n[e.name]),P.lc(1),P.Vc("ngIf","feedback"===e.name&&void 0!==n.feedback),P.lc(1),P.Vc("ngIf","grade"===e.name)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_Template(e,t){if(1&e&&(P.Cc(0),P.nd(1,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_Template,4,3,"ng-container",12),P.Bc()),2&e){const e=P.Oc(5);P.lc(1),P.Vc("ngForOf",e.columns)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_Template(e,t){if(1&e&&(P.Cc(0),P.nd(1,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_td_1_Template,1,1,"td",20),P.Ec(2,"th",21),P.nd(3,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ion_icon_3_Template,1,2,"ion-icon",22),P.nd(4,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ion_icon_4_Template,1,2,"ion-icon",23),P.nd(5,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_img_5_Template,1,2,"img",24),P.nd(6,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_core_mod_icon_6_Template,1,2,"core-mod-icon",25),P.zc(7,"span",26),P.Dc(),P.nd(8,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_Template,2,1,"ng-container",15),P.Bc()),2&e){const e=P.Oc(2).$implicit,t=P.Oc(2);P.lc(1),P.Vc("ngIf","category"==e.itemtype),P.lc(1),P.mc("colspan",e.colspan),P.lc(1),P.Vc("ngIf",e.expandable&&t.showSummary),P.lc(1),P.Vc("ngIf",e.icon),P.lc(1),P.Vc("ngIf",e.image&&!e.itemmodule),P.lc(1),P.Vc("ngIf",e.image&&e.itemmodule),P.lc(1),P.Vc("innerHTML",e.gradeitem,P.gd),P.lc(1),P.Vc("ngIf","category"!==e.itemtype)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_Template(e,t){if(1&e){const e=P.Fc();P.Ec(0,"tr",19),P.Mc("ariaButtonClick",(function CoreGradesCoursePage_div_14_ng_container_6_tr_2_Template_tr_ariaButtonClick_0_listener(){P.fd(e);const t=P.Oc().$implicit,n=P.Oc(2);return t.expandable&&n.showSummary&&n.toggleRow(t)})),P.nd(1,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_Template,9,8,"ng-container",15),P.Dc()}if(2&e){const e=P.Oc().$implicit,t=P.Oc(2);P.nc(e.rowclass),P.qc("core-grades-grade-clickable",e.expandable&&t.showSummary),P.Vc("id","grade-"+e.id),P.mc("role",e.expandable&&t.showSummary?"button row":"row")("tabindex",e.expandable&&t.showSummary&&0)("aria-expanded",e.expanded)("aria-label",t.rowAriaLabel(e))("aria-controls",e.detailsid),P.lc(1),P.Vc("ngIf",e.itemtype)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_3_Template(e,t){if(1&e&&(P.Ec(0,"ion-item",41),P.Ec(1,"ion-label"),P.Ec(2,"p",42),P.pd(3),P.Pc(4,"translate"),P.Dc(),P.zc(5,"p",26),P.Dc(),P.Dc()),2&e){const e=P.Oc(2).$implicit;P.lc(3),P.qd(P.Qc(4,2,"core.grades.weight")),P.lc(2),P.Vc("innerHTML",e.weight,P.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_4_Template(e,t){if(1&e&&(P.Ec(0,"ion-item",41),P.Ec(1,"ion-label"),P.Ec(2,"p",42),P.pd(3),P.Pc(4,"translate"),P.Dc(),P.zc(5,"p",26),P.Dc(),P.Dc()),2&e){const e=P.Oc(2).$implicit;P.lc(3),P.qd(P.Qc(4,2,"core.grades.grade")),P.lc(2),P.Vc("innerHTML",e.grade,P.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_5_Template(e,t){if(1&e&&(P.Ec(0,"ion-item",41),P.Ec(1,"ion-label"),P.Ec(2,"p",42),P.pd(3),P.Pc(4,"translate"),P.Dc(),P.zc(5,"p",26),P.Dc(),P.Dc()),2&e){const e=P.Oc(2).$implicit;P.lc(3),P.qd(P.Qc(4,2,"core.grades.range")),P.lc(2),P.Vc("innerHTML",e.range,P.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_6_Template(e,t){if(1&e&&(P.Ec(0,"ion-item",41),P.Ec(1,"ion-label"),P.Ec(2,"p",42),P.pd(3),P.Pc(4,"translate"),P.Dc(),P.zc(5,"p",26),P.Dc(),P.Dc()),2&e){const e=P.Oc(2).$implicit;P.lc(3),P.qd(P.Qc(4,2,"core.grades.percentage")),P.lc(2),P.Vc("innerHTML",e.percentage,P.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_7_Template(e,t){if(1&e&&(P.Ec(0,"ion-item",41),P.Ec(1,"ion-label"),P.Ec(2,"p",42),P.pd(3),P.Pc(4,"translate"),P.Dc(),P.zc(5,"p",26),P.Dc(),P.Dc()),2&e){const e=P.Oc(2).$implicit;P.lc(3),P.qd(P.Qc(4,2,"core.grades.lettergrade")),P.lc(2),P.Vc("innerHTML",e.lettergrade,P.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_8_Template(e,t){if(1&e&&(P.Ec(0,"ion-item",41),P.Ec(1,"ion-label"),P.Ec(2,"p",42),P.pd(3),P.Pc(4,"translate"),P.Dc(),P.zc(5,"p",26),P.Dc(),P.Dc()),2&e){const e=P.Oc(2).$implicit;P.lc(3),P.qd(P.Qc(4,2,"core.grades.rank")),P.lc(2),P.Vc("innerHTML",e.rank,P.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_9_Template(e,t){if(1&e&&(P.Ec(0,"ion-item",41),P.Ec(1,"ion-label"),P.Ec(2,"p",42),P.pd(3),P.Pc(4,"translate"),P.Dc(),P.zc(5,"p",26),P.Dc(),P.Dc()),2&e){const e=P.Oc(2).$implicit;P.lc(3),P.qd(P.Qc(4,2,"core.grades.average")),P.lc(2),P.Vc("innerHTML",e.average,P.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_10_Template(e,t){if(1&e&&(P.Ec(0,"ion-item",41),P.Ec(1,"ion-label"),P.Ec(2,"p",42),P.pd(3),P.Pc(4,"translate"),P.Dc(),P.Ec(5,"p"),P.zc(6,"core-format-text",36),P.Dc(),P.Dc(),P.Dc()),2&e){const e=P.Oc(2).$implicit,t=P.Oc(2);P.lc(3),P.qd(P.Qc(4,3,"core.grades.feedback")),P.lc(3),P.Vc("text",e.feedback)("contextInstanceId",t.courseId)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_11_Template(e,t){if(1&e&&(P.Ec(0,"ion-item",41),P.Ec(1,"ion-label"),P.Ec(2,"p",42),P.pd(3),P.Pc(4,"translate"),P.Dc(),P.zc(5,"p",26),P.Dc(),P.Dc()),2&e){const e=P.Oc(2).$implicit;P.lc(3),P.qd(P.Qc(4,2,"core.grades.contributiontocoursetotal")),P.lc(2),P.Vc("innerHTML",e.contributiontocoursetotal,P.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_Template(e,t){if(1&e&&(P.Ec(0,"tr",39),P.Ec(1,"td"),P.Ec(2,"ion-list"),P.nd(3,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_3_Template,6,4,"ion-item",40),P.nd(4,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_4_Template,6,4,"ion-item",40),P.nd(5,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_5_Template,6,4,"ion-item",40),P.nd(6,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_6_Template,6,4,"ion-item",40),P.nd(7,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_7_Template,6,4,"ion-item",40),P.nd(8,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_8_Template,6,4,"ion-item",40),P.nd(9,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_9_Template,6,4,"ion-item",40),P.nd(10,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_10_Template,7,5,"ion-item",40),P.nd(11,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_11_Template,6,4,"ion-item",40),P.Dc(),P.Dc(),P.Dc()),2&e){const e=P.Oc().$implicit,t=P.Oc(2);P.nc(e.rowclass),P.Vc("id",e.detailsid),P.lc(1),P.mc("colspan",t.totalColumnsSpan),P.lc(2),P.Vc("ngIf",e.weight),P.lc(1),P.Vc("ngIf",e.grade),P.lc(1),P.Vc("ngIf",e.range),P.lc(1),P.Vc("ngIf",e.percentage),P.lc(1),P.Vc("ngIf",e.lettergrade),P.lc(1),P.Vc("ngIf",e.rank),P.lc(1),P.Vc("ngIf",e.average),P.lc(1),P.Vc("ngIf",e.feedback),P.lc(1),P.Vc("ngIf",e.contributiontocoursetotal)}}function CoreGradesCoursePage_div_14_ng_container_6_Template(e,t){if(1&e&&(P.Cc(0),P.nd(1,CoreGradesCoursePage_div_14_ng_container_6_tr_1_Template,2,1,"tr",15),P.nd(2,CoreGradesCoursePage_div_14_ng_container_6_tr_2_Template,2,11,"tr",16),P.nd(3,CoreGradesCoursePage_div_14_ng_container_6_tr_3_Template,12,13,"tr",17),P.Bc()),2&e){const e=t.$implicit;P.lc(1),P.Vc("ngIf","leader"===e.itemtype),P.lc(1),P.Vc("ngIf","leader"!==e.itemtype),P.lc(1),P.Vc("ngIf",e.expandable&&e.expanded)}}function CoreGradesCoursePage_div_14_Template(e,t){if(1&e){const e=P.Fc();P.Ec(0,"div",9),P.Ec(1,"table",10),P.Ec(2,"thead"),P.Ec(3,"tr"),P.nd(4,CoreGradesCoursePage_div_14_th_4_Template,3,7,"th",11),P.Dc(),P.Dc(),P.Ec(5,"tbody"),P.nd(6,CoreGradesCoursePage_div_14_ng_container_6_Template,4,3,"ng-container",12),P.Pc(7,"slice"),P.Dc(),P.Dc(),P.Ec(8,"core-infinite-loading",13),P.Mc("action",(function CoreGradesCoursePage_div_14_Template_core_infinite_loading_action_8_listener(t){P.fd(e);return P.Oc().loadMore(t)})),P.Dc(),P.Dc()}if(2&e){const e=P.Oc();P.lc(1),P.qc("summary",e.showSummary),P.lc(3),P.Vc("ngForOf",e.columns),P.lc(2),P.Vc("ngForOf",P.Sc(7,5,e.rows,0,e.rowsOnView)),P.lc(2),P.Vc("enabled",e.rowsOnView<e.rows.length)}}let S=(()=>{class CoreGradesCoursePage{constructor(e,t){var n;this.route=e,this.element=t,this.columns=[],this.rows=[],this.rowsOnView=0,this.loaded=!1,this.logView=b.a.once((()=>this.performLogView()));try{switch(this.courseId=d.a.getRequiredRouteNumberParam("courseId",{route:e}),this.userId=null!==(n=d.a.getRouteNumberParam("userId",{route:e}))&&void 0!==n?n:c.b.getCurrentSiteUserId(),this.gradeId=d.a.getRouteNumberParam("gradeId",{route:e}),this.expandLabel=g.I.instant("core.expand"),this.collapseLabel=g.I.instant("core.collapse"),this.useLegacyLayout=!c.b.getRequiredCurrentSite().isVersionGreaterEqualThan("4.1"),e.snapshot.data.swipeManagerSource){case"courses":this.swipeManager=new CoreGradesCourseCoursesSwipeManager(u.a.getOrCreateSource(p.a,[]));break;case"participants":{const e=d.a.getRouteParam("search");this.swipeManager=new CoreGradesCourseParticipantsSwipeManager(u.a.getOrCreateSource(m.a,[this.courseId,e]))}}}catch(e){return a.a.showErrorModal(e),d.a.back(),void 0}}get showSummary(){return _.a.isMobile||!!this.withinSplitView}ngAfterViewInit(){var e,t;return Object(r.a)(this,void 0,void 0,(function*(){this.withinSplitView=!!(null===(e=this.element.nativeElement.parentElement)||void 0===e?void 0:e.closest("core-split-view")),yield null===(t=this.swipeManager)||void 0===t?void 0:t.start(),yield this.fetchInitialGrades(),this.loaded=!0}))}ngOnDestroy(){var e;null===(e=this.swipeManager)||void 0===e?void 0:e.destroy()}rowAriaLabel(e){if(!e.expandable||!this.showSummary)return;return`${e.expanded?this.collapseLabel:this.expandLabel} ${e.ariaLabel}`}toggleRow(e,t){var n;if(!this.rows||!this.columns)return;e.expanded=null!=t?t:!e.expanded;let r=this.columns.length+(null!==(n=e.colspan)&&void 0!==n?n:0);this.useLegacyLayout&&r--;for(let t=this.rows.indexOf(e)-1;t>=0;t--){const n=this.rows[t];!n.rowspan||!n.colspan||n.colspan!==r||!this.useLegacyLayout&&"leader"!==n.itemtype||this.useLegacyLayout&&n.expandable||(r++,n.rowspan+=e.expanded?1:-1)}}refreshGrades(e){return Object(r.a)(this,void 0,void 0,(function*(){yield s.a.ignoreErrors(o.a.invalidateCourseGradesData(this.courseId,this.userId)),yield s.a.ignoreErrors(this.fetchGrades()),null==e||e.complete()}))}fetchInitialGrades(){return Object(r.a)(this,void 0,void 0,(function*(){try{if(yield this.fetchGrades(),this.gradeId&&this.rows){const e=this.rows.find((e=>e.id==this.gradeId));e&&(this.toggleRow(e,!0),C.a.scrollToElement(this.element.nativeElement,"#grade-"+e.id),this.gradeId=void 0)}}catch(e){a.a.showErrorModalDefault(e,"Error loading course"),this.columns=[],this.rows=[],this.rowsOnView=0}}))}fetchGrades(){var e,t,n,a;return Object(r.a)(this,void 0,void 0,(function*(){const r=yield o.a.getCourseGradesTable(this.courseId,this.userId),c=yield i.a.formatGradesTable(r);this.title=null!==(a=null!==(t=null===(e=this.swipeManager)||void 0===e?void 0:e.getPageTitle())&&void 0!==t?t:null===(n=c.rows[0])||void 0===n?void 0:n.gradeitem)&&void 0!==a?a:g.I.instant("core.grades.grades"),this.columns=c.columns,this.rows=c.rows,this.rowsOnView=this.getRowsOnHeight(),this.totalColumnsSpan=c.columns.reduce(((e,t)=>e+t.colspan),0),this.logView()}))}getRowsOnHeight(){return Math.floor(window.innerHeight/44)}loadMore(e){this.rowsOnView+=this.getRowsOnHeight(),e&&e()}performLogView(){var e;return Object(r.a)(this,void 0,void 0,(function*(){yield s.a.ignoreErrors(o.a.logCourseGradesView(this.courseId,this.userId)),h.a.logEvent({type:h.b.VIEW_ITEM,ws:"gradereport_user_view_grade_report",name:null!==(e=this.title)&&void 0!==e?e:"",data:{id:this.courseId,userid:this.userId,category:"grades"},url:`/grade/report/user/index.php?id=${this.courseId}`+(this.userId!==c.b.getCurrentSiteUserId()?`&userid=${this.userId}`:"")})}))}}return CoreGradesCoursePage.ɵfac=function CoreGradesCoursePage_Factory(e){return new(e||CoreGradesCoursePage)(P.yc(f.a),P.yc(P.r))},CoreGradesCoursePage.ɵcmp=P.sc({type:CoreGradesCoursePage,selectors:[["page-core-grades-course"]],decls:15,vars:12,consts:[["slot","start"],[3,"text"],[3,"core-swipe-navigation"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["icon","fas-chart-bar",3,"message",4,"ngIf"],["class","core-grades-container",4,"ngIf"],["icon","fas-chart-bar",3,"message"],[1,"core-grades-container"],[1,"core-grades-table"],["class","ion-text-start",3,"id","ion-hide-md-down",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"enabled","action"],[1,"ion-text-start",3,"id"],[4,"ngIf"],[3,"class","core-grades-grade-clickable","id","ariaButtonClick",4,"ngIf"],[3,"id","class",4,"ngIf"],[1,"core-grades-table-leader"],[3,"id","ariaButtonClick"],["class","core-grades-table-category",4,"ngIf"],[1,"core-grades-table-gradeitem","ion-text-start"],["aria-hidden","true","slot","start","name","fas-chevron-right","class","expandable-status-icon",3,"expandable-status-icon-expanded",4,"ngIf"],["slot","start",3,"name",4,"ngIf"],["slot","start","class","core-module-icon",3,"src","alt",4,"ngIf"],["slot","start",3,"modicon","modname",4,"ngIf"],[3,"innerHTML"],[1,"core-grades-table-category"],["aria-hidden","true","slot","start","name","fas-chevron-right",1,"expandable-status-icon"],["slot","start",3,"name"],["slot","start",1,"core-module-icon",3,"src","alt"],["slot","start",3,"modicon","modname"],[3,"class","ion-hide-md-down","innerHTML",4,"ngIf"],["class","ion-text-start core-grades-table-feedback",3,"ion-hide-md-down",4,"ngIf"],[3,"ion-hide-md-down","class",4,"ngIf"],[1,"ion-text-start","core-grades-table-feedback"],["collapsible-item","","contextLevel","course",3,"text","contextInstanceId"],[3,"name",4,"ngIf"],[3,"name"],[3,"id"],["class","ion-text-wrap",4,"ngIf"],[1,"ion-text-wrap"],[1,"item-heading"]],template:function CoreGradesCoursePage_Template(e,t){1&e&&(P.Ec(0,"ion-header"),P.Ec(1,"ion-toolbar"),P.Ec(2,"ion-buttons",0),P.zc(3,"ion-back-button",1),P.Pc(4,"translate"),P.Dc(),P.Ec(5,"ion-title"),P.Ec(6,"h1"),P.pd(7),P.Dc(),P.Dc(),P.Dc(),P.Dc(),P.Ec(8,"ion-content",2),P.Ec(9,"ion-refresher",3),P.Mc("ionRefresh",(function CoreGradesCoursePage_Template_ion_refresher_ionRefresh_9_listener(e){return t.refreshGrades(e.target)})),P.zc(10,"ion-refresher-content",4),P.Pc(11,"translate"),P.Dc(),P.Ec(12,"core-loading",5),P.nd(13,CoreGradesCoursePage_core_empty_box_13_Template,2,3,"core-empty-box",6),P.nd(14,CoreGradesCoursePage_div_14_Template,9,9,"div",7),P.Dc(),P.Dc()),2&e&&(P.lc(3),P.Vc("text",P.Qc(4,8,"core.back")),P.lc(4),P.qd(t.title),P.lc(1),P.Vc("core-swipe-navigation",t.swipeManager),P.lc(1),P.Vc("disabled",!t.columns||!t.rows),P.lc(1),P.Wc("pullingText",P.Qc(11,10,"core.pulltorefresh")),P.lc(2),P.Vc("hideUntil",t.loaded),P.lc(1),P.Vc("ngIf",!t.rows.length),P.lc(1),P.Vc("ngIf",t.rows.length))},directives:[v.C,v.Ab,v.m,v.h,v.i,v.yb,O.a,v.v,M.a,v.bb,v.cb,w.a,I.t,x.a,I.s,G.a,T.a,v.D,y.a,k.a,E.a,V.a,v.P,v.I,v.O],pipes:[D.d,I.E],styles:["[_nghost-%COMP%]{--header-background:var(--white);--odd-cell-background:var(--light);--odd-cell-hover:var(--gray-200);--even-cell-background:var(--white);--even-cell-hover:var(--light);--icon-color:var(--gray-500);--border-color:var(--stroke);--mod-icon-filter:brightness(0)}[_nghost-%COMP%]   .odd[_ngcontent-%COMP%]{--cell-background:var(--odd-cell-background);--cell-hover:var(--odd-cell-hover)}[_nghost-%COMP%]   .even[_ngcontent-%COMP%]{--cell-background:var(--even-cell-background);--cell-hover:var(--even-cell-hover)}html.dark[_nghost-%COMP%], html.dark   [_nghost-%COMP%]{--header-background:var(--gray-900);--odd-cell-background:var(--gray-800);--odd-cell-hover:var(--gray-600);--even-cell-background:var(--gray-900);--even-cell-hover:var(--gray-700);--icon-color:var(--gray-200);--mod-icon-filter:brightness(0) invert(1)}.core-grades-table[_ngcontent-%COMP%]{border-collapse:collapse;line-height:20px;width:100%;font-size:16px;color:var(--ion-text-color)}.core-grades-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--border-color)}.core-grades-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding-right:8px;padding-top:8px;padding-bottom:8px;vertical-align:top;white-space:normal;text-align:start}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.core-grades-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding-right:unset;-webkit-padding-end:8px;padding-inline-end:8px}}.core-grades-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{vertical-align:bottom;font-weight:700;background-color:var(--header-background)}.core-grades-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   #gradeitem[_ngcontent-%COMP%]{padding-left:24px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.core-grades-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   #gradeitem[_ngcontent-%COMP%]{padding-left:unset;-webkit-padding-start:24px;padding-inline-start:24px}}.core-grades-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:400}.core-grades-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.core-bold[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:inherit}.core-grades-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   #gradeitem[_ngcontent-%COMP%]{padding-left:4px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.core-grades-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   #gradeitem[_ngcontent-%COMP%]{padding-left:unset;-webkit-padding-start:4px;padding-inline-start:4px}}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]{padding-left:4px;font-weight:700}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]{padding-left:unset;-webkit-padding-start:4px;padding-inline-start:4px}}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem.column-itemname[_ngcontent-%COMP%]{padding-left:0}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem.column-itemname[_ngcontent-%COMP%]{padding-left:unset;-webkit-padding-start:0;padding-inline-start:0}}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:16px;height:16px}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   core-mod-icon[_ngcontent-%COMP%]{padding:0;--size:16px;background:transparent;--filter:var(--mod-icon-filter)}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--icon-color)}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:4px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:unset;-webkit-margin-start:4px;margin-inline-start:4px}}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   .expandable-status-icon[_ngcontent-%COMP%]{font-size:var(--text-size);margin-left:0;margin-right:2px;transition:transform .2s ease-in-out}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   .expandable-status-icon[_ngcontent-%COMP%]{margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:2px;margin-inline-end:2px}}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   .expandable-status-icon.expandable-status-icon-expanded[_ngcontent-%COMP%]{transform:var(--rotate-expandable)}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-feedback[_ngcontent-%COMP%]{padding-left:4px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-feedback[_ngcontent-%COMP%]{padding-left:unset;-webkit-padding-start:4px;padding-inline-start:4px}}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-feedback[_ngcontent-%COMP%]   .no-overflow[_ngcontent-%COMP%]{overflow:auto}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-grade[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{padding-right:4px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-grade[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{padding-right:unset;-webkit-padding-end:4px;padding-inline-end:4px}}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-leader[_ngcontent-%COMP%]{width:0}.core-grades-table[_ngcontent-%COMP%]   .ion-no-border[_ngcontent-%COMP%]{border:0!important}.core-grades-table[_ngcontent-%COMP%]   .dimmed_text[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .hidden[_ngcontent-%COMP%]{opacity:.7}.core-grades-table[_ngcontent-%COMP%]   .even[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .even[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .even[_ngcontent-%COMP%]   th[aria-current=page][_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .odd[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .odd[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .odd[_ngcontent-%COMP%]   th[aria-current=page][_ngcontent-%COMP%]{background-color:var(--cell-background)}.core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]{cursor:pointer}.core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]:hover   th[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]:hover   th[aria-current=page][_ngcontent-%COMP%]{background-color:var(--cell-hover)}.core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{height:var(--a11y-min-target-size);vertical-align:middle}.core-grades-table[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]::part(native), .core-grades-table[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{background-color:initial}.core-grades-table.summary[_ngcontent-%COMP%]   .ion-hide-md-down[_ngcontent-%COMP%]{display:none;opacity:0}@media (max-width:767.98px){.core-grades-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.85em}}"]}),CoreGradesCoursePage})();class CoreGradesCourseCoursesSwipeManager extends l.a{constructor(e){super(e)}getPageTitle(){const e=this.getSelectedItem();return null==e?void 0:e.courseFullName}}class CoreGradesCourseParticipantsSwipeManager extends l.a{constructor(e){super(e)}getPageTitle(){const e=this.getSelectedItem();return null==e?void 0:e.fullname}getSelectedItemPathFromRoute(e){return e.params.userId}}}}]);