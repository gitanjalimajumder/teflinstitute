(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{"//gF":function(e,t,n){e.exports=n.p+"0.9649772a367c485d24f4.worker.js"},FRva:function(e,t,n){"use strict";function initAudioEncoderMessage(e){return{name:"init-audio-encoder",config:e}}n.d(t,"a",(function(){return initAudioEncoderMessage}))},R8V1:function(e,t,n){"use strict";function assertType(e,t,...n){if(!e)throw new TypeError(format(t,n))}function format(e,t){let n=0;return e.replace(/%[os]/gu,(()=>anyToString(t[n++])))}function anyToString(e){return"object"!=typeof e||null===e?String(e):Object.prototype.toString.call(e)}let o;n.d(t,"a",(function(){return T}));const r="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:void 0;class Warning{constructor(e,t){this.code=e,this.message=t}warn(...e){var t;try{undefined;const n=(null!==(t=(new Error).stack)&&void 0!==t?t:"").replace(/^(?:.+?\n){2}/gu,"\n");console.warn(this.message,...e,n)}catch(e){}}}const i=new Warning("W01","Unable to initialize event under dispatching."),a=new Warning("W02","Assigning any falsy value to 'cancelBubble' property has no effect."),c=new Warning("W03","Assigning any truthy value to 'returnValue' property has no effect."),s=new Warning("W04","Unable to preventDefault on non-cancelable events."),l=new Warning("W05","Unable to preventDefault inside passive event listener invocation."),d=new Warning("W06","An event listener wasn't added because it has been added already: %o, %o"),u=new Warning("W07","The %o option value was abandoned because the event listener wasn't added as duplicated."),p=new Warning("W08","The 'callback' argument must be a function or an object that has 'handleEvent' method: %o"),g=new Warning("W09","Event attribute handler must be a function: %o");class Event$1{static get NONE(){return h}static get CAPTURING_PHASE(){return v}static get AT_TARGET(){return _}static get BUBBLING_PHASE(){return f}constructor(e,t){Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});const n=null!=t?t:{};m.set(this,{type:String(e),bubbles:Boolean(n.bubbles),cancelable:Boolean(n.cancelable),composed:Boolean(n.composed),target:null,currentTarget:null,stopPropagationFlag:!1,stopImmediatePropagationFlag:!1,canceledFlag:!1,inPassiveListenerFlag:!1,dispatchFlag:!1,timeStamp:Date.now()})}get type(){return $(this).type}get target(){return $(this).target}get srcElement(){return $(this).target}get currentTarget(){return $(this).currentTarget}composedPath(){const e=$(this).currentTarget;return e?[e]:[]}get NONE(){return h}get CAPTURING_PHASE(){return v}get AT_TARGET(){return _}get BUBBLING_PHASE(){return f}get eventPhase(){return $(this).dispatchFlag?2:0}stopPropagation(){$(this).stopPropagationFlag=!0}get cancelBubble(){return $(this).stopPropagationFlag}set cancelBubble(e){e?$(this).stopPropagationFlag=!0:a.warn()}stopImmediatePropagation(){const e=$(this);e.stopPropagationFlag=e.stopImmediatePropagationFlag=!0}get bubbles(){return $(this).bubbles}get cancelable(){return $(this).cancelable}get returnValue(){return!$(this).canceledFlag}set returnValue(e){e?c.warn():setCancelFlag($(this))}preventDefault(){setCancelFlag($(this))}get defaultPrevented(){return $(this).canceledFlag}get composed(){return $(this).composed}get isTrusted(){return!1}get timeStamp(){return $(this).timeStamp}initEvent(e,t=!1,n=!1){const o=$(this);if(o.dispatchFlag)return i.warn(),void 0;m.set(this,Object.assign({},o,{type:String(e),bubbles:Boolean(t),cancelable:Boolean(n),target:null,currentTarget:null,stopPropagationFlag:!1,stopImmediatePropagationFlag:!1,canceledFlag:!1}))}}const h=0,v=1,_=2,f=3,m=new WeakMap;function $(e,t="this"){const n=m.get(e);return assertType(null!=n,"'%s' must be an object that Event constructor created, but got another one: %o",t,e),n}function setCancelFlag(e){return e.inPassiveListenerFlag?(l.warn(),void 0):e.cancelable?(e.canceledFlag=!0,void 0):(s.warn(),void 0)}Object.defineProperty(Event$1,"NONE",{enumerable:!0}),Object.defineProperty(Event$1,"CAPTURING_PHASE",{enumerable:!0}),Object.defineProperty(Event$1,"AT_TARGET",{enumerable:!0}),Object.defineProperty(Event$1,"BUBBLING_PHASE",{enumerable:!0});const b=Object.getOwnPropertyNames(Event$1.prototype);for(let e=0;e<b.length;++e)"constructor"!==b[e]&&Object.defineProperty(Event$1.prototype,b[e],{enumerable:!0});let C;void 0!==r&&void 0!==r.Event&&Object.setPrototypeOf(Event$1.prototype,r.Event.prototype);const E={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};function defineErrorCodeProperties(e){const t=Object.keys(E);for(let n=0;n<t.length;++n){const o=t[n],r=E[o];Object.defineProperty(e,o,{get:()=>r,configurable:!0,enumerable:!0})}}class EventWrapper extends Event$1{static wrap(e){return new(getWrapperClassOf(e))(e)}constructor(e){super(e.type,{bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed}),e.cancelBubble&&super.stopPropagation(),e.defaultPrevented&&super.preventDefault(),R.set(this,{original:e});const t=Object.keys(e);for(let n=0;n<t.length;++n){const o=t[n];o in this||Object.defineProperty(this,o,defineRedirectDescriptor(e,o))}}stopPropagation(){super.stopPropagation();const{original:e}=$$1(this);"stopPropagation"in e&&e.stopPropagation()}get cancelBubble(){return super.cancelBubble}set cancelBubble(e){super.cancelBubble=e;const{original:t}=$$1(this);"cancelBubble"in t&&(t.cancelBubble=e)}stopImmediatePropagation(){super.stopImmediatePropagation();const{original:e}=$$1(this);"stopImmediatePropagation"in e&&e.stopImmediatePropagation()}get returnValue(){return super.returnValue}set returnValue(e){super.returnValue=e;const{original:t}=$$1(this);"returnValue"in t&&(t.returnValue=e)}preventDefault(){super.preventDefault();const{original:e}=$$1(this);"preventDefault"in e&&e.preventDefault()}get timeStamp(){const{original:e}=$$1(this);return"timeStamp"in e?e.timeStamp:super.timeStamp}}const R=new WeakMap;function $$1(e){const t=R.get(e);return assertType(null!=t,"'this' is expected an Event object, but got",e),t}const O=new WeakMap;function getWrapperClassOf(e){const t=Object.getPrototypeOf(e);if(null==t)return EventWrapper;let n=O.get(t);return null==n&&(n=function defineWrapper(e,t){class CustomEventWrapper extends e{}const n=Object.keys(t);for(let e=0;e<n.length;++e)Object.defineProperty(CustomEventWrapper.prototype,n[e],defineRedirectDescriptor(t,n[e]));return CustomEventWrapper}(getWrapperClassOf(t),t),O.set(t,n)),n}function defineRedirectDescriptor(e,t){const n=Object.getOwnPropertyDescriptor(e,t);return{get(){const e=$$1(this).original,n=e[t];return"function"==typeof n?n.bind(e):n},set(e){$$1(this).original[t]=e},configurable:n.configurable,enumerable:n.enumerable}}function isCapture(e){return 1==(1&e.flags)}function isPassive(e){return 2==(2&e.flags)}function isOnce(e){return 4==(4&e.flags)}function isRemoved(e){return 8==(8&e.flags)}function invokeCallback({callback:e},t,n){try{"function"==typeof e?e.call(t,n):"function"==typeof e.handleEvent&&e.handleEvent(n)}catch(e){!function reportError(e){try{const t=e instanceof Error?e:new Error(anyToString(e));if(o,"function"==typeof dispatchEvent&&"function"==typeof ErrorEvent)dispatchEvent(new ErrorEvent("error",{error:t,message:t.message}));else if("undefined"!=typeof process&&"function"==typeof process.emit)return process.emit("uncaughtException",t),void 0;console.error(t)}catch(e){}}(e)}}function findIndexOfListener({listeners:e},t,n){for(let o=0;o<e.length;++o)if(e[o].callback===t&&isCapture(e[o])===n)return o;return-1}function addListener(e,t,n,o,r,i){let a;i&&(a=removeListener.bind(null,e,t,n),i.addEventListener("abort",a));const c=function createListener(e,t,n,o,r,i){return{callback:e,flags:(t?1:0)|(n?2:0)|(o?4:0),signal:r,signalListener:i}}(t,n,o,r,i,a);return e.cow?(e.cow=!1,e.listeners=[...e.listeners,c]):e.listeners.push(c),c}function removeListener(e,t,n){const o=findIndexOfListener(e,t,n);return-1!==o&&removeListenerAt(e,o)}function removeListenerAt(e,t,n=!1){const o=e.listeners[t];return!function setRemoved(e){e.flags|=8}(o),o.signal&&o.signal.removeEventListener("abort",o.signalListener),e.cow&&!n?(e.cow=!1,e.listeners=e.listeners.filter(((e,n)=>n!==t)),!1):(e.listeners.splice(t,1),!0)}function ensureListenerList(e,t){var n;return null!==(n=e[t])&&void 0!==n?n:e[t]={attrCallback:void 0,attrListener:void 0,cow:!1,listeners:[]}}O.set(Object.prototype,EventWrapper),void 0!==r&&void 0!==r.Event&&O.set(r.Event.prototype,EventWrapper);class EventTarget{constructor(){A.set(this,function createListenerListMap(){return Object.create(null)}())}addEventListener(e,t,n){const o=$$2(this),{callback:r,capture:i,once:a,passive:c,signal:s,type:l}=function normalizeAddOptions(e,t,n){var o;if(assertCallback(t),"object"==typeof n&&null!==n)return{type:String(e),callback:null!=t?t:void 0,capture:Boolean(n.capture),passive:Boolean(n.passive),once:Boolean(n.once),signal:null!==(o=n.signal)&&void 0!==o?o:void 0};return{type:String(e),callback:null!=t?t:void 0,capture:Boolean(n),passive:!1,once:!1,signal:void 0}}(e,t,n);if(null==r||(null==s?void 0:s.aborted))return;const p=ensureListenerList(o,l),g=findIndexOfListener(p,r,i);if(-1!==g)return!function warnDuplicate(e,t,n,o){d.warn(isCapture(e)?"capture":"bubble",e.callback),isPassive(e)!==t&&u.warn("passive");isOnce(e)!==n&&u.warn("once");e.signal!==o&&u.warn("signal")}(p.listeners[g],c,a,s),void 0;addListener(p,r,i,c,a,s)}removeEventListener(e,t,n){const o=$$2(this),{callback:r,capture:i,type:a}=function normalizeOptions(e,t,n){if(assertCallback(t),"object"==typeof n&&null!==n)return{type:String(e),callback:null!=t?t:void 0,capture:Boolean(n.capture)};return{type:String(e),callback:null!=t?t:void 0,capture:Boolean(n)}}(e,t,n),c=o[a];null!=r&&c&&removeListener(c,r,i)}dispatchEvent(e){const t=$$2(this)[String(e.type)];if(null==t)return!0;const n=e instanceof Event$1?e:EventWrapper.wrap(e),o=$(n,"event");if(o.dispatchFlag)throw function createInvalidStateError(e){return r.DOMException?new r.DOMException(e,"InvalidStateError"):(null==C&&(C=class DOMException extends Error{constructor(e){super(e),Error.captureStackTrace&&Error.captureStackTrace(this,DOMException)}get code(){return 11}get name(){return"InvalidStateError"}},Object.defineProperties(C.prototype,{code:{enumerable:!0},name:{enumerable:!0}}),defineErrorCodeProperties(C),defineErrorCodeProperties(C.prototype)),new C(e))}("This event has been in dispatching.");if(o.dispatchFlag=!0,o.target=o.currentTarget=this,!o.stopPropagationFlag){const{cow:e,listeners:r}=t;t.cow=!0;for(let i=0;i<r.length;++i){const a=r[i];if(!isRemoved(a)&&(isOnce(a)&&removeListenerAt(t,i,!e)&&(i-=1),o.inPassiveListenerFlag=isPassive(a),invokeCallback(a,this,n),o.inPassiveListenerFlag=!1,o.stopImmediatePropagationFlag))break}e||(t.cow=!1)}return o.target=null,o.currentTarget=null,o.stopImmediatePropagationFlag=!1,o.stopPropagationFlag=!1,o.dispatchFlag=!1,!o.canceledFlag}}const A=new WeakMap;function $$2(e,t="this"){const n=A.get(e);return assertType(null!=n,"'%s' must be an object that EventTarget constructor created, but got another one: %o",t,e),n}function assertCallback(e){if("function"!=typeof e&&("object"!=typeof e||null===e||"function"!=typeof e.handleEvent)){if(null==e||"object"==typeof e)return p.warn(e),void 0;throw new TypeError(format(p.message,[e]))}}const w=Object.getOwnPropertyNames(EventTarget.prototype);for(let e=0;e<w.length;++e)"constructor"!==w[e]&&Object.defineProperty(EventTarget.prototype,w[e],{enumerable:!0});function setEventAttributeValue(e,t,n){null!=n&&"function"!=typeof n&&g.warn(n),"function"==typeof n||"object"==typeof n&&null!==n?function upsertEventAttributeListener(e,t,n){const o=ensureListenerList($$2(e,"target"),String(t));o.attrCallback=n,null==o.attrListener&&(o.attrListener=addListener(o,function defineEventAttributeCallback(e){return function(t){const n=e.attrCallback;"function"==typeof n&&n.call(this,t)}}(o),!1,!1,!1,void 0))}(e,t,n):function removeEventAttributeListener(e,t){const n=$$2(e,"target"),o=n[String(t)];o&&o.attrListener&&(removeListener(o,o.attrListener.callback,!1),o.attrCallback=o.attrListener=void 0)}(e,t)}function defineEventAttribute(e,t,n){Object.defineProperty(e,`on${t}`,{get(){return function getEventAttributeValue(e,t){var n,o;return null!==(o=null===(n=$$2(e,"target")[t])||void 0===n?void 0:n.attrCallback)&&void 0!==o?o:null}(this,t)},set(e){setEventAttributeValue(this,t,e)},configurable:!0,enumerable:!0})}void 0!==r&&void 0!==r.EventTarget&&Object.setPrototypeOf(EventTarget.prototype,r.EventTarget.prototype);var y=function(e){return e.DATA_AVAILABLE="DATA_AVAILABLE",e.START_RECORDING="START_RECORDING",e.STOP_RECORDING="STOP_RECORDING",e.ERROR="ERROR",e.BLOB_READY="BLOB_READY",e.WORKER_RECORDING="WORKER_RECORDING",e}({});const P="audio/mpeg",M=window.AudioContext||window.webkitAudioContext;let T=(()=>{class Mp3MediaRecorder extends EventTarget{constructor(e,{audioContext:t,worker:n}){if(super(),this.mimeType=P,this.state="inactive",this.audioBitsPerSecond=0,this.videoBitsPerSecond=0,this.isInternalAudioContext=!1,this.onWorkerMessage=e=>{const t=e.data;switch(t.type){case y.WORKER_RECORDING:{const e=new Event("start");this.dispatchEvent(e),this.state="recording";break}case y.ERROR:{const e=new Error(t.error),n=new Event("error");n.error=e,this.dispatchEvent(n),this.state="inactive";break}case y.BLOB_READY:{const e=new Event("stop"),n=new Event("dataavailable");n.data=t.blob,n.timecode=Date.now();const o=window.BlobEvent?new BlobEvent("dataavailable",{data:t.blob,timecode:Date.now()}):n;this.dispatchEvent(o),this.dispatchEvent(e),this.state="inactive";break}case y.ERROR:throw new Error(t.error)}},!n)throw new Error("No worker provided in Mp3MediaRecorder constructor.");var o;this.stream=e,this.isInternalAudioContext=!t,this.audioContext=t||new M,this.worker=n,this.sourceNode=this.audioContext.createMediaStreamSource(e),this.gainNode=((o=this.audioContext).createGain||o.createGainNode).call(o),this.gainNode.gain.value=1,this.processorNode=(e=>(e.createScriptProcessor||e.createJavaScriptNode).call(e,4096,1,1))(this.audioContext),this.sourceNode.connect(this.gainNode),this.gainNode.connect(this.processorNode),this.worker.onmessage=this.onWorkerMessage}start(){if("inactive"!==this.state)throw this.getStateError("start");this.processorNode.onaudioprocess=e=>{var t;this.worker.postMessage((t=e.inputBuffer.getChannelData(0),{type:y.DATA_AVAILABLE,data:t}))},this.processorNode.connect(this.audioContext.destination),"closed"===this.audioContext.state?this.audioContext=new AudioContext:"suspended"===this.audioContext.state&&this.audioContext.resume(),this.worker.postMessage({type:y.START_RECORDING,config:{sampleRate:this.audioContext.sampleRate}})}stop(){if("inactive"===this.state)throw this.getStateError("stop");this.processorNode.disconnect(),this.isInternalAudioContext&&this.audioContext.close(),this.worker.postMessage({type:y.STOP_RECORDING})}pause(){if("inactive"===this.state)throw this.getStateError("pause");this.audioContext.suspend().then((()=>{this.state="paused",this.dispatchEvent(new Event("pause"))}))}resume(){if("inactive"===this.state)throw this.getStateError("resume");this.audioContext.resume().then((()=>{this.state="recording",this.dispatchEvent(new Event("resume"))}))}requestData(){}getStateError(e){return new Error(`Failed to execute '${e}' on 'MediaRecorder': The MediaRecorder's state is '${this.state}'.`)}}return Mp3MediaRecorder.isTypeSupported=e=>e===P,Mp3MediaRecorder})();defineEventAttribute(T.prototype,"start"),defineEventAttribute(T.prototype,"stop"),defineEventAttribute(T.prototype,"pause"),defineEventAttribute(T.prototype,"resume"),defineEventAttribute(T.prototype,"dataavailable"),defineEventAttribute(T.prototype,"error")},ag35:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n("fXoL");const r=["canvas"];let i=(()=>{class CoreFileUploaderAudioHistogramComponent{constructor({nativeElement:e}){this.destroyed=!1,this.element=e}ngAfterViewInit(){var e,t;this.canvas=null===(e=this.canvasRef)||void 0===e?void 0:e.nativeElement,this.context=null===(t=this.canvas)||void 0===t?void 0:t.getContext("2d"),this.buffer=new Uint8Array(this.analyser.fftSize),this.updateCanvas(this.element.clientWidth,this.element.clientHeight),this.draw()}ngOnDestroy(){this.destroyed=!0}draw(){if(this.destroyed||!this.canvas||!this.context||!this.buffer)return;this.canvas.width===this.element.clientWidth&&this.canvas.height===this.element.clientHeight||this.updateCanvas(this.element.clientWidth,this.element.clientHeight);const e=this.canvas.width,t=this.canvas.height,n=CoreFileUploaderAudioHistogramComponent.BARS_WIDTH,o=CoreFileUploaderAudioHistogramComponent.BARS_GUTTER,r=Math.floor(this.buffer.length/((e-n-1)/(n+o))),i=Math.floor(this.buffer.length/r);this.context.fillRect(0,0,e,t);const a=Math.floor((e-(n+o)*i-n-1)/2);this.context.beginPath(),this.paused?this.drawPausedBars(a):this.drawActiveBars(a),this.context.stroke(),requestAnimationFrame((()=>this.draw()))}drawActiveBars(e){if(!this.canvas||!this.context||!this.buffer)return;let t=0;const n=this.canvas.height/2,o=CoreFileUploaderAudioHistogramComponent.BARS_MIN_HEIGHT/2,r=CoreFileUploaderAudioHistogramComponent.BARS_WIDTH,i=CoreFileUploaderAudioHistogramComponent.BARS_GUTTER,a=this.buffer.length,c=Math.floor(a/((this.canvas.width-r-1)/(r+i)));for(this.analyser.getByteTimeDomainData(this.buffer);t<a;){let s=o;do{s=Math.max(s,n*(1-this.buffer[t]/128)),t++}while(t%c!=0&&t<a);this.context.moveTo(e,n-s),this.context.lineTo(e,n+s),e+=r+i}}drawPausedBars(e){if(!this.canvas||!this.context)return;const t=this.canvas.width,n=this.canvas.height/2,o=CoreFileUploaderAudioHistogramComponent.BARS_MIN_HEIGHT/2,r=CoreFileUploaderAudioHistogramComponent.BARS_WIDTH+CoreFileUploaderAudioHistogramComponent.BARS_GUTTER;for(;e<t;)this.context.moveTo(e,n-o),this.context.lineTo(e,n+o),e+=r}updateCanvas(e,t){if(!this.canvas||!this.context)return;const n=getComputedStyle(this.element);this.canvas.width=e,this.canvas.height=t,this.context.fillStyle=n.getPropertyValue("--background-color"),this.context.lineCap="round",this.context.lineWidth=CoreFileUploaderAudioHistogramComponent.BARS_WIDTH,this.context.strokeStyle=n.getPropertyValue("--bars-color")}}return CoreFileUploaderAudioHistogramComponent.BARS_WIDTH=2,CoreFileUploaderAudioHistogramComponent.BARS_MIN_HEIGHT=4,CoreFileUploaderAudioHistogramComponent.BARS_GUTTER=4,CoreFileUploaderAudioHistogramComponent.ɵfac=function CoreFileUploaderAudioHistogramComponent_Factory(e){return new(e||CoreFileUploaderAudioHistogramComponent)(o.yc(o.r))},CoreFileUploaderAudioHistogramComponent.ɵcmp=o.sc({type:CoreFileUploaderAudioHistogramComponent,selectors:[["core-audio-histogram"]],viewQuery:function CoreFileUploaderAudioHistogramComponent_Query(e,t){var n;(1&e&&o.ud(r,!0),2&e)&&(o.dd(n=o.Nc())&&(t.canvasRef=n.first))},inputs:{analyser:"analyser",paused:"paused"},decls:2,vars:0,consts:[["canvas",""]],template:function CoreFileUploaderAudioHistogramComponent_Template(e,t){1&e&&o.zc(0,"canvas",null,0)},styles:["[_nghost-%COMP%]{--background-color:var(--ion-background-color,#fff);--bars-color:var(--ion-text-color,#000);position:relative}[_nghost-%COMP%]   canvas[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}"],changeDetection:0}),CoreFileUploaderAudioHistogramComponent})()},jLgY:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return P}));var o=n("mrSG"),r=n("mEL8"),i=n("r2Z7"),a=n("j3ag"),c=n("2Vo4"),s=n("itXk"),l=n("HDdC"),d=n("R8V1"),u=n("UXun"),p=n("vkgz"),g=n("lJxs"),h=n("FRva"),v=n("3LXp"),_=n("Soor"),f=n("EmGO"),m=n("qgEA"),b=n("fXoL"),C=n("ACYt"),E=n("TEn/"),R=n("3CSS"),O=n("ofXK"),A=n("4qNr"),w=n("ag35"),y=n("sYmb");function CoreFileUploaderAudioRecorderComponent_ng_container_8_div_1_Template(e,t){if(1&e){const e=b.Fc();b.Ec(0,"div",4),b.Ec(1,"p"),b.pd(2),b.Pc(3,"translate"),b.Dc(),b.Ec(4,"ion-button",5),b.Mc("click",(function CoreFileUploaderAudioRecorderComponent_ng_container_8_div_1_Template_ion_button_click_4_listener(){b.fd(e);return b.Oc(2).startRecording()})),b.Pc(5,"translate"),b.zc(6,"ion-icon",6),b.Dc(),b.Dc()}2&e&&(b.lc(2),b.qd(b.Qc(3,2,"core.fileuploader.startrecordinginstructions")),b.lc(2),b.mc("aria-label",b.Qc(5,4,"core.fileuploader.startrecording")))}function CoreFileUploaderAudioRecorderComponent_ng_container_8_div_2_core_audio_histogram_1_Template(e,t){if(1&e&&b.zc(0,"core-audio-histogram",16),2&e){const e=t.ngIf,n=b.Oc(2).ngIf;b.Vc("analyser",e)("paused","recording-ongoing"!==n)}}function CoreFileUploaderAudioRecorderComponent_ng_container_8_div_2_div_5_Template(e,t){1&e&&b.zc(0,"div",17)}function CoreFileUploaderAudioRecorderComponent_ng_container_8_div_2_ion_button_8_Template(e,t){if(1&e){const e=b.Fc();b.Ec(0,"ion-button",0),b.Mc("click",(function CoreFileUploaderAudioRecorderComponent_ng_container_8_div_2_ion_button_8_Template_ion_button_click_0_listener(){b.fd(e);return b.Oc(3).pauseRecording()})),b.Pc(1,"translate"),b.zc(2,"ion-icon",18),b.Dc()}2&e&&b.mc("aria-label",b.Qc(1,1,"core.fileuploader.pauserecording"))}function CoreFileUploaderAudioRecorderComponent_ng_container_8_div_2_ion_button_9_Template(e,t){if(1&e){const e=b.Fc();b.Ec(0,"ion-button",19),b.Mc("click",(function CoreFileUploaderAudioRecorderComponent_ng_container_8_div_2_ion_button_9_Template_ion_button_click_0_listener(){b.fd(e);return b.Oc(3).resumeRecording()})),b.Pc(1,"translate"),b.zc(2,"ion-icon",6),b.Dc()}2&e&&b.mc("aria-label",b.Qc(1,1,"core.fileuploader.resumerecording"))}function CoreFileUploaderAudioRecorderComponent_ng_container_8_div_2_Template(e,t){if(1&e){const e=b.Fc();b.Ec(0,"div",4),b.nd(1,CoreFileUploaderAudioRecorderComponent_ng_container_8_div_2_core_audio_histogram_1_Template,1,2,"core-audio-histogram",7),b.Pc(2,"async"),b.Ec(3,"div",8),b.Ec(4,"div",9),b.nd(5,CoreFileUploaderAudioRecorderComponent_ng_container_8_div_2_div_5_Template,1,0,"div",10),b.zc(6,"core-chrono",11),b.Dc(),b.Ec(7,"div",12),b.nd(8,CoreFileUploaderAudioRecorderComponent_ng_container_8_div_2_ion_button_8_Template,3,3,"ion-button",13),b.nd(9,CoreFileUploaderAudioRecorderComponent_ng_container_8_div_2_ion_button_9_Template,3,3,"ion-button",14),b.Dc(),b.Ec(10,"div",12),b.Ec(11,"ion-button",0),b.Mc("click",(function CoreFileUploaderAudioRecorderComponent_ng_container_8_div_2_Template_ion_button_click_11_listener(){b.fd(e);return b.Oc(2).stopRecording()})),b.Pc(12,"translate"),b.zc(13,"ion-icon",15),b.Dc(),b.Dc(),b.Dc(),b.Dc()}if(2&e){const e=b.Oc().ngIf,t=b.Oc();b.lc(1),b.Vc("ngIf",b.Qc(2,9,t.histogramAnalyzer$)),b.lc(4),b.Vc("ngIf","recording-ongoing"===e),b.lc(1),b.qc("recording","recording-ongoing"===e),b.Vc("running","recording-ongoing"===e)("hours",!1),b.lc(2),b.Vc("ngIf","recording-ongoing"===e),b.lc(1),b.Vc("ngIf","recording-paused"===e),b.lc(2),b.mc("aria-label",b.Qc(12,11,"core.fileuploader.stoprecording"))}}function CoreFileUploaderAudioRecorderComponent_ng_container_8_div_3_audio_1_Template(e,t){if(1&e&&(b.Ec(0,"audio",23),b.zc(1,"source",24),b.Dc()),2&e){const e=t.ngIf;b.lc(1),b.Vc("src",e,b.id)}}function CoreFileUploaderAudioRecorderComponent_ng_container_8_div_3_Template(e,t){if(1&e){const e=b.Fc();b.Ec(0,"div",4),b.nd(1,CoreFileUploaderAudioRecorderComponent_ng_container_8_div_3_audio_1_Template,2,1,"audio",20),b.Pc(2,"async"),b.Ec(3,"div",8),b.Ec(4,"div",12),b.Ec(5,"ion-button",19),b.Mc("click",(function CoreFileUploaderAudioRecorderComponent_ng_container_8_div_3_Template_ion_button_click_5_listener(){b.fd(e);return b.Oc(2).discardRecording()})),b.Pc(6,"translate"),b.zc(7,"ion-icon",21),b.Dc(),b.Dc(),b.Ec(8,"div",12),b.Ec(9,"ion-button",22),b.Mc("click",(function CoreFileUploaderAudioRecorderComponent_ng_container_8_div_3_Template_ion_button_click_9_listener(){b.fd(e);return b.Oc(2).submit()})),b.pd(10),b.Pc(11,"translate"),b.Dc(),b.Dc(),b.Dc(),b.Dc()}if(2&e){const e=b.Oc(2);b.lc(1),b.Vc("ngIf",b.Qc(2,3,e.recordingUrl$)),b.lc(4),b.mc("aria-label",b.Qc(6,5,"core.fileuploader.discardrecording")),b.lc(5),b.rd(" ",b.Qc(11,7,"core.save")," ")}}function CoreFileUploaderAudioRecorderComponent_ng_container_8_Template(e,t){if(1&e&&(b.Cc(0),b.nd(1,CoreFileUploaderAudioRecorderComponent_ng_container_8_div_1_Template,7,6,"div",3),b.nd(2,CoreFileUploaderAudioRecorderComponent_ng_container_8_div_2_Template,14,13,"div",3),b.nd(3,CoreFileUploaderAudioRecorderComponent_ng_container_8_div_3_Template,12,9,"div",3),b.Bc()),2&e){const e=t.ngIf;b.lc(1),b.Vc("ngIf","empty"===e),b.lc(1),b.Vc("ngIf",e.startsWith("recording")),b.lc(1),b.Vc("ngIf","done"===e)}}let P=(()=>{class CoreFileUploaderAudioRecorderComponent extends r.a{constructor(e){super(e),this.recording=null,this.media$=new c.a(null),this.recording$=this.media$.pipe(function recorderAudioRecording(){return e=>new l.a((t=>{let n,o=[];const onDataAvailable=e=>o.push(e.data),onError=e=>v.a.showErrorModal(e.error),onStop=()=>{const e=new Blob(o,{type:"audio/mpeg"});t.next({url:URL.createObjectURL(e),blob:e})},r=e.subscribe((e=>{null==n?void 0:n.removeEventListener("dataavailable",onDataAvailable),null==n||n.removeEventListener("error",onError),null==n||n.removeEventListener("stop",onStop),null==e||e.recorder.addEventListener("dataavailable",onDataAvailable),null==e||e.recorder.addEventListener("error",onError),null==e||e.recorder.addEventListener("stop",onStop),o=[],n=null==e?void 0:e.recorder,t.next(null)}));return t.next(null),()=>{r.unsubscribe(),null==n||n.removeEventListener("dataavailable",onDataAvailable),null==n||n.removeEventListener("error",onError),null==n||n.removeEventListener("stop",onStop)}}))}(),Object(u.a)(),Object(p.a)((e=>this.recording=e))),this.recordingUrl$=this.recording$.pipe(Object(g.a)((e=>e&&a.k.bypassSecurityTrustUrl(e.url)))),this.histogramAnalyzer$=this.media$.pipe(Object(g.a)((e=>!(null==e?void 0:e.analyser)||i.a.prefersReducedMotion()?null:e.analyser))),this.status$=Object(s.a)([this.media$.pipe((e=>new l.a((t=>{let n;const onStart=()=>t.next("recording"),onPause=()=>t.next("paused"),onResume=()=>t.next("recording"),onStop=()=>t.next("inactive"),o=e.subscribe((e=>{var o;null==n?void 0:n.removeEventListener("start",onStart),null==n||n.removeEventListener("pause",onPause),null==n||n.removeEventListener("resume",onResume),null==n||n.removeEventListener("stop",onStop),null==e||e.recorder.addEventListener("start",onStart),null==e||e.recorder.addEventListener("pause",onPause),null==e||e.recorder.addEventListener("resume",onResume),null==e||e.recorder.addEventListener("stop",onStop),n=null==e?void 0:e.recorder,t.next(null!==(o=null==e?void 0:e.recorder.state)&&void 0!==o?o:"inactive")}));return t.next("inactive"),()=>{o.unsubscribe(),null==n||n.removeEventListener("start",onStart),null==n||n.removeEventListener("pause",onPause),null==n||n.removeEventListener("resume",onResume),null==n||n.removeEventListener("stop",onStop)}}))),Object(u.a)()),this.recording$]).pipe(Object(g.a)((([e,t])=>"recording"===e?"recording-ongoing":"paused"===e?"recording-paused":t?"done":"empty")))}ngOnDestroy(){var e;const t=null===(e=this.media$.value)||void 0===e?void 0:e.recorder;t&&"inactive"!==t.state&&t.stop()}startRecording(){return Object(o.a)(this,void 0,void 0,(function*(){try{const e=yield this.createMedia();this.media$.next(e),e.recorder.start()}catch(e){v.a.showErrorModal(e)}}))}stopRecording(){var e;try{null===(e=this.media$.value)||void 0===e?void 0:e.recorder.stop()}catch(e){v.a.showErrorModal(e)}}pauseRecording(){var e;try{null===(e=this.media$.value)||void 0===e?void 0:e.recorder.pause()}catch(e){v.a.showErrorModal(e)}}resumeRecording(){var e;try{null===(e=this.media$.value)||void 0===e?void 0:e.recorder.resume()}catch(e){v.a.showErrorModal(e)}}discardRecording(){this.media$.next(null)}cancel(){return Object(o.a)(this,void 0,void 0,(function*(){this.close(new _.b(_.a))}))}submit(){return Object(o.a)(this,void 0,void 0,(function*(){if(this.recording)try{const e=yield f.a.getUniqueNameInFolder(f.b.TMPFOLDER,"recording.mp3"),t=m.a.concatenatePaths(f.b.TMPFOLDER,e),n=yield f.a.writeFile(t,this.recording.blob);this.close({name:n.name,fullPath:n.toURL(),type:"audio/mpeg"})}catch(e){v.a.showErrorModal(e)}}))}createMedia(){return Object(o.a)(this,void 0,void 0,(function*(){yield this.prepareMicrophoneAuthorization();const e=yield navigator.mediaDevices.getUserMedia({audio:!0}),t=new window.AudioContext,n=t.createMediaStreamSource(e),o=t.createAnalyser();return o.fftSize=2048,n.connect(o),{analyser:o,recorder:new d.a(e,{worker:this.startWorker(),audioContext:t})}}))}prepareMicrophoneAuthorization(){return Object(o.a)(this,void 0,void 0,(function*(){if(!i.a.isMobile())return;switch(yield a.j.requestMicrophoneAuthorization()){case a.j.permissionStatus.DENIED_ONCE:case a.j.permissionStatus.DENIED_ALWAYS:throw new Error(a.I.instant("core.fileuploader.microphonepermissiondenied"));case a.j.permissionStatus.RESTRICTED:throw new Error(a.I.instant("core.fileuploader.microphonepermissionrestricted"))}}))}startWorker(){const t=new Worker(e,void 0);return t.postMessage(Object(h.a)({vmsgWasmUrl:`${document.head.baseURI}assets/lib/vmsg/vmsg.wasm`})),t}}return CoreFileUploaderAudioRecorderComponent.ɵfac=function CoreFileUploaderAudioRecorderComponent_Factory(e){return new(e||CoreFileUploaderAudioRecorderComponent)(b.yc(b.r))},CoreFileUploaderAudioRecorderComponent.ɵcmp=b.sc({type:CoreFileUploaderAudioRecorderComponent,selectors:[["core-fileuploader-audio-recorder"]],features:[b.ic],decls:10,vars:9,consts:[["shape","round","fill","clear",3,"click"],["slot","icon-only","name","close"],[4,"ngIf"],["class","core-audio-recorder--wrapper",4,"ngIf"],[1,"core-audio-recorder--wrapper"],["shape","round","color","danger",3,"click"],["slot","icon-only","name","fas-microphone"],[3,"analyser","paused",4,"ngIf"],[1,"core-audio-recorder--controls"],[1,"core-audio-recorder--control","chrono"],["class","core-audio-recorder--recording-marker",4,"ngIf"],[3,"running","hours"],[1,"core-audio-recorder--control"],["shape","round","fill","clear",3,"click",4,"ngIf"],["shape","round","fill","clear","color","danger",3,"click",4,"ngIf"],["slot","icon-only","name","fa-check"],[3,"analyser","paused"],[1,"core-audio-recorder--recording-marker"],["slot","icon-only","name","fas-circle-pause"],["shape","round","fill","clear","color","danger",3,"click"],["controls","","controlsList","nodownload",4,"ngIf"],["slot","icon-only","name","fas-trash"],[3,"click"],["controls","","controlsList","nodownload"],[3,"src"]],template:function CoreFileUploaderAudioRecorderComponent_Template(e,t){1&e&&(b.Ec(0,"header"),b.Ec(1,"h1"),b.pd(2),b.Pc(3,"translate"),b.Dc(),b.Ec(4,"ion-button",0),b.Mc("click",(function CoreFileUploaderAudioRecorderComponent_Template_ion_button_click_4_listener(){return t.cancel()})),b.Pc(5,"translate"),b.zc(6,"ion-icon",1),b.Dc(),b.Dc(),b.zc(7,"hr"),b.nd(8,CoreFileUploaderAudioRecorderComponent_ng_container_8_Template,4,3,"ng-container",2),b.Pc(9,"async")),2&e&&(b.lc(2),b.qd(b.Qc(3,3,"core.fileuploader.audiotitle")),b.lc(2),b.mc("aria-label",b.Qc(5,5,"core.close")),b.lc(4),b.Vc("ngIf",b.Qc(9,7,t.status$)))},directives:[C.a,E.l,E.D,R.a,O.t,A.a,w.a],pipes:[y.d,O.b],styles:["[_nghost-%COMP%]{color:var(--ion-text-color,#000)}[_nghost-%COMP%]   header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}[_nghost-%COMP%]   header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:400;line-height:24px;letter-spacing:.15px}[_nghost-%COMP%]   header[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--padding-start:0;--padding-end:0;--icon-size:1.8em;margin:calc((var(--icon-size) - var(--a11y-min-target-size)) / 2)}[_nghost-%COMP%]   hr[_ngcontent-%COMP%]{background:var(--gray-300);margin:16px 0}[_nghost-%COMP%]   .core-audio-recorder--wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}[_nghost-%COMP%]   .core-audio-recorder--wrapper[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;font-weight:400;line-height:20px;letter-spacing:.25px;text-align:center;opacity:.6;margin-top:0;margin-bottom:16px}[_nghost-%COMP%]   .core-audio-recorder--wrapper[_ngcontent-%COMP%]   ion-button[shape=round][_ngcontent-%COMP%]{--border-radius:99px;--padding-start:16px;--padding-end:16px;--padding-top:16px;--padding-bottom:16px;height:-webkit-max-content;height:max-content}[_nghost-%COMP%]   .core-audio-recorder--wrapper[_ngcontent-%COMP%]   core-audio-histogram[_ngcontent-%COMP%]{width:100%;height:35px;display:block}[_nghost-%COMP%]   .core-audio-recorder--wrapper[_ngcontent-%COMP%]   audio[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}[_nghost-%COMP%]   .core-audio-recorder--wrapper[_ngcontent-%COMP%]   .core-audio-recorder--controls[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row;align-items:center;justify-content:space-between}[_nghost-%COMP%]   .core-audio-recorder--wrapper[_ngcontent-%COMP%]   .core-audio-recorder--controls[_ngcontent-%COMP%]   .core-audio-recorder--control[_ngcontent-%COMP%]{width:33%;text-align:center}[_nghost-%COMP%]   .core-audio-recorder--wrapper[_ngcontent-%COMP%]   .core-audio-recorder--controls[_ngcontent-%COMP%]   .core-audio-recorder--control[_ngcontent-%COMP%]:first-child{text-align:start}[_nghost-%COMP%]   .core-audio-recorder--wrapper[_ngcontent-%COMP%]   .core-audio-recorder--controls[_ngcontent-%COMP%]   .core-audio-recorder--control[_ngcontent-%COMP%]:last-child{text-align:end}[_nghost-%COMP%]   .core-audio-recorder--wrapper[_ngcontent-%COMP%]   .core-audio-recorder--controls[_ngcontent-%COMP%]   .core-audio-recorder--control.chrono[_ngcontent-%COMP%]{padding:0 16px;display:flex;flex-direction:row;align-items:center;justify-content:flex-start}[_nghost-%COMP%]   .core-audio-recorder--wrapper[_ngcontent-%COMP%]   .core-audio-recorder--controls[_ngcontent-%COMP%]   .core-audio-recorder--control[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0}[_nghost-%COMP%]   .core-audio-recorder--wrapper[_ngcontent-%COMP%]   .core-audio-recorder--controls[_ngcontent-%COMP%]   .core-audio-recorder--control[_ngcontent-%COMP%]   .core-audio-recorder--recording-marker[_ngcontent-%COMP%]{width:8px;height:8px;-webkit-margin-end:4px;margin-inline-end:4px;border-radius:4px;background:var(--danger)}[_nghost-%COMP%]   .core-audio-recorder--wrapper[_ngcontent-%COMP%]   .core-audio-recorder--controls[_ngcontent-%COMP%]   .core-audio-recorder--control[_ngcontent-%COMP%]   core-chrono.recording[_ngcontent-%COMP%]{color:var(--danger)}"],changeDetection:0}),CoreFileUploaderAudioRecorderComponent})()}).call(this,n("//gF"))},mEL8:function(e,t,n){"use strict";n.d(t,"a",(function(){return CoreModalComponent}));var o=n("mrSG"),r=n("FYaz"),i=n("rxAF");class CoreModalComponent{constructor({nativeElement:e}){this.result=new r.a,i.a.register(e,this)}close(e){return Object(o.a)(this,void 0,void 0,(function*(){if(e instanceof Error)return this.result.reject(e),void 0;this.result.resolve(e)}))}}},saoI:function(e,t,n){"use strict";n.r(t),n.d(t,"CoreFileUploaderAudioRecorderComponentModule",(function(){return c}));var o=n("L3Fv"),r=n("ag35"),i=n("jLgY");n.d(t,"CoreFileUploaderAudioRecorderComponent",(function(){return i.a}));var a=n("fXoL");let c=(()=>{class CoreFileUploaderAudioRecorderComponentModule{}return CoreFileUploaderAudioRecorderComponentModule.ɵmod=a.wc({type:CoreFileUploaderAudioRecorderComponentModule}),CoreFileUploaderAudioRecorderComponentModule.ɵinj=a.vc({factory:function CoreFileUploaderAudioRecorderComponentModule_Factory(e){return new(e||CoreFileUploaderAudioRecorderComponentModule)},imports:[[o.a]]}),CoreFileUploaderAudioRecorderComponentModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&a.kd(c,{declarations:[i.a,r.a],imports:[o.a]}))}}]);