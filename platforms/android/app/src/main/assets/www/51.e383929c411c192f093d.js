(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{vNWJ:function(t,n,e){"use strict";e.r(n),e.d(n,"AddonModDataLazyModule",(function(){return dt}));var a=e("L3Fv"),d=e("tyNb"),o=e("rGK3"),i=e("WsvK"),r=e("JCPi"),s=e("MLi9"),c=e("ay5P"),g=e("KarO"),l=e("mrSG"),h=e("3Pt+"),u=e("93ts"),p=e("hSQQ"),m=e("kWmn"),_=e("TEn/"),f=e("mWdr"),v=e("pHTc"),M=e("9+EE"),P=e("3LXp"),O=e("4reR"),C=e("bFG1"),b=e("j3ag"),y=e("fjkH"),I=e("39eS"),x=e("kTL9"),E=e("6s78"),D=e("vuGA"),w=e("8vmT"),A=e("D7J2"),k=e("fXoL"),T=e("hMzs"),L=e("ofXK"),R=e("nt/U"),G=e("PgjG"),F=e("WPIK"),V=e("ACYt"),N=e("QQhE"),j=e("eiAi"),z=e("sYmb");const S=["editFormEl"];function AddonModDataEditPage_ion_button_9_Template(t,n){if(1&t){const t=k.Fc();k.Ec(0,"ion-button",8),k.Mc("click",(function AddonModDataEditPage_ion_button_9_Template_ion_button_click_0_listener(n){k.fd(t);return k.Oc().save(n)})),k.pd(1),k.Pc(2,"translate"),k.Dc()}2&t&&(k.lc(1),k.rd(" ",k.Qc(2,1,"core.save")," "))}function AddonModDataEditPage_div_13_Template(t,n){if(1&t){const t=k.Fc();k.Ec(0,"div"),k.zc(1,"core-style",9),k.Ec(2,"form",10,11),k.Mc("ngSubmit",(function AddonModDataEditPage_div_13_Template_form_ngSubmit_2_listener(n){k.fd(t);return k.Oc().save(n)})),k.zc(4,"core-compile-html",12),k.Dc(),k.Dc()}if(2&t){const t=k.Oc();k.oc("addon-data-contents ",t.cssClass,""),k.lc(1),k.Xc("prefix",".",t.cssClass,""),k.Vc("css",t.database.csstemplate),k.lc(1),k.Vc("formGroup",t.editForm),k.lc(2),k.Vc("text",t.editFormRender)("jsData",t.jsData)("extraImports",t.extraImports)}}let q=(()=>{class AddonModDataEditPage{constructor(){this.fieldsArray=[],this.offline=!1,this.forceLeave=!1,this.isEditing=!1,this.originalData={},this.fields={},this.moduleId=0,this.title="",this.component=I.c.COMPONENT,this.loaded=!1,this.selectedGroup=0,this.cssClass="",this.editFormRender="",this.extraImports=[c.a],this.errors={},this.siteId=M.b.getCurrentSiteId(),this.editForm=new h.j({}),this.logView=w.a.once((()=>{this.database&&A.a.logEvent({type:A.b.VIEW_ITEM,ws:this.isEditing?"mod_data_update_entry":"mod_data_add_entry",name:this.title,data:{databaseid:this.database.id,category:"data"},url:"/mod/data/edit.php?"+(this.isEditing?`d=${this.database.id}&rid=${this.entryId}`:`id=${this.moduleId}`)})}))}ngOnInit(){try{this.moduleId=v.a.getRequiredRouteNumberParam("cmId"),this.courseId=v.a.getRequiredRouteNumberParam("courseId"),this.title=v.a.getRouteParam("title")||"",this.entryId=v.a.getRouteNumberParam("entryId")||void 0,this.selectedGroup=v.a.getRouteNumberParam("group")||0}catch(t){return P.a.showErrorModal(t),v.a.back(),void 0}this.isEditing=void 0!==this.entryId&&this.entryId>0,this.fetchEntryData(!0)}canLeave(){return Object(l.a)(this,void 0,void 0,(function*(){if(this.forceLeave||!this.entry)return!0;const t=this.editForm.value;let n=x.a.hasEditDataChanged(t,this.fieldsArray,this.originalData);n=n||!this.isEditing&&this.initialSelectedGroup!=this.selectedGroup,n&&(yield P.a.showConfirm(b.I.instant("core.confirmcanceledit")));const e=yield x.a.getEditTmpFiles(t,this.fieldsArray,this.entry.contents);return p.a.clearTmpFiles(e),O.a.triggerFormCancelledEvent(this.formElement,this.siteId),!0}))}fetchEntryData(t=!1){return Object(l.a)(this,void 0,void 0,(function*(){try{this.database=yield I.a.getDatabase(this.courseId,this.moduleId),this.title=this.database.name||this.title,this.cssClass="addon-data-entries-"+this.database.id,this.fieldsArray=yield I.a.getFields(this.database.id,{cmId:this.moduleId}),this.fields=C.a.arrayToObject(this.fieldsArray,"id");const n=yield x.a.fetchEntry(this.database,this.fieldsArray,this.entryId||0);if(this.entry=n.entry,this.originalData=C.a.clone(this.entry.contents),this.entryId&&(this.selectedGroup=this.entry.groupid),!this.isEditing){let n=!1,e=this.groupInfo;if(t&&(e=yield f.a.getActivityGroupInfo(this.database.coursemodule),e.visibleGroups&&e.groups.length&&(e.groups=e.groups.filter((t=>0!==t.id)),e.defaultGroupId=e.groups[0].id),this.selectedGroup=f.a.validateGroupId(this.selectedGroup,e),this.initialSelectedGroup=this.selectedGroup),(null==e?void 0:e.groups)&&(null==e?void 0:e.groups.length)>0)if(t){const t={};yield Promise.all(e.groups.map((n=>Object(l.a)(this,void 0,void 0,(function*(){const e=yield I.a.getDatabaseAccessInformation(this.database.id,{cmId:this.moduleId,groupId:n.id});t[n.id]=e.canaddentry}))))),e.groups=e.groups.filter((n=>!!t[n.id])),n=t[this.selectedGroup]}else n=!0;else{n=(yield I.a.getDatabaseAccessInformation(this.database.id,{cmId:this.moduleId})).canaddentry}if(this.groupInfo=e,!n)return P.a.showErrorModal("addon.mod_data.noaccess",!0),this.forceLeave=!0,v.a.back(),void 0}this.editFormRender=this.displayEditFields(),this.logView()}catch(t){P.a.showErrorModalDefault(t,"core.course.errorgetmodule",!0)}this.loaded=!0}))}save(t){var n,e,a,d;return Object(l.a)(this,void 0,void 0,(function*(){t.preventDefault(),t.stopPropagation();const o=this.editForm.value;try{let t=x.a.hasEditDataChanged(o,this.fieldsArray,(null===(n=this.entry)||void 0===n?void 0:n.contents)||{});if(t=t||!this.isEditing&&this.initialSelectedGroup!=this.selectedGroup,!t){if(this.entryId)return yield this.returnToEntryList(),void 0;throw new u.a(b.I.instant("addon.mod_data.emptyaddform"))}const i=yield P.a.showModalLoading("core.sending",!0),r=this.entryId?this.entryId:-Date.now();let s=[];try{try{s=yield x.a.getEditDataFromForm(o,this.fieldsArray,this.database.id,r,(null===(e=this.entry)||void 0===e?void 0:e.contents)||{},this.offline)}catch(t){if(this.offline||C.a.isWebServiceError(t))throw t;this.offline=!0,s=yield x.a.getEditDataFromForm(o,this.fieldsArray,this.database.id,r,(null===(a=this.entry)||void 0===a?void 0:a.contents)||{},this.offline)}if(s.length<=0)throw new u.a(b.I.instant("addon.mod_data.emptyaddform"));let t;if(t=this.isEditing?yield I.a.editEntry(this.database.id,this.entryId,this.courseId,s,this.fieldsArray,this.siteId,this.offline):yield I.a.addEntry(this.database.id,r,this.courseId,s,this.selectedGroup,this.fieldsArray,this.siteId,this.offline),this.isEditing&&"updated"in t&&t.updated||!this.isEditing&&"newentryid"in t&&t.newentryid){O.a.triggerFormSubmittedEvent(this.formElement,t.sent,this.siteId);const n=[];t.sent&&(y.b.trigger(y.b.ACTIVITY_DATA_SENT,{module:"data"}),this.isEditing&&n.push(I.a.invalidateEntryData(this.database.id,this.entryId,this.siteId)),n.push(I.a.invalidateEntriesData(this.database.id,this.siteId)));try{yield Promise.all(n),y.b.trigger(I.c.ENTRY_CHANGED,{dataId:this.database.id,entryId:this.entryId},this.siteId)}finally{this.returnToEntryList()}}else this.errors={},t.fieldnotifications&&t.fieldnotifications.forEach((t=>{const n=this.fieldsArray.find((n=>n.name==t.fieldname));n&&(this.errors[n.id]=t.notification)})),this.jsData.errors=this.errors,this.scrollToFirstError(),(null===(d=t.generalnotifications)||void 0===d?void 0:d.length)&&P.a.showAlertWithOptions({header:b.I.instant("core.notice"),message:D.b.buildMessage(t.generalnotifications),buttons:[b.I.instant("core.ok")]})}finally{i.dismiss()}}catch(t){P.a.showErrorModalDefault(t,"Cannot edit entry",!0)}}))}setGroup(t){return this.selectedGroup=t,this.loaded=!1,this.fetchEntryData()}displayEditFields(){var t;this.jsData={fields:this.fields,contents:C.a.clone(null===(t=this.entry)||void 0===t?void 0:t.contents)||{},form:this.editForm,database:this.database,errors:this.errors,onFieldInit:t=>this.onFieldInit(t)};let n=x.a.getTemplate(this.database,I.e.ADD,this.fieldsArray);this.fieldsArray.forEach((t=>{let e="[["+t.name+"]]";e=e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&");let a=new RegExp(e,"gi");n=n.replace(a,'<addon-mod-data-field-plugin [class.has-errors]="!!errors['+t.id+']" mode="edit"                 [field]="fields['+t.id+']" [value]="contents['+t.id+']" [form]="form" [database]="database"                 [error]="errors['+t.id+']" (onFieldInit)="onFieldInit($event)"></addon-mod-data-field-plugin>'),e="[["+t.name+"#id]]",e=e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&"),a=new RegExp(e,"gi"),n=n.replace(a,"field_"+t.id),e="[["+t.name+"#name]]",e=e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&"),a=new RegExp(e,"gi"),n=n.replace(a,t.name),e="[["+t.name+"#description]]",e=e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&"),a=new RegExp(e,"gi"),n=n.replace(a,t.description)}));const e=new RegExp("##otherfields##","gi");if(n.match(e)){const t=this.fieldsArray.filter((t=>!n.includes(`[field]="fields[${t.id}]`))).map((t=>`<p><strong>${t.name}</strong></p><p><addon-mod-data-field-plugin [class.has-errors]="!!errors[`+t.id+']" mode="edit"                 [field]="fields['+t.id+']" [value]="contents['+t.id+']" [form]="form" [database]="database"                 [error]="errors['+t.id+']" (onFieldInit)="onFieldInit($event)"></addon-mod-data-field-plugin><p>'));n=n.replace(e,t.join(""))}const a=new RegExp("##tags##","gi"),d=m.a.areTagsAvailableInSite()?"<p class=\"item-dimmed\">{{ 'addon.mod_data.edittagsnotsupported' | translate }}</p>":"";return n=n.replace(a,d),n}onFieldInit(t){var n,e,a,d,o,i,r;this.originalData[t.fieldid]||(this.originalData[t.fieldid]={id:0,recordid:null!==(e=null===(n=this.entry)||void 0===n?void 0:n.id)&&void 0!==e?e:0,fieldid:t.fieldid,content:t.content,content1:null!==(a=t.content1)&&void 0!==a?a:null,content2:null!==(d=t.content2)&&void 0!==d?d:null,content3:null!==(o=t.content3)&&void 0!==o?o:null,content4:null!==(i=t.content4)&&void 0!==i?i:null,files:null!==(r=t.files)&&void 0!==r?r:[]})}returnToEntryList(){var t;return Object(l.a)(this,void 0,void 0,(function*(){const n=this.editForm.value;try{const e=yield x.a.getEditTmpFiles(n,this.fieldsArray,(null===(t=this.entry)||void 0===t?void 0:t.contents)||{});p.a.clearTmpFiles(e)}finally{this.forceLeave=!0,v.a.back()}}))}scrollToFirstError(){var t;return Object(l.a)(this,void 0,void 0,(function*(){(yield E.a.scrollToElement(this.formElement.nativeElement,".addon-data-error"))||(null===(t=this.content)||void 0===t?void 0:t.scrollToTop())}))}}return AddonModDataEditPage.ɵfac=function AddonModDataEditPage_Factory(t){return new(t||AddonModDataEditPage)},AddonModDataEditPage.ɵcmp=k.sc({type:AddonModDataEditPage,selectors:[["page-addon-mod-data-edit"]],viewQuery:function AddonModDataEditPage_Query(t,n){var e;(1&t&&(k.ud(_.v,!0),k.ud(S,!0)),2&t)&&(k.dd(e=k.Nc())&&(n.content=e.first),k.dd(e=k.Nc())&&(n.formElement=e.first))},decls:14,vars:12,consts:[["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["slot","end"],["fill","clear",3,"click",4,"ngIf"],[3,"hideUntil"],[3,"groupInfo","selected","courseId","selectedChange"],[3,"class",4,"ngIf"],["fill","clear",3,"click"],[3,"css","prefix"],[3,"formGroup","ngSubmit"],["editFormEl",""],[3,"text","jsData","extraImports"]],template:function AddonModDataEditPage_Template(t,n){1&t&&(k.Ec(0,"ion-header"),k.Ec(1,"ion-toolbar"),k.Ec(2,"ion-buttons",0),k.zc(3,"ion-back-button",1),k.Pc(4,"translate"),k.Dc(),k.Ec(5,"ion-title"),k.Ec(6,"h1"),k.zc(7,"core-format-text",2),k.Dc(),k.Dc(),k.Ec(8,"ion-buttons",3),k.nd(9,AddonModDataEditPage_ion_button_9_Template,3,3,"ion-button",4),k.Dc(),k.Dc(),k.Dc(),k.Ec(10,"ion-content"),k.Ec(11,"core-loading",5),k.Ec(12,"core-group-selector",6),k.Mc("selectedChange",(function AddonModDataEditPage_Template_core_group_selector_selectedChange_12_listener(t){return n.selectedGroup=t}))("selectedChange",(function AddonModDataEditPage_Template_core_group_selector_selectedChange_12_listener(){return n.setGroup(n.selectedGroup)})),k.Dc(),k.nd(13,AddonModDataEditPage_div_13_Template,5,9,"div",7),k.Dc(),k.Dc()),2&t&&(k.lc(3),k.Vc("text",k.Qc(4,10,"core.back")),k.lc(4),k.Vc("text",n.title)("contextInstanceId",n.moduleId)("courseId",n.courseId),k.lc(2),k.Vc("ngIf",n.entry),k.lc(2),k.Vc("hideUntil",n.loaded),k.lc(1),k.Vc("groupInfo",n.groupInfo)("selected",n.selectedGroup)("courseId",null==n.database?null:n.database.course),k.lc(1),k.Vc("ngIf",n.database))},directives:[_.C,_.Ab,_.m,_.h,_.i,_.yb,T.a,L.t,R.a,_.v,G.a,F.a,V.a,_.l,N.a,h.H,h.s,h.k,j.a],pipes:[z.d],styles:["[_nghost-%COMP%]{--border-color:var(--stroke)}.addon-data-contents[_ngcontent-%COMP%]{overflow:visible;white-space:normal;word-break:break-word;padding:16px;background-color:var(--ion-item-background);border-bottom:1px solid var(--border-color)}.addon-data-contents[_ngcontent-%COMP%]     table, .addon-data-contents[_ngcontent-%COMP%]     tbody{display:block}.addon-data-contents[_ngcontent-%COMP%]     tr{display:flex;flex-wrap:wrap;padding:0}@media (max-width:575.98px){.addon-data-contents[_ngcontent-%COMP%]     tr{flex-direction:column}}.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px));margin:0;box-sizing:border-box;position:relative;flex-basis:0;flex-grow:1;width:100%;max-width:100%;min-height:auto}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px))}}@media (min-width:576px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px))}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px))}}}@media (min-width:768px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px))}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px))}}}@media (min-width:992px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px))}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px))}}}@media (min-width:1200px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px))}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px))}}}.addon-data-contents[_ngcontent-%COMP%]     address, .addon-data-contents[_ngcontent-%COMP%]     article, .addon-data-contents[_ngcontent-%COMP%]     aside, .addon-data-contents[_ngcontent-%COMP%]     blockquote, .addon-data-contents[_ngcontent-%COMP%]     canvas, .addon-data-contents[_ngcontent-%COMP%]     dd, .addon-data-contents[_ngcontent-%COMP%]     div, .addon-data-contents[_ngcontent-%COMP%]     dl, .addon-data-contents[_ngcontent-%COMP%]     dt, .addon-data-contents[_ngcontent-%COMP%]     fieldset, .addon-data-contents[_ngcontent-%COMP%]     figcaption, .addon-data-contents[_ngcontent-%COMP%]     figure, .addon-data-contents[_ngcontent-%COMP%]     footer, .addon-data-contents[_ngcontent-%COMP%]     form, .addon-data-contents[_ngcontent-%COMP%]     h1, .addon-data-contents[_ngcontent-%COMP%]     h2, .addon-data-contents[_ngcontent-%COMP%]     h3, .addon-data-contents[_ngcontent-%COMP%]     h4, .addon-data-contents[_ngcontent-%COMP%]     h5, .addon-data-contents[_ngcontent-%COMP%]     h6, .addon-data-contents[_ngcontent-%COMP%]     header, .addon-data-contents[_ngcontent-%COMP%]     li, .addon-data-contents[_ngcontent-%COMP%]     main, .addon-data-contents[_ngcontent-%COMP%]     nav, .addon-data-contents[_ngcontent-%COMP%]     noscript, .addon-data-contents[_ngcontent-%COMP%]     ol, .addon-data-contents[_ngcontent-%COMP%]     p, .addon-data-contents[_ngcontent-%COMP%]     pre, .addon-data-contents[_ngcontent-%COMP%]     section, .addon-data-contents[_ngcontent-%COMP%]     table, .addon-data-contents[_ngcontent-%COMP%]     tfoot, .addon-data-contents[_ngcontent-%COMP%]     ul, .addon-data-contents[_ngcontent-%COMP%]     video{width:auto!important;height:auto!important;min-width:auto!important;min-height:auto!important;max-height:none!important}.addon-data-contents[_ngcontent-%COMP%]     hr{border-top:1px solid var(--stroke)}","[_nghost-%COMP%]{--input-border-color:var(--stroke);--input-border-width:1px;--select-border-width:0px}[_nghost-%COMP%]     table{width:100%}[_nghost-%COMP%]     td{vertical-align:top}[_nghost-%COMP%]     .addon-data-latlong{display:flex}[_nghost-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]{padding:16px;width:100%}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%], [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]{background-color:var(--ion-item-background)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input{border-bottom:var(--input-border-width) solid var(--input-border-color)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input.has-focus, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input.has-focus.ion-valid, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input.ion-touched.ion-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input.has-focus, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input.has-focus.ion-valid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input.ion-touched.ion-invalid{--input-border-width:2px}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input.has-focus, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input.has-focus{--input-border-color:var(--primary)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input.has-focus.ion-valid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input.has-focus.ion-valid{--input-border-color:var(--success)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input.ion-touched.ion-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input.ion-touched.ion-invalid{--input-border-color:var(--danger)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     core-rich-text-editor, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     core-rich-text-editor{border-bottom:var(--select-border-width) solid var(--input-border-color)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-invalid, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-valid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-valid{--select-border-width:2px}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-valid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-valid{--input-border-color:var(--success)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-invalid{--input-border-color:var(--danger)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-select, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-select{border-bottom:var(--select-border-width) solid var(--input-border-color)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-select.ion-touched.ion-invalid, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-select.ion-touched.ion-valid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-select.ion-touched.ion-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-select.ion-touched.ion-valid{--select-border-width:2px}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-select.ion-touched.ion-valid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-select.ion-touched.ion-valid{--input-border-color:var(--success)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-select.ion-touched.ion-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-select.ion-touched.ion-invalid{--input-border-color:var(--danger)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .has-errors ion-input.ion-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .has-errors ion-input.ion-invalid{--input-border-width:2px;--input-border-color:var(--danger)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .has-errors core-rich-text-editor.ng-invalid, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .has-errors ion-select.ion-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .has-errors core-rich-text-editor.ng-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .has-errors ion-select.ion-invalid{--select-border-width:2px;--input-border-color:var(--danger)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required{float:right}[dir=rtl][_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required, [dir=rtl]   [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required, [dir=rtl][_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required, [dir=rtl]   [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required{float:left}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required+ion-input, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required+ion-select, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required+ion-input, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required+ion-select{padding-right:20px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required+ion-input, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required+ion-select, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required+ion-input, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required+ion-select{padding-right:unset;-webkit-padding-end:20px;padding-inline-end:20px}}"]}),AddonModDataEditPage})();var Q=e("1Rj0"),$=e("5pQw"),U=e("ULAo"),W=e("vwQL"),H=e("3CSS"),B=e("fY5/"),J=e("OoUD"),Y=e("3jOR");const entry_c0=function(t){return{$a:t}};function AddonModDataEntryPage_ion_card_13_Template(t,n){if(1&t&&(k.Ec(0,"ion-card",14),k.Ec(1,"ion-item"),k.zc(2,"ion-icon",15),k.Ec(3,"ion-label"),k.pd(4),k.Pc(5,"translate"),k.Dc(),k.Dc(),k.Dc()),2&t){const t=k.Oc();k.lc(4),k.qd(k.Rc(5,1,"core.hasdatatosync",k.ad(4,entry_c0,t.moduleName)))}}function AddonModDataEntryPage_div_15_Template(t,n){if(1&t){const t=k.Fc();k.Ec(0,"div"),k.zc(1,"core-style",16),k.Ec(2,"core-compile-html",17),k.Mc("compiling",(function AddonModDataEntryPage_div_15_Template_core_compile_html_compiling_2_listener(n){k.fd(t);return k.Oc().setRenderingEntry(n)})),k.Dc(),k.Dc()}if(2&t){const t=k.Oc();k.oc("addon-data-contents addon-data-entry addon-data-entries-",t.database.id,""),k.lc(1),k.Xc("prefix",".addon-data-entries-",t.database.id,""),k.Vc("css",t.database.csstemplate),k.lc(1),k.Vc("text",t.entryHtml)("jsData",t.jsData)("extraImports",t.extraImports)}}function AddonModDataEntryPage_core_rating_rate_16_Template(t,n){if(1&t){const t=k.Fc();k.Ec(0,"core-rating-rate",18),k.Mc("onLoading",(function AddonModDataEntryPage_core_rating_rate_16_Template_core_rating_rate_onLoading_0_listener(n){k.fd(t);return k.Oc().setLoadingRating(n)}))("onUpdate",(function AddonModDataEntryPage_core_rating_rate_16_Template_core_rating_rate_onUpdate_0_listener(){k.fd(t);return k.Oc().ratingUpdated()})),k.Dc()}if(2&t){const t=k.Oc();k.Vc("ratingInfo",t.ratingInfo)("instanceId",t.database.coursemodule)("itemId",t.entry.id)("itemSetId",0)("courseId",t.courseId)("aggregateMethod",t.database.assessed)("scaleId",t.database.scale)("userId",t.entry.userid)}}function AddonModDataEntryPage_core_rating_aggregate_17_Template(t,n){if(1&t&&k.zc(0,"core-rating-aggregate",19),2&t){const t=k.Oc();k.Vc("ratingInfo",t.ratingInfo)("instanceId",t.database.coursemodule)("itemId",t.entry.id)("courseId",t.courseId)("aggregateMethod",t.database.assessed)("scaleId",t.database.scale)}}function AddonModDataEntryPage_core_comments_18_Template(t,n){if(1&t){const t=k.Fc();k.Ec(0,"core-comments",20),k.Mc("onLoading",(function AddonModDataEntryPage_core_comments_18_Template_core_comments_onLoading_0_listener(n){k.fd(t);return k.Oc().setLoadingComments(n)})),k.Dc()}if(2&t){const t=k.Oc();k.Vc("instanceId",t.database.coursemodule)("itemId",t.entry.id)("courseId",t.courseId)("showItem",!0)}}function AddonModDataEntryPage_div_19_Template(t,n){if(1&t){const t=k.Fc();k.Ec(0,"div",21),k.Ec(1,"ion-row",22),k.Ec(2,"ion-col",23),k.Ec(3,"ion-button",24),k.Mc("click",(function AddonModDataEntryPage_div_19_Template_ion_button_click_3_listener(){k.fd(t);const n=k.Oc();return n.gotoEntry(n.offset-1)})),k.Pc(4,"translate"),k.zc(5,"ion-icon",25),k.Dc(),k.Dc(),k.zc(6,"ion-col",26),k.Ec(7,"ion-col",27),k.Ec(8,"ion-button",24),k.Mc("click",(function AddonModDataEntryPage_div_19_Template_ion_button_click_8_listener(){k.fd(t);const n=k.Oc();return n.gotoEntry(n.offset+1)})),k.Pc(9,"translate"),k.zc(10,"ion-icon",28),k.Dc(),k.Dc(),k.Dc(),k.Dc()}if(2&t){const t=k.Oc();k.lc(3),k.Vc("disabled",!t.hasPrevious),k.mc("aria-label",k.Qc(4,4,"core.previous")),k.lc(5),k.Vc("disabled",!t.hasNext),k.mc("aria-label",k.Qc(9,6,"core.next"))}}let K=(()=>{class AddonModDataEntryPage{constructor(t){this.cdr=t,this.fields={},this.fieldsArray=[],this.sortBy=0,this.sortDirection="DESC",this.moduleId=0,this.title="",this.moduleName="data",this.component=I.c.COMPONENT,this.entryLoaded=!1,this.renderingEntry=!1,this.loadingComments=!1,this.loadingRating=!1,this.selectedGroup=0,this.hasPrevious=!1,this.hasNext=!1,this.showComments=!1,this.entryHtml="",this.extraImports=[c.a],this.isPullingToRefresh=!1,this.commentsEnabled=!1,this.moduleName=U.a.translateModuleName("data"),this.siteId=M.b.getCurrentSiteId(),this.syncObserver=y.b.on(W.b.AUTO_SYNCED,(t=>{var n;void 0!==t.entryId&&(t.entryId!=this.entryId&&t.offlineEntryId!=this.entryId||(null===(n=this.database)||void 0===n?void 0:n.id)!=t.dataId||(t.deleted?v.a.back():(this.entryId=t.entryId,this.entryLoaded=!1,this.fetchEntryData(!0))))}),this.siteId),this.entryChangedObserver=y.b.on(I.c.ENTRY_CHANGED,(t=>{var n;t.entryId==this.entryId&&(null===(n=this.database)||void 0===n?void 0:n.id)==t.dataId&&(t.deleted?v.a.back():(this.entryLoaded=!1,this.fetchEntryData(!0)))}),this.siteId),this.logView=w.a.once((()=>this.performLogView()))}ngOnInit(){var t;return Object(l.a)(this,void 0,void 0,(function*(){try{this.moduleId=v.a.getRequiredRouteNumberParam("cmId"),this.courseId=v.a.getRequiredRouteNumberParam("courseId"),this.entryId=v.a.getRouteNumberParam("entryId")||void 0,this.title=v.a.getRouteParam("title")||"",this.selectedGroup=v.a.getRouteNumberParam("group")||0,this.offset=v.a.getRouteNumberParam("offset"),this.sortDirection=null!==(t=v.a.getRouteParam("sortDirection"))&&void 0!==t?t:this.sortDirection;const n=Number(v.a.getRouteParam("sortBy"));this.sortBy=isNaN(n)?this.sortBy:n}catch(t){return P.a.showErrorModal(t),v.a.back(),void 0}this.commentsEnabled=!$.a.areCommentsDisabledInSite(),yield this.fetchEntryData()}))}fetchEntryData(t=!1,n=!1){var e;return Object(l.a)(this,void 0,void 0,(function*(){this.isPullingToRefresh=n;try{this.database=yield I.a.getDatabase(this.courseId,this.moduleId),this.title=this.database.name||this.title,this.fieldsArray=yield I.a.getFields(this.database.id,{cmId:this.moduleId}),this.fields=C.a.arrayToObject(this.fieldsArray,"id"),yield this.setEntryFromOffset(),this.access=yield I.a.getDatabaseAccessInformation(this.database.id,{cmId:this.moduleId}),this.groupInfo=yield f.a.getActivityGroupInfo(this.database.coursemodule),this.groupInfo.visibleGroups&&this.groupInfo.groups.length&&(this.groupInfo.groups=this.groupInfo.groups.filter((t=>0!==t.id)),this.groupInfo.defaultGroupId=this.groupInfo.groups[0].id),this.selectedGroup=f.a.validateGroupId(this.selectedGroup,this.groupInfo);const t=x.a.getActions(this.database,this.access,this.entry,I.d.SHOW),n=x.a.getTemplate(this.database,I.e.SINGLE,this.fieldsArray);this.entryHtml=x.a.displayShowFields(n,this.fieldsArray,this.entry,I.d.SHOW,t,{offset:this.offset,sortBy:this.sortBy,sortDirection:this.sortDirection}),this.showComments=t.comments;const e={};e[this.entryId]=this.entry,this.jsData={fields:this.fields,entries:e,database:this.database,title:this.title,group:this.selectedGroup,access:this.access},this.logView()}catch(e){if(!t)return this.refreshAllData(n);P.a.showErrorModalDefault(e,"core.course.errorgetmodule",!0)}finally{null===(e=this.content)||void 0===e?void 0:e.scrollToTop(),this.entryLoaded=!0}}))}gotoEntry(t){return Object(l.a)(this,void 0,void 0,(function*(){this.offset=t,this.entryId=void 0,this.entry=void 0,this.entryLoaded=!1,this.logView=w.a.once((()=>this.performLogView())),yield this.fetchEntryData()}))}refreshAllData(t){return Object(l.a)(this,void 0,void 0,(function*(){const n=[];n.push(I.a.invalidateDatabaseData(this.courseId)),this.database&&(n.push(I.a.invalidateEntryData(this.database.id,this.entryId)),n.push(f.a.invalidateActivityGroupInfo(this.database.coursemodule)),n.push(I.a.invalidateEntriesData(this.database.id)),n.push(I.a.invalidateFieldsData(this.database.id)),this.database.comments&&this.entry&&this.entry.id>0&&this.commentsEnabled&&this.comments&&this.comments.doRefresh().catch((()=>{}))),yield Promise.all(n).finally((()=>this.fetchEntryData(!0,t)))}))}refreshDatabase(t){this.entryLoaded&&this.refreshAllData(!0).finally((()=>{null==t?void 0:t.complete()}))}setGroup(t){return Object(l.a)(this,void 0,void 0,(function*(){this.selectedGroup=t,this.offset=void 0,this.entry=void 0,this.entryId=void 0,this.entryLoaded=!1,yield this.fetchEntryData()}))}setEntryFromOffset(){var t,n,e;return Object(l.a)(this,void 0,void 0,(function*(){if(void 0===this.offset&&void 0!==this.entryId){this.hasNext=!1,this.hasPrevious=!1;const t=yield x.a.fetchEntry(this.database,this.fieldsArray,this.entryId);return this.entry=t.entry,this.ratingInfo=t.ratinginfo,void 0}const a=I.c.PER_PAGE,d=void 0!==this.offset&&this.offset>=0?Math.floor(this.offset/a):0,o=yield x.a.fetchEntries(this.database,this.fieldsArray,{groupId:this.selectedGroup,sort:this.sortBy,order:this.sortDirection,page:d,perPage:a}),i=(o.offlineEntries||[]).concat(o.entries);let r=0;if(void 0===this.offset?(r=0,this.offset=0):r=this.offset>0?this.offset%a+((null===(t=o.offlineEntries)||void 0===t?void 0:t.length)||0):this.offset+((null===(n=o.offlineEntries)||void 0===n?void 0:n.length)||0),this.entry=i[r],this.entryId=this.entry.id,this.hasPrevious=d>0||r>0,r+1<i.length)this.hasNext=!0;else if(i.length<a)this.hasNext=!1;else{const t=yield I.a.getEntries(this.database.id,{groupId:this.selectedGroup,page:d+1,perPage:a});this.hasNext=(null===(e=null==t?void 0:t.entries)||void 0===e?void 0:e.length)>0}if(this.entryId>0){const t=yield I.a.getEntry(this.database.id,this.entryId,{cmId:this.moduleId});this.ratingInfo=t.ratinginfo}}))}setRenderingEntry(t){this.renderingEntry=t,this.cdr.detectChanges()}setLoadingComments(t){this.loadingComments=t,this.cdr.detectChanges()}setLoadingRating(t){this.loadingRating=t,this.cdr.detectChanges()}ratingUpdated(){I.a.invalidateEntryData(this.database.id,this.entryId)}performLogView(){return Object(l.a)(this,void 0,void 0,(function*(){this.database&&(yield C.a.ignoreErrors(I.a.logView(this.database.id)),U.a.storeModuleViewed(this.courseId,this.moduleId),A.a.logEvent({type:A.b.VIEW_ITEM,ws:"mod_data_view_database",name:this.database.name,data:{id:this.entryId,databaseid:this.database.id,category:"data"},url:`/mod/data/view.php?d=${this.database.id}&rid=${this.entryId}`}))}))}ngOnDestroy(){var t,n;null===(t=this.syncObserver)||void 0===t?void 0:t.off(),null===(n=this.entryChangedObserver)||void 0===n||n.off()}}return AddonModDataEntryPage.ɵfac=function AddonModDataEntryPage_Factory(t){return new(t||AddonModDataEntryPage)(k.yc(k.j))},AddonModDataEntryPage.ɵcmp=k.sc({type:AddonModDataEntryPage,selectors:[["page-addon-mod-data-entry"]],viewQuery:function AddonModDataEntryPage_Query(t,n){var e;(1&t&&(k.ud(_.v,!0),k.ud(Q.a,!0)),2&t)&&(k.dd(e=k.Nc())&&(n.content=e.first),k.dd(e=k.Nc())&&(n.comments=e.first))},decls:20,vars:20,consts:[["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],[1,"limited-width"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["class","core-warning-card",4,"ngIf"],[3,"groupInfo","selected","courseId","selectedChange"],[3,"class",4,"ngIf"],["contextLevel","module",3,"ratingInfo","instanceId","itemId","itemSetId","courseId","aggregateMethod","scaleId","userId","onLoading","onUpdate",4,"ngIf"],["contextLevel","module",3,"ratingInfo","instanceId","itemId","courseId","aggregateMethod","scaleId",4,"ngIf"],["contextLevel","module","component","mod_data","area","database_entry",3,"instanceId","itemId","courseId","showItem","onLoading",4,"ngIf"],["collapsible-footer","","slot","fixed","appearOnBottom","",4,"ngIf"],[1,"core-warning-card"],["name","fas-triangle-exclamation","slot","start","aria-hidden","true"],[3,"css","prefix"],[3,"text","jsData","extraImports","compiling"],["contextLevel","module",3,"ratingInfo","instanceId","itemId","itemSetId","courseId","aggregateMethod","scaleId","userId","onLoading","onUpdate"],["contextLevel","module",3,"ratingInfo","instanceId","itemId","courseId","aggregateMethod","scaleId"],["contextLevel","module","component","mod_data","area","database_entry",3,"instanceId","itemId","courseId","showItem","onLoading"],["collapsible-footer","","slot","fixed","appearOnBottom",""],[1,"ion-justify-content-between","ion-align-items-center","ion-no-padding","ion-wrap"],["size","auto",1,"ion-text-start","ion-no-padding","core-navigation-arrow"],["fill","clear",3,"disabled","click"],["name","fas-chevron-left","slot","icon-only","aria-hidden","true"],[1,"ion-text-center"],["size","auto",1,"ion-text-end","ion-no-padding","core-navigation-arrow"],["name","fas-chevron-right","slot","icon-only","aria-hidden","true"]],template:function AddonModDataEntryPage_Template(t,n){1&t&&(k.Ec(0,"ion-header"),k.Ec(1,"ion-toolbar"),k.Ec(2,"ion-buttons",0),k.zc(3,"ion-back-button",1),k.Pc(4,"translate"),k.Dc(),k.Ec(5,"ion-title"),k.Ec(6,"h1"),k.zc(7,"core-format-text",2),k.Dc(),k.Dc(),k.Dc(),k.Dc(),k.Ec(8,"ion-content",3),k.Ec(9,"ion-refresher",4),k.Mc("ionRefresh",(function AddonModDataEntryPage_Template_ion_refresher_ionRefresh_9_listener(t){return n.refreshDatabase(t.target)})),k.zc(10,"ion-refresher-content",5),k.Pc(11,"translate"),k.Dc(),k.Ec(12,"core-loading",6),k.nd(13,AddonModDataEntryPage_ion_card_13_Template,6,6,"ion-card",7),k.Ec(14,"core-group-selector",8),k.Mc("selectedChange",(function AddonModDataEntryPage_Template_core_group_selector_selectedChange_14_listener(t){return n.selectedGroup=t}))("selectedChange",(function AddonModDataEntryPage_Template_core_group_selector_selectedChange_14_listener(){return n.setGroup(n.selectedGroup)})),k.Dc(),k.nd(15,AddonModDataEntryPage_div_15_Template,3,8,"div",9),k.nd(16,AddonModDataEntryPage_core_rating_rate_16_Template,1,8,"core-rating-rate",10),k.nd(17,AddonModDataEntryPage_core_rating_aggregate_17_Template,1,6,"core-rating-aggregate",11),k.nd(18,AddonModDataEntryPage_core_comments_18_Template,1,4,"core-comments",12),k.Dc(),k.nd(19,AddonModDataEntryPage_div_19_Template,11,8,"div",13),k.Dc()),2&t&&(k.lc(3),k.Vc("text",k.Qc(4,16,"core.back")),k.lc(4),k.Vc("text",n.title)("contextInstanceId",n.moduleId)("courseId",n.courseId),k.lc(2),k.Vc("disabled",!n.entryLoaded||!(n.isPullingToRefresh||!n.renderingEntry&&!n.loadingRating&&!n.loadingComments)),k.lc(1),k.Wc("pullingText",k.Qc(11,18,"core.pulltorefresh")),k.lc(2),k.Vc("hideUntil",n.entryLoaded&&(n.isPullingToRefresh||!n.renderingEntry&&!n.loadingRating&&!n.loadingComments)),k.lc(1),k.Vc("ngIf",n.entry&&n.entry.hasOffline),k.lc(1),k.Vc("groupInfo",n.groupInfo)("selected",n.selectedGroup)("courseId",n.courseId),k.lc(1),k.Vc("ngIf",n.database&&n.entry),k.lc(1),k.Vc("ngIf",n.database&&n.entry&&n.ratingInfo&&(!n.database.approval||n.entry.approved)),k.lc(1),k.Vc("ngIf",n.database&&n.entry&&n.ratingInfo),k.lc(1),k.Vc("ngIf",n.database&&n.database.comments&&n.entry&&n.entry.id>0&&n.commentsEnabled),k.lc(1),k.Vc("ngIf",n.entryLoaded&&n.hasPrevious||n.hasNext))},directives:[_.C,_.Ab,_.m,_.h,_.i,_.yb,T.a,R.a,_.v,_.bb,_.cb,G.a,L.t,F.a,_.n,_.I,_.D,H.a,_.O,N.a,j.a,B.a,J.a,Q.a,Y.a,_.hb,_.u,V.a,_.l],pipes:[z.d],styles:["[_nghost-%COMP%]{--border-color:var(--stroke)}.addon-data-contents[_ngcontent-%COMP%]{overflow:visible;white-space:normal;word-break:break-word;padding:16px;background-color:var(--ion-item-background);border-bottom:1px solid var(--border-color)}.addon-data-contents[_ngcontent-%COMP%]     table, .addon-data-contents[_ngcontent-%COMP%]     tbody{display:block}.addon-data-contents[_ngcontent-%COMP%]     tr{display:flex;flex-wrap:wrap;padding:0}@media (max-width:575.98px){.addon-data-contents[_ngcontent-%COMP%]     tr{flex-direction:column}}.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px));margin:0;box-sizing:border-box;position:relative;flex-basis:0;flex-grow:1;width:100%;max-width:100%;min-height:auto}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px))}}@media (min-width:576px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px))}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px))}}}@media (min-width:768px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px))}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px))}}}@media (min-width:992px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px))}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px))}}}@media (min-width:1200px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px))}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px))}}}.addon-data-contents[_ngcontent-%COMP%]     address, .addon-data-contents[_ngcontent-%COMP%]     article, .addon-data-contents[_ngcontent-%COMP%]     aside, .addon-data-contents[_ngcontent-%COMP%]     blockquote, .addon-data-contents[_ngcontent-%COMP%]     canvas, .addon-data-contents[_ngcontent-%COMP%]     dd, .addon-data-contents[_ngcontent-%COMP%]     div, .addon-data-contents[_ngcontent-%COMP%]     dl, .addon-data-contents[_ngcontent-%COMP%]     dt, .addon-data-contents[_ngcontent-%COMP%]     fieldset, .addon-data-contents[_ngcontent-%COMP%]     figcaption, .addon-data-contents[_ngcontent-%COMP%]     figure, .addon-data-contents[_ngcontent-%COMP%]     footer, .addon-data-contents[_ngcontent-%COMP%]     form, .addon-data-contents[_ngcontent-%COMP%]     h1, .addon-data-contents[_ngcontent-%COMP%]     h2, .addon-data-contents[_ngcontent-%COMP%]     h3, .addon-data-contents[_ngcontent-%COMP%]     h4, .addon-data-contents[_ngcontent-%COMP%]     h5, .addon-data-contents[_ngcontent-%COMP%]     h6, .addon-data-contents[_ngcontent-%COMP%]     header, .addon-data-contents[_ngcontent-%COMP%]     li, .addon-data-contents[_ngcontent-%COMP%]     main, .addon-data-contents[_ngcontent-%COMP%]     nav, .addon-data-contents[_ngcontent-%COMP%]     noscript, .addon-data-contents[_ngcontent-%COMP%]     ol, .addon-data-contents[_ngcontent-%COMP%]     p, .addon-data-contents[_ngcontent-%COMP%]     pre, .addon-data-contents[_ngcontent-%COMP%]     section, .addon-data-contents[_ngcontent-%COMP%]     table, .addon-data-contents[_ngcontent-%COMP%]     tfoot, .addon-data-contents[_ngcontent-%COMP%]     ul, .addon-data-contents[_ngcontent-%COMP%]     video{width:auto!important;height:auto!important;min-width:auto!important;min-height:auto!important;max-height:none!important}.addon-data-contents[_ngcontent-%COMP%]     hr{border-top:1px solid var(--stroke)}"]}),AddonModDataEntryPage})();var X=e("ghUQ"),Z=e("DHaU"),tt=e("4JiN");let nt=(()=>{class AddonModDataIndexPage extends X.a{constructor(){super(...arguments),this.group=0}ngOnInit(){super.ngOnInit(),this.group=v.a.getRouteNumberParam("group")||0}}return AddonModDataIndexPage.ɵfac=function AddonModDataIndexPage_Factory(t){return et(t||AddonModDataIndexPage)},AddonModDataIndexPage.ɵcmp=k.sc({type:AddonModDataIndexPage,selectors:[["page-addon-mod-data-index"]],viewQuery:function AddonModDataIndexPage_Query(t,n){var e;(1&t&&k.ud(Z.a,!0),2&t)&&(k.dd(e=k.Nc())&&(n.activityComponent=e.first))},features:[k.ic],decls:14,vars:13,consts:[["collapsible",""],["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["slot","end"],[1,"limited-width"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"module","courseId","group","dataRetrieved"]],template:function AddonModDataIndexPage_Template(t,n){1&t&&(k.Ec(0,"ion-header",0),k.Ec(1,"ion-toolbar"),k.Ec(2,"ion-buttons",1),k.zc(3,"ion-back-button",2),k.Pc(4,"translate"),k.Dc(),k.Ec(5,"ion-title"),k.Ec(6,"h1"),k.zc(7,"core-format-text",3),k.Dc(),k.Dc(),k.zc(8,"ion-buttons",4),k.Dc(),k.Dc(),k.Ec(9,"ion-content",5),k.Ec(10,"ion-refresher",6),k.Mc("ionRefresh",(function AddonModDataIndexPage_Template_ion_refresher_ionRefresh_10_listener(t){return null==n.activityComponent?null:n.activityComponent.doRefresh(t.target)})),k.zc(11,"ion-refresher-content",7),k.Pc(12,"translate"),k.Dc(),k.Ec(13,"addon-mod-data-index",8),k.Mc("dataRetrieved",(function AddonModDataIndexPage_Template_addon_mod_data_index_dataRetrieved_13_listener(t){return n.updateData(t)})),k.Dc(),k.Dc()),2&t&&(k.lc(3),k.Vc("text",k.Qc(4,9,"core.back")),k.lc(4),k.Vc("text",n.title)("contextInstanceId",n.module.id)("courseId",n.courseId),k.lc(3),k.Vc("disabled",null==n.activityComponent?null:n.activityComponent.showLoading),k.lc(1),k.Wc("pullingText",k.Qc(12,11,"core.pulltorefresh")),k.lc(2),k.Vc("module",n.module)("courseId",n.courseId)("group",n.group))},directives:[_.C,tt.b,_.Ab,_.m,_.h,_.i,_.yb,T.a,R.a,_.v,_.bb,_.cb,Z.a],pipes:[z.d],encapsulation:2}),AddonModDataIndexPage})();const et=k.Gc(nt),at=[{path:":courseId/:cmId",component:nt},{path:":courseId/:cmId/edit",component:q,canDeactivate:[s.a]},{path:":courseId/:cmId/edit/:entryId",component:q,canDeactivate:[s.a]},{path:":courseId/:cmId/:entryId",component:K}];let dt=(()=>{class AddonModDataLazyModule{}return AddonModDataLazyModule.ɵmod=k.wc({type:AddonModDataLazyModule}),AddonModDataLazyModule.ɵinj=k.vc({factory:function AddonModDataLazyModule_Factory(t){return new(t||AddonModDataLazyModule)},imports:[[d.m.forChild(at),a.a,g.a,c.a,o.a,r.a,i.a]]}),AddonModDataLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&k.kd(dt,{declarations:[nt,K,q],imports:[d.m,a.a,g.a,c.a,o.a,r.a,i.a]}))}}]);