(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{RiDC:function(t,e,o){"use strict";o.d(e,"a",(function(){return E}));var i=o("mrSG"),r=o("3LXp"),n=o("9+EE"),s=o("mv9v"),c=o("pHTc"),a=o("tS8V"),d=o("MUy3"),l=o("j3ag"),m=o("fXoL"),u=o("TEn/"),h=o("ACYt"),f=o("3CSS"),_=o("ofXK"),p=o("nt/U"),g=o("PgjG"),v=o("yNDK"),b=o("hMzs"),I=o("iSJP"),S=o("FeAf"),w=o("sYmb");function CoreLoginSitesComponent_ion_button_11_Template(t,e){if(1&t){const t=m.Fc();m.Ec(0,"ion-button",1),m.Mc("click",(function CoreLoginSitesComponent_ion_button_11_Template_ion_button_click_0_listener(){m.fd(t);return m.Oc().toggleDelete()})),m.Pc(1,"translate"),m.zc(2,"ion-icon",14),m.Dc()}2&t&&m.mc("aria-label",m.Qc(1,1,"core.login.toggleremove"))}function CoreLoginSitesComponent_ion_card_15_ng_container_14_Template(t,e){1&t&&m.Ac(0)}const _c0=function(t){return{sites:t}};function CoreLoginSitesComponent_ion_card_15_Template(t,e){if(1&t&&(m.Ec(0,"ion-card"),m.Ec(1,"ion-item-divider",15),m.Ec(2,"ion-label"),m.Ec(3,"h2"),m.zc(4,"core-format-text",16),m.Dc(),m.Ec(5,"p"),m.Ec(6,"a",17),m.pd(7),m.Dc(),m.Dc(),m.Dc(),m.Dc(),m.Ec(8,"ion-item",18),m.zc(9,"core-user-avatar",19),m.Ec(10,"ion-label"),m.Ec(11,"p",20),m.pd(12),m.Dc(),m.Dc(),m.zc(13,"ion-icon",21),m.Dc(),m.nd(14,CoreLoginSitesComponent_ion_card_15_ng_container_14_Template,1,0,"ng-container",22),m.Dc()),2&t){const t=m.Oc(),e=m.ed(25);m.lc(4),m.Vc("text",t.accountsList.currentSite.siteName)("siteId",t.accountsList.currentSite.id),m.lc(2),m.Vc("href",t.accountsList.currentSite.siteUrl,m.id),m.lc(1),m.qd(t.accountsList.currentSite.siteUrlWithoutProtocol),m.lc(2),m.Vc("user",t.accountsList.currentSite)("linkProfile",!1)("siteId",t.accountsList.currentSite.id),m.lc(3),m.qd(t.accountsList.currentSite.fullname),m.lc(2),m.Vc("ngTemplateOutlet",e)("ngTemplateOutletContext",m.ad(10,_c0,t.accountsList.sameSite))}}function CoreLoginSitesComponent_ion_card_16_ion_item_divider_1_Template(t,e){if(1&t&&(m.Ec(0,"ion-item-divider",15),m.Ec(1,"ion-label"),m.Ec(2,"h2"),m.zc(3,"core-format-text",16),m.Dc(),m.Ec(4,"p"),m.Ec(5,"a",24),m.pd(6),m.Dc(),m.Dc(),m.Dc(),m.Dc()),2&t){const t=m.Oc().$implicit;m.lc(3),m.Vc("text",t[0].siteName)("siteId",t[0].id),m.lc(2),m.Vc("href",t[0].siteUrl,m.id),m.lc(1),m.qd(t[0].siteUrlWithoutProtocol)}}function CoreLoginSitesComponent_ion_card_16_ng_container_2_Template(t,e){1&t&&m.Ac(0)}function CoreLoginSitesComponent_ion_card_16_Template(t,e){if(1&t&&(m.Ec(0,"ion-card"),m.nd(1,CoreLoginSitesComponent_ion_card_16_ion_item_divider_1_Template,7,4,"ion-item-divider",23),m.nd(2,CoreLoginSitesComponent_ion_card_16_ng_container_2_Template,1,0,"ng-container",22),m.Dc()),2&t){const t=e.$implicit;m.Oc();const o=m.ed(25);m.lc(1),m.Vc("ngIf",t[0]),m.lc(1),m.Vc("ngTemplateOutlet",o)("ngTemplateOutletContext",m.ad(3,_c0,t))}}const _c1=function(t){return{count:t}};function CoreLoginSitesComponent_ng_template_24_ion_item_0_ion_badge_5_Template(t,e){if(1&t&&(m.Ec(0,"ion-badge",3),m.Ec(1,"span",29),m.pd(2),m.Dc(),m.Ec(3,"span",12),m.pd(4),m.Pc(5,"translate"),m.Dc(),m.Dc()),2&t){const t=m.Oc().$implicit;m.Vc("@coreShowHideAnimation",void 0),m.lc(2),m.qd(t.badge),m.lc(2),m.qd(m.Rc(5,3,"core.login.sitebadgedescription",m.ad(6,_c1,t.badge)))}}function CoreLoginSitesComponent_ng_template_24_ion_item_0_ion_button_6_Template(t,e){if(1&t){const t=m.Fc();m.Ec(0,"ion-button",30),m.Mc("click",(function CoreLoginSitesComponent_ng_template_24_ion_item_0_ion_button_6_Template_ion_button_click_0_listener(e){m.fd(t);const o=m.Oc().$implicit;return m.Oc(2).deleteSite(e,o)})),m.Pc(1,"translate"),m.zc(2,"ion-icon",31),m.Dc()}2&t&&(m.Vc("@coreSlideInOut","fromRight"),m.mc("aria-label",m.Qc(1,2,"core.login.removeaccount")))}function CoreLoginSitesComponent_ng_template_24_ion_item_0_Template(t,e){if(1&t){const t=m.Fc();m.Ec(0,"ion-item",26),m.Mc("click",(function CoreLoginSitesComponent_ng_template_24_ion_item_0_Template_ion_item_click_0_listener(o){m.fd(t);const i=e.$implicit;return m.Oc(2).login(o,i.id)})),m.zc(1,"core-user-avatar",19),m.Ec(2,"ion-label"),m.Ec(3,"p",20),m.pd(4),m.Dc(),m.Dc(),m.nd(5,CoreLoginSitesComponent_ng_template_24_ion_item_0_ion_badge_5_Template,6,8,"ion-badge",27),m.nd(6,CoreLoginSitesComponent_ng_template_24_ion_item_0_ion_button_6_Template,3,4,"ion-button",28),m.Dc()}if(2&t){const t=e.$implicit,o=m.Oc(2);m.lc(1),m.Vc("user",t)("linkProfile",!1)("siteId",t.id),m.lc(3),m.qd(t.fullname),m.lc(1),m.Vc("ngIf",!o.showDelete&&t.badge),m.lc(1),m.Vc("ngIf",o.showDelete)}}function CoreLoginSitesComponent_ng_template_24_Template(t,e){if(1&t&&m.nd(0,CoreLoginSitesComponent_ng_template_24_ion_item_0_Template,7,6,"ion-item",25),2&t){m.Vc("ngForOf",e.sites)}}let E=(()=>{class CoreLoginSitesComponent{constructor(){this.accountsList={sameSite:[],otherSites:[],count:0},this.showDelete=!1,this.loaded=!1,this.currentSiteId=n.b.getRequiredCurrentSite().getId()}ngOnInit(){return Object(i.a)(this,void 0,void 0,(function*(){this.accountsList=yield s.a.getAccountsList(this.currentSiteId),this.loaded=!0}))}add(t){return Object(i.a)(this,void 0,void 0,(function*(){yield this.close(t,!0),yield s.a.goToAddSite(!0,!0)}))}deleteSite(t,e){return Object(i.a)(this,void 0,void 0,(function*(){t.stopPropagation();let o=e.siteName||"";o=yield a.a.formatText(o,{clean:!0,singleLine:!0,filter:!1},[],e.id);try{yield r.a.showDeleteConfirm("core.login.confirmdeletesite",{sitename:o})}catch(t){return}try{yield s.a.deleteAccountFromList(this.accountsList,e),this.showDelete=!1}catch(t){r.a.showErrorModalDefault(t,"core.login.errordeletesite",!0)}}))}login(t,e){return Object(i.a)(this,void 0,void 0,(function*(){yield this.close(t,!0),yield c.a.navigateToSiteHome({preferCurrentTab:!1,siteId:e})}))}toggleDelete(){this.showDelete=!this.showDelete}close(t,e=!1){return Object(i.a)(this,void 0,void 0,(function*(){t.preventDefault(),t.stopPropagation(),yield l.w.dismiss(e)}))}}return CoreLoginSitesComponent.ɵfac=function CoreLoginSitesComponent_Factory(t){return new(t||CoreLoginSitesComponent)},CoreLoginSitesComponent.ɵcmp=m.sc({type:CoreLoginSitesComponent,selectors:[["core-login-sites"]],decls:26,vars:16,consts:[["slot","start"],["fill","clear",3,"click"],["name","arrow-back","slot","icon-only","aria-hidden","true"],["slot","end"],["fill","clear",3,"click",4,"ngIf"],[3,"hideUntil"],[1,"core-sitelist"],[4,"ngIf"],[4,"ngFor","ngForOf"],["slot","fixed","core-fab","","vertical","bottom","horizontal","end"],[3,"click"],["name","fas-plus","aria-hidden","true"],[1,"sr-only"],["siteList",""],["slot","icon-only","name","fas-pen","aria-hidden","true"],["sticky","true",1,"core-sitelist-sitename"],["clean","true",3,"text","siteId"],["core-link","","autoLogin","yes",3,"href"],["detail","false"],["slot","start",3,"user","linkProfile","siteId"],[1,"item-heading"],["color","success","name","fas-check"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["sticky","true","class","core-sitelist-sitename",4,"ngIf"],["core-link","","autoLogin","no",3,"href"],["button","","detail","true",3,"click",4,"ngFor","ngForOf"],["button","","detail","true",3,"click"],["slot","end",4,"ngIf"],["slot","end","fill","clear","color","danger",3,"click",4,"ngIf"],["aria-hidden","true"],["slot","end","fill","clear","color","danger",3,"click"],["name","fas-trash","slot","icon-only","aria-hidden","true"]],template:function CoreLoginSitesComponent_Template(t,e){1&t&&(m.Ec(0,"ion-header"),m.Ec(1,"ion-toolbar"),m.Ec(2,"ion-buttons",0),m.Ec(3,"ion-button",1),m.Mc("click",(function CoreLoginSitesComponent_Template_ion_button_click_3_listener(t){return e.close(t)})),m.Pc(4,"translate"),m.zc(5,"ion-icon",2),m.Dc(),m.Dc(),m.Ec(6,"ion-title"),m.Ec(7,"h1"),m.pd(8),m.Pc(9,"translate"),m.Dc(),m.Dc(),m.Ec(10,"ion-buttons",3),m.nd(11,CoreLoginSitesComponent_ion_button_11_Template,3,3,"ion-button",4),m.Dc(),m.Dc(),m.Dc(),m.Ec(12,"ion-content"),m.Ec(13,"core-loading",5),m.Ec(14,"ion-list",6),m.nd(15,CoreLoginSitesComponent_ion_card_15_Template,15,12,"ion-card",7),m.nd(16,CoreLoginSitesComponent_ion_card_16_Template,3,5,"ion-card",8),m.Dc(),m.Dc(),m.Ec(17,"ion-fab",9),m.Ec(18,"ion-fab-button",10),m.Mc("click",(function CoreLoginSitesComponent_Template_ion_fab_button_click_18_listener(t){return e.add(t)})),m.Pc(19,"translate"),m.zc(20,"ion-icon",11),m.Ec(21,"span",12),m.pd(22),m.Pc(23,"translate"),m.Dc(),m.Dc(),m.Dc(),m.Dc(),m.nd(24,CoreLoginSitesComponent_ng_template_24_Template,1,1,"ng-template",null,13,m.od)),2&t&&(m.lc(3),m.mc("aria-label",m.Qc(4,8,"core.back")),m.lc(5),m.qd(m.Qc(9,10,"core.mainmenu.switchaccount")),m.lc(3),m.Vc("ngIf",e.accountsList.count>1),m.lc(2),m.Vc("hideUntil",e.loaded),m.lc(2),m.Vc("ngIf",e.accountsList.currentSite),m.lc(1),m.Vc("ngForOf",e.accountsList.otherSites),m.lc(2),m.mc("aria-label",m.Qc(19,12,"core.login.add")),m.lc(4),m.qd(m.Qc(23,14,"core.login.add")))},directives:[u.C,u.Ab,u.m,h.a,u.l,u.D,f.a,u.yb,_.t,p.a,u.v,g.a,u.P,_.s,u.x,v.a,u.y,u.n,u.J,u.O,b.a,I.a,u.I,S.a,_.A,u.k],pipes:[w.d],styles:["ion-list.core-sitelist[_ngcontent-%COMP%]   .core-sitelist-sitename[_ngcontent-%COMP%]{border-bottom:1px solid var(--stroke)}ion-list.core-sitelist[_ngcontent-%COMP%]   .core-sitelist-sitename[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin-top:8px;margin-bottom:8px}"],data:{animation:[d.a.SLIDE_IN_OUT,d.a.SHOW_HIDE]}}),CoreLoginSitesComponent})()},"Y/uQ":function(t,e,o){"use strict";o.r(e),o.d(e,"AddonModScormLazyModule",(function(){return K}));var i=o("tyNb"),r=o("L3Fv"),n=o("snYc"),s=o("ghUQ"),c=o("pHTc"),a=o("kGPB"),d=o("fXoL"),l=o("TEn/"),m=o("4JiN"),u=o("hMzs"),h=o("nt/U"),f=o("sYmb");let _=(()=>{class AddonModScormIndexPage extends s.a{ngOnInit(){super.ngOnInit(),c.a.getRouteBooleanParam("autoPlay")&&(this.autoPlayData={mode:c.a.getRouteParam("mode"),newAttempt:c.a.getRouteBooleanParam("newAttempt"),organizationId:c.a.getRouteParam("organizationId"),scoId:c.a.getRouteNumberParam("scoId")})}}return AddonModScormIndexPage.ɵfac=function AddonModScormIndexPage_Factory(t){return p(t||AddonModScormIndexPage)},AddonModScormIndexPage.ɵcmp=d.sc({type:AddonModScormIndexPage,selectors:[["page-addon-mod-scorm-index"]],viewQuery:function AddonModScormIndexPage_Query(t,e){var o;(1&t&&d.ud(a.a,!0),2&t)&&(d.dd(o=d.Nc())&&(e.activityComponent=o.first))},features:[d.ic],decls:14,vars:13,consts:[["collapsible",""],["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["slot","end"],[1,"limited-width"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"module","courseId","autoPlayData","dataRetrieved"]],template:function AddonModScormIndexPage_Template(t,e){1&t&&(d.Ec(0,"ion-header",0),d.Ec(1,"ion-toolbar"),d.Ec(2,"ion-buttons",1),d.zc(3,"ion-back-button",2),d.Pc(4,"translate"),d.Dc(),d.Ec(5,"ion-title"),d.Ec(6,"h1"),d.zc(7,"core-format-text",3),d.Dc(),d.Dc(),d.zc(8,"ion-buttons",4),d.Dc(),d.Dc(),d.Ec(9,"ion-content",5),d.Ec(10,"ion-refresher",6),d.Mc("ionRefresh",(function AddonModScormIndexPage_Template_ion_refresher_ionRefresh_10_listener(t){return null==e.activityComponent?null:e.activityComponent.doRefresh(t.target)})),d.zc(11,"ion-refresher-content",7),d.Pc(12,"translate"),d.Dc(),d.Ec(13,"addon-mod-scorm-index",8),d.Mc("dataRetrieved",(function AddonModScormIndexPage_Template_addon_mod_scorm_index_dataRetrieved_13_listener(t){return e.updateData(t)})),d.Dc(),d.Dc()),2&t&&(d.lc(3),d.Vc("text",d.Qc(4,9,"core.back")),d.lc(4),d.Vc("text",e.title)("contextInstanceId",null==e.module?null:e.module.id)("courseId",e.courseId),d.lc(3),d.Vc("disabled",null==e.activityComponent?null:e.activityComponent.showLoading),d.lc(1),d.Wc("pullingText",d.Qc(12,11,"core.pulltorefresh")),d.lc(2),d.Vc("module",e.module)("courseId",e.courseId)("autoPlayData",e.autoPlayData))},directives:[l.C,m.b,l.Ab,l.m,l.h,l.i,l.yb,u.a,h.a,l.v,l.bb,l.cb,a.a],pipes:[f.d],encapsulation:2}),AddonModScormIndexPage})();const p=d.Gc(_);var g=o("mrSG"),v=o("9+EE"),b=o("uT8i"),I=o("3LXp"),S=o("Q98t"),w=o("bFG1"),E=o("fjkH"),y=o("bKlM");let C="^[\\u0000-\\uFFFF]{0,255}$",M="^[\\u0000-\\uFFFF]{0,4096}$";const D="^([0-2]{1}[0-9]{1}):([0-5]{1}[0-9]{1}):([0-5]{1}[0-9]{1})(.[0-9]{1,2})?$",T="^([0-9]{2,4}):([0-9]{2}):([0-9]{2})(.[0-9]{1,2})?$",O="^-?([0-9]+)$",P="^-?([0-9]{0,3})(.[0-9]*)?$",A="^[\\u0021-\\u007E]{0,255}$",L=C,x="[._](\\d+).",k="raw,min,max",N="0#100",U={0:"No error",101:"General exception",201:"Invalid argument error",202:"Element cannot have children",203:"Element not an array - cannot have count",301:"Not initialized",401:"Not implemented error",402:"Invalid set value, element is a keyword",403:"Element is read only",404:"Element is write only",405:"Incorrect data type"};class data_model_12_AddonModScormDataModel12{constructor(t,e,o,i,r,n=y.b.MODENORMAL,s=!1,c=!0){this.siteId=t,this.scorm=e,this.scoId=o,this.attempt=i,this.userData=r,this.mode=n,this.offline=s,this.canSaveTracks=c,this.currentUserData={},this.def={},this.defExtra={},this.dataModel={},this.initialized=!1,this.errorCode="0",this.init(r)}addTime(t,e){const o=t.split(":"),i=e.split(":"),r=o[2].split("."),n=i[2].split(".");let s=0,c=0;r.length>1&&(c=parseInt(r[1],10));let a=0;n.length>1&&(a=parseInt(n[1],10));let d=c+a;s=Math.floor(d/100),d-=100*s,Math.floor(d)<10&&(d="0"+d.toString());let l=parseInt(r[0],10)+parseInt(n[0],10)+s;s=Math.floor(l/60),l-=60*s,Math.floor(l)<10&&(l="0"+l.toString());let m=parseInt(o[1],10)+parseInt(i[1],10)+s;s=Math.floor(m/60),m-=60*s,m<10&&(m="0"+m.toString());let u=parseInt(o[0],10)+parseInt(i[0],10)+s;return u<10&&(u="0"+u.toString()),"0"!=d?u+":"+m+":"+l+"."+d:u+":"+m+":"+l}collectData(){if(!this.currentUserData[this.scoId])return[];const t=[];for(const e in this.currentUserData[this.scoId].userdata){if("cmi"!=e.substring(0,3)||"cmi.core.session_time"==e)continue;const o=new RegExp(x,"g"),i=e.replace(o,".n.");if(void 0===this.dataModel[this.scoId][e]&&void 0!==this.dataModel[this.scoId][i]&&(this.dataModel[this.scoId][e]=w.a.clone(this.dataModel[this.scoId][i])),void 0===this.dataModel[this.scoId][e]||"r"==this.dataModel[this.scoId][e].mod)continue;const r={element:e.replace(o,"_$1."),value:this.getEl(e)};void 0!==this.dataModel[this.scoId][e].defaultvalue?this.dataModel[this.scoId][e].defaultvalue!==r.value&&(t.push(r),this.dataModel[this.scoId][e].defaultvalue=r.value):(t.push(r),this.dataModel[this.scoId][e].defaultvalue=r.value)}return t}getEl(t){return this.currentUserData[this.scoId]&&void 0!==this.currentUserData[this.scoId].userdata[t]?this.currentUserData[this.scoId].userdata[t]:""}init(t){var e,o,i,r,n,s,c;this.scorm.scormStandard||(C="^[\\u0000-\\uFFFF]{0,64000}$",M=C);for(const e in t){const o=t[e];this.def[e]=o.defaultdata,this.defExtra[e]=o.userdata}for(const t in this.def){this.dataModel[t]={"cmi._children":{defaultvalue:"core,suspend_data,launch_data,comments,objectives,student_data,student_preference,interactions",mod:"r",writeerror:"402"},"cmi._version":{defaultvalue:"3.4",mod:"r",writeerror:"402"},"cmi.core._children":{defaultvalue:"student_id,student_name,lesson_location,credit,lesson_status,entry,score,total_time,lesson_mode,exit,session_time",mod:"r",writeerror:"402"},"cmi.core.student_id":{defaultvalue:this.def[t]["cmi.core.student_id"],mod:"r",writeerror:"403"},"cmi.core.student_name":{defaultvalue:this.def[t]["cmi.core.student_name"],mod:"r",writeerror:"403"},"cmi.core.lesson_location":{defaultvalue:this.def[t]["cmi.core.lesson_location"],format:C,mod:"rw",writeerror:"405"},"cmi.core.credit":{defaultvalue:this.def[t]["cmi.core.credit"],mod:"r",writeerror:"403"},"cmi.core.lesson_status":{defaultvalue:this.def[t]["cmi.core.lesson_status"],format:"^passed$|^completed$|^failed$|^incomplete$|^browsed$",mod:"rw",writeerror:"405"},"cmi.core.entry":{defaultvalue:this.def[t]["cmi.core.entry"],mod:"r",writeerror:"403"},"cmi.core.score._children":{defaultvalue:k,mod:"r",writeerror:"402"},"cmi.core.score.raw":{defaultvalue:this.def[t]["cmi.core.score.raw"],format:P,range:N,mod:"rw",writeerror:"405"},"cmi.core.score.max":{defaultvalue:this.def[t]["cmi.core.score.max"],format:P,range:N,mod:"rw",writeerror:"405"},"cmi.core.score.min":{defaultvalue:this.def[t]["cmi.core.score.min"],format:P,range:N,mod:"rw",writeerror:"405"},"cmi.core.total_time":{defaultvalue:this.def[t]["cmi.core.total_time"],mod:"r",writeerror:"403"},"cmi.core.lesson_mode":{defaultvalue:this.def[t]["cmi.core.lesson_mode"],mod:"r",writeerror:"403"},"cmi.core.exit":{defaultvalue:this.def[t]["cmi.core.exit"],format:"^time-out$|^suspend$|^logout$|^$",mod:"w",readerror:"404",writeerror:"405"},"cmi.core.session_time":{format:T,mod:"w",defaultvalue:"00:00:00",readerror:"404",writeerror:"405"},"cmi.suspend_data":{defaultvalue:this.def[t]["cmi.suspend_data"],format:M,mod:"rw",writeerror:"405"},"cmi.launch_data":{defaultvalue:this.def[t]["cmi.launch_data"],mod:"r",writeerror:"403"},"cmi.comments":{defaultvalue:this.def[t]["cmi.comments"],format:M,mod:"rw",writeerror:"405"},"cmi.evaluation.comments._count":{defaultvalue:"0",mod:"r",writeerror:"402"},"cmi.evaluation.comments._children":{defaultvalue:"content,location,time",mod:"r",writeerror:"402"},"cmi.evaluation.comments.n.content":{defaultvalue:"",pattern:x,format:C,mod:"rw",writeerror:"405"},"cmi.evaluation.comments.n.location":{defaultvalue:"",pattern:x,format:C,mod:"rw",writeerror:"405"},"cmi.evaluation.comments.n.time":{defaultvalue:"",pattern:x,format:D,mod:"rw",writeerror:"405"},"cmi.comments_from_lms":{mod:"r",writeerror:"403"},"cmi.objectives._children":{defaultvalue:"id,score,status",mod:"r",writeerror:"402"},"cmi.objectives._count":{mod:"r",defaultvalue:"0",writeerror:"402"},"cmi.objectives.n.id":{pattern:x,format:A,mod:"rw",writeerror:"405"},"cmi.objectives.n.score._children":{pattern:x,mod:"r",writeerror:"402"},"cmi.objectives.n.score.raw":{defaultvalue:"",pattern:x,format:P,range:N,mod:"rw",writeerror:"405"},"cmi.objectives.n.score.min":{defaultvalue:"",pattern:x,format:P,range:N,mod:"rw",writeerror:"405"},"cmi.objectives.n.score.max":{defaultvalue:"",pattern:x,format:P,range:N,mod:"rw",writeerror:"405"},"cmi.objectives.n.status":{pattern:x,format:"^passed$|^completed$|^failed$|^incomplete$|^browsed$|^not attempted$",mod:"rw",writeerror:"405"},"cmi.student_data._children":{defaultvalue:"mastery_score,max_time_allowed,time_limit_action",mod:"r",writeerror:"402"},"cmi.student_data.mastery_score":{defaultvalue:this.def[t]["cmi.student_data.mastery_score"],mod:"r",writeerror:"403"},"cmi.student_data.max_time_allowed":{defaultvalue:this.def[t]["cmi.student_data.max_time_allowed"],mod:"r",writeerror:"403"},"cmi.student_data.time_limit_action":{defaultvalue:this.def[t]["cmi.student_data.time_limit_action"],mod:"r",writeerror:"403"},"cmi.student_preference._children":{defaultvalue:"audio,language,speed,text",mod:"r",writeerror:"402"},"cmi.student_preference.audio":{defaultvalue:this.def[t]["cmi.student_preference.audio"],format:O,range:"-1#100",mod:"rw",writeerror:"405"},"cmi.student_preference.language":{defaultvalue:this.def[t]["cmi.student_preference.language"],format:C,mod:"rw",writeerror:"405"},"cmi.student_preference.speed":{defaultvalue:this.def[t]["cmi.student_preference.speed"],format:O,range:"-100#100",mod:"rw",writeerror:"405"},"cmi.student_preference.text":{defaultvalue:this.def[t]["cmi.student_preference.text"],format:O,range:"-1#1",mod:"rw",writeerror:"405"},"cmi.interactions._children":{defaultvalue:"id,objectives,time,type,correct_responses,weighting,student_response,result,latency",mod:"r",writeerror:"402"},"cmi.interactions._count":{mod:"r",defaultvalue:"0",writeerror:"402"},"cmi.interactions.n.id":{pattern:x,format:A,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.objectives._count":{pattern:x,mod:"r",defaultvalue:"0",writeerror:"402"},"cmi.interactions.n.objectives.n.id":{pattern:x,format:A,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.time":{pattern:x,format:D,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.type":{pattern:x,format:"^true-false$|^choice$|^fill-in$|^matching$|^performance$|^sequencing$|^likert$|^numeric$",mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.correct_responses._count":{pattern:x,mod:"r",defaultvalue:"0",writeerror:"402"},"cmi.interactions.n.correct_responses.n.pattern":{pattern:x,format:L,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.weighting":{pattern:x,format:P,range:"-100#100",mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.student_response":{pattern:x,format:L,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.result":{pattern:x,format:"^correct$|^wrong$|^unanticipated$|^neutral$|^([0-9]{0,3})?(.[0-9]*)?$",mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.latency":{pattern:x,format:T,mod:"w",readerror:"404",writeerror:"405"},"nav.event":{defaultvalue:"",format:"^previous$|^continue$",mod:"w",readerror:"404",writeerror:"405"}},this.currentUserData[t]={scoid:Number(t),userdata:{},defaultdata:{}};for(const e in this.dataModel[t])if(null===e.match(/\.n\./)){const o=this.dataModel[t][e].defaultvalue;void 0!==o&&(this.currentUserData[t].userdata[e]=o)}for(const e in this.def[t])if(null===e.match(/\.n\./)){const o=this.dataModel[t][e].defaultvalue;this.currentUserData[t].userdata[e]=void 0!==o?o:void 0!==this.defExtra[t][e]?this.defExtra[t][e]:""}const a=new RegExp(x,"g");for(const d in this.defExtra[t]){let l="",m="0";if(d.match(a)){const u=d.replace(a,".$1.");if(this.currentUserData[t].userdata[u]=this.defExtra[t][d],0===u.indexOf("cmi.evaluation.comments"))l="cmi.evaluation.comments._count",m=(null===(e=u.match(/.(\d+)./))||void 0===e?void 0:e[1])||"0";else if(0===u.indexOf("cmi.objectives"))l="cmi.objectives._count",m=(null===(o=u.match(/.(\d+)./))||void 0===o?void 0:o[1])||"0";else if(0===u.indexOf("cmi.interactions"))if(u.indexOf(".objectives.")>0){const t=null===(i=u.match(/cmi.interactions.(\d+)./))||void 0===i?void 0:i[1];m=(null===(r=u.match(/objectives.(\d+)./))||void 0===r?void 0:r[1])||"0",l="cmi.interactions."+t+".objectives._count"}else if(u.indexOf(".correct_responses.")>0){const t=null===(n=u.match(/cmi.interactions.(\d+)./))||void 0===n?void 0:n[1];m=(null===(s=u.match(/correct_responses.(\d+)./))||void 0===s?void 0:s[1])||"0",l="cmi.interactions."+t+".correct_responses._count"}else l="cmi.interactions._count",m=(null===(c=u.match(/.(\d+)./))||void 0===c?void 0:c[1])||"0";if(l){const e=this.currentUserData[t].userdata[l];void 0===e&&(this.currentUserData[t].userdata[l]=0),Number(m)==Number(e)&&(this.currentUserData[t].userdata[l]=Number(e)+1),Number(m)>Number(e)&&(this.currentUserData[t].userdata[l]=Number(m)-1)}}}""===this.currentUserData[t].userdata["cmi.core.lesson_status"]&&(this.currentUserData[t].userdata["cmi.core.lesson_status"]="not attempted"),this.currentUserData[t].userdata["cmi.core.credit"]=this.mode==y.b.MODENORMAL?"credit":"no-credit",this.currentUserData[t].userdata["cmi.core.lesson_mode"]=this.mode}}LMSCommit(t){if(this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.errorCode="0",""==t){if(this.initialized){const t=this.storeData(!1);return this.triggerEvent(y.b.UPDATE_TOC_EVENT),this.errorCode=t?"0":"101",t?"true":"false"}this.errorCode="301"}else this.errorCode="201";return"false"}LMSFinish(t){if(this.errorCode="0",""==t){if(this.initialized){this.initialized=!1;const t=this.storeData(!0);return""!=this.getEl("nav.event")?"continue"==this.getEl("nav.event")?this.triggerEvent(y.b.LAUNCH_NEXT_SCO_EVENT):this.triggerEvent(y.b.LAUNCH_PREV_SCO_EVENT):this.scorm.auto&&this.triggerEvent(y.b.LAUNCH_NEXT_SCO_EVENT),this.errorCode=t?"0":"101",this.triggerEvent(y.b.UPDATE_TOC_EVENT),t?"true":"false"}this.errorCode="301"}else this.errorCode="201";return"false"}LMSGetDiagnostic(t){return""==t&&(t=this.errorCode),t}LMSGetErrorString(t){return""!=t?U[t]:""}LMSGetLastError(){return this.errorCode}LMSGetValue(t){if(this.errorCode="0",this.initialized)if(""!=t){const e=new RegExp(x,"g"),o=String(t).replace(e,".n.");if(void 0!==this.dataModel[this.scoId][o]){if("w"!=this.dataModel[this.scoId][o].mod)return this.errorCode="0",this.getEl(t);this.errorCode=this.dataModel[this.scoId][o].readerror||"0"}else{const t="._children",e="._count";if(o.substring(o.length-t.length)==t){const e=o.substring(0,o.length-t.length);this.errorCode=void 0!==this.dataModel[this.scoId][e]?"202":"201"}else if(o.substring(o.length-e.length)==e){const t=o.substring(0,o.length-e.length);this.errorCode=void 0!==this.dataModel[this.scoId][t]?"203":"201"}else this.errorCode="201"}}else this.errorCode="201";else this.errorCode="301";return""}LMSInitialize(t){if(this.errorCode="0",""==t){if(!this.initialized)return this.initialized=!0,this.errorCode="0","true";this.errorCode="101"}else this.errorCode="201";return"false"}LMSSetValue(t,e){var o,i,r;if(this.errorCode="0",this.initialized)if(""!=t){let n=new RegExp(x,"g");const s=String(t).replace(n,".n.");if(void 0!==this.dataModel[this.scoId][s])if("r"!=this.dataModel[this.scoId][s].mod){n=new RegExp(null!==(o=this.dataModel[this.scoId][s].format)&&void 0!==o?o:"");if(null!=(e+="").match(n)){if(t!=s){if(0===t.indexOf("cmi.objectives")){const e="cmi.objectives."+(null===(i=t.match(/cmi.objectives.(\d+)./))||void 0===i?void 0:i[1])+".score";void 0===this.currentUserData[this.scoId].userdata[e+"._children"]&&(this.setEl(this.currentUserData[this.scoId].userdata[e+"._children"],k),this.setEl(this.currentUserData[this.scoId].userdata[e+".raw"],""),this.setEl(this.currentUserData[this.scoId].userdata[e+".min"],""),this.setEl(this.currentUserData[this.scoId].userdata[e+".max"],""))}else if(0===t.indexOf("cmi.interactions")){const e=null===(r=t.match(/cmi.interactions.(\d+)./))||void 0===r?void 0:r[1];let o="cmi.interactions."+e+".objectives._count";void 0===this.currentUserData[this.scoId].userdata[o]&&this.setEl(o,0),o="cmi.interactions."+e+".correct_responses._count",void 0===this.currentUserData[this.scoId].userdata[o]&&this.setEl(o,0)}const e=t.split(".");let o="cmi";for(let t=1;t<e.length-1;t++){const i=e[t];if(e[t+1].match(/^\d+$/)){const r=o+"."+i+"._count";if(void 0===this.currentUserData[this.scoId].userdata[r]&&this.setEl(r,0),e[t+1]==this.getEl(r)){const t=this.getEl(r);this.setEl(r,Number(t)+1)}e[t+1]>this.getEl(r)&&(this.errorCode="201"),o=o.concat("."+i+"."+e[t+1]),t++}else o=o.concat("."+i)}t=o.concat("."+e[e.length-1])}if("0"==this.errorCode){this.scorm.autocommit&&!this.timeout&&(this.timeout=window.setTimeout((()=>this.LMSCommit("")),6e4));const o=this.dataModel[this.scoId][s].range;if(void 0===o)return"cmi.comments"==t?this.setEl("cmi.comments",this.getEl("cmi.comments")+e):this.setEl(t,e),this.errorCode="0","true";{const i=o.split("#");if((e=Number(e))>=Number(i[0])&&e<=Number(i[1]))return this.setEl(t,Number(e)),this.errorCode="0","true";this.errorCode=this.dataModel[this.scoId][s].writeerror}}}else this.errorCode=this.dataModel[this.scoId][s].writeerror}else this.errorCode=this.dataModel[this.scoId][s].writeerror;else this.errorCode="201"}else this.errorCode="201";else this.errorCode="301";return"false"}loadSco(t){this.scoId=t}setEl(t,e){this.currentUserData[this.scoId]=this.currentUserData[this.scoId]||{scoid:this.scoId,userdata:{},defaultdata:{}},this.currentUserData[this.scoId].userdata[t]=e}setOffline(t){this.offline=t}storeData(t){if(!this.canSaveTracks)return!0;let e;t?("not attempted"==this.getEl("cmi.core.lesson_status")&&this.setEl("cmi.core.lesson_status","completed"),this.getEl("cmi.core.lesson_mode")==y.b.MODENORMAL&&"credit"==this.getEl("cmi.core.credit")&&""!==this.getEl("cmi.student_data.mastery_score")&&""!==this.getEl("cmi.core.score.raw")&&(parseFloat(this.getEl("cmi.core.score.raw"))>=parseFloat(this.getEl("cmi.student_data.mastery_score"))?this.setEl("cmi.core.lesson_status","passed"):this.setEl("cmi.core.lesson_status","failed")),this.getEl("cmi.core.lesson_mode")==y.b.MODEBROWSE&&""==this.dataModel[this.scoId]["cmi.core.lesson_status"].defaultvalue&&"not attempted"==this.getEl("cmi.core.lesson_status")&&this.setEl("cmi.core.lesson_status","browsed"),e=this.collectData(),e.push(this.totalTime())):e=this.collectData();const o=y.a.saveTracksSync(this.scoId,this.attempt,e,this.scorm,this.offline,this.currentUserData);return this.offline||o?o:(this.offline=!0,this.triggerEvent(y.b.GO_OFFLINE_EVENT),y.a.saveTracksSync(this.scoId,this.attempt,e,this.scorm,this.offline,this.currentUserData))}totalTime(){return{element:"cmi.core.total_time",value:this.addTime(this.getEl("cmi.core.total_time"),this.getEl("cmi.core.session_time"))}}triggerEvent(t){E.b.trigger(t,{scormId:this.scorm.id,scoId:this.scoId,attempt:this.attempt},this.siteId)}}var z=o("8ykv"),V=o("pisK"),$=o("G82x"),F=o("D7J2"),j=o("tVmb"),R=o("ofXK"),q=o("PgjG"),H=o("3zv0"),Q=o("ACYt"),G=o("3CSS"),W=o("qNqN"),X=o("/BoF"),B=o("3jOR");function AddonModScormPlayerPage_core_button_with_spinner_9_ion_button_1_Template(t,e){if(1&t){const t=d.Fc();d.Ec(0,"ion-button",11),d.Mc("click",(function AddonModScormPlayerPage_core_button_with_spinner_9_ion_button_1_Template_ion_button_click_0_listener(){d.fd(t);return d.Oc(2).openToc()})),d.Pc(1,"translate"),d.zc(2,"ion-icon",12),d.Dc()}2&t&&d.mc("aria-label",d.Qc(1,1,"addon.mod_scorm.toc"))}function AddonModScormPlayerPage_core_button_with_spinner_9_Template(t,e){if(1&t&&(d.Ec(0,"core-button-with-spinner",9),d.nd(1,AddonModScormPlayerPage_core_button_with_spinner_9_ion_button_1_Template,3,3,"ion-button",10),d.Dc()),2&t){const t=d.Oc();d.Vc("loading",t.loadingToc),d.lc(1),d.Vc("ngIf",t.toc.length)}}function AddonModScormPlayerPage_core_iframe_12_Template(t,e){if(1&t&&d.zc(0,"core-iframe",13),2&t){const t=d.Oc();d.Vc("src",t.src)("iframeWidth",t.scormWidth)("iframeHeight",t.scormHeight)("showFullscreenOnToolbar",!0)("autoFullscreenOnRotate",!0)}}function AddonModScormPlayerPage_p_13_Template(t,e){if(1&t&&(d.Ec(0,"p"),d.pd(1),d.Pc(2,"translate"),d.Dc()),2&t){const t=d.Oc();d.lc(1),d.qd(d.Qc(2,1,t.errorMessage))}}function AddonModScormPlayerPage_core_navigation_bar_14_Template(t,e){if(1&t){const t=d.Fc();d.Ec(0,"core-navigation-bar",14),d.Mc("action",(function AddonModScormPlayerPage_core_navigation_bar_14_Template_core_navigation_bar_action_0_listener(e){d.fd(t);return d.Oc().loadSco(e)})),d.Dc()}if(2&t){const t=d.Oc();d.Vc("items",t.navigationItems)}}let J=(()=>{class AddonModScormPlayerPage{constructor(t){this.mainMenuPage=t,this.showToc=!1,this.loadingToc=!0,this.toc=[],this.loaded=!1,this.incomplete=!1,this.navigationItems=[],this.newAttempt=!1,this.attempt=0,this.offline=!1}ngOnInit(){return Object(g.a)(this,void 0,void 0,(function*(){try{this.cmId=c.a.getRequiredRouteNumberParam("cmId"),this.courseId=c.a.getRequiredRouteNumberParam("courseId"),this.mode=c.a.getRouteParam("mode")||y.b.MODENORMAL,this.moduleUrl=c.a.getRouteParam("moduleUrl")||"",this.newAttempt=!!c.a.getRouteBooleanParam("newAttempt"),this.organizationId=c.a.getRouteParam("organizationId"),this.initialScoId=c.a.getRouteNumberParam("scoId"),this.siteId=v.b.getRequiredCurrentSite().getId()}catch(t){return I.a.showErrorModal(t),c.a.back(),void 0}try{if(yield this.fetchData(),!this.currentSco)return c.a.back(),void 0;if(this.newAttempt)try{yield this.setStartTime(this.currentSco.id)}catch(t){I.a.showErrorModalDefault(t,"addon.mod_scorm.errorgetscorm",!0)}this.loadSco(this.currentSco)}finally{this.loaded=!0}}))}get canSaveTracks(){return!this.accessInfo||!!this.accessInfo.cansavetrack}initialize(){return Object(g.a)(this,void 0,void 0,(function*(){this.scorm=yield y.a.getScorm(this.courseId,this.cmId,{moduleUrl:this.moduleUrl,readingStrategy:1}),b.a.blockOperation(y.b.COMPONENT,this.scorm.id,"player"),this.title=this.scorm.name,this.showToc=y.a.displayTocInPlayer(this.scorm),this.scorm.popup&&this.scorm.width&&this.scorm.width>100&&(this.scormWidth=this.scorm.width,this.scorm.height&&this.scorm.height>100&&(this.scormHeight=this.scorm.height)),this.tocObserver=E.b.on(y.b.UPDATE_TOC_EVENT,(t=>{t.scormId===this.scorm.id&&(this.offline?setTimeout((()=>this.refreshToc()),100):this.refreshToc())}),this.siteId),this.launchNextObserver=E.b.on(y.b.LAUNCH_NEXT_SCO_EVENT,(t=>{if(t.scormId===this.scorm.id&&this.currentSco){const t=V.a.getNextScoFromToc(this.toc,this.currentSco.id);t&&this.loadSco(t)}}),this.siteId),this.launchPrevObserver=E.b.on(y.b.LAUNCH_PREV_SCO_EVENT,(t=>{if(t.scormId===this.scorm.id&&this.currentSco){const t=V.a.getPreviousScoFromToc(this.toc,this.currentSco.id);t&&this.loadSco(t)}}),this.siteId),this.goOfflineObserver=E.b.on(y.b.GO_OFFLINE_EVENT,(t=>{t.scormId!==this.scorm.id||this.offline||(this.offline=!0,setTimeout((()=>Object(g.a)(this,void 0,void 0,(function*(){try{V.a.convertAttemptToOffline(this.scorm,this.attempt)}catch(t){I.a.showErrorModalDefault(t,"core.error",!0)}this.refreshToc()}))),200))}),this.siteId)}))}calculateNavigationItems(t){this.navigationItems=this.toc.filter((t=>t.isvisible)).map((e=>({item:e,title:e.title,current:e.id==t,enabled:!(!e.prereq||!e.launch)})))}determineAttemptAndMode(t,e){return Object(g.a)(this,void 0,void 0,(function*(){const o=yield V.a.determineAttemptToContinue(this.scorm,t);let i=!1;this.attempt=o.num,this.offline=o.offline,this.attempt!=t.lastAttempt.num&&(this.attemptToContinue=this.attempt),this.attempt>0&&(i=yield y.a.isAttemptIncomplete(this.scorm.id,this.attempt,{offline:this.offline,cmId:this.cmId}));const r=y.a.determineAttemptAndMode(this.scorm,this.mode,this.attempt,this.newAttempt,i,e.cansavetrack);if(r.attempt>this.attempt)if(this.offline)yield V.a.createOfflineAttempt(this.scorm,r.attempt,t.online.length);else try{yield y.a.getScormUserData(this.scorm.id,r.attempt,{cmId:this.cmId,readingStrategy:2})}catch(e){this.offline=!0,yield V.a.createOfflineAttempt(this.scorm,r.attempt,t.online.length)}this.mode=r.mode,this.newAttempt=r.newAttempt,this.attempt=r.attempt}))}fetchData(){return Object(g.a)(this,void 0,void 0,(function*(){this.scorm||(yield this.initialize()),yield $.a.waitForSync(this.scorm.id);try{const[t,e]=yield Promise.all([y.a.getAttemptCount(this.scorm.id,{cmId:this.cmId}),y.a.getAccessInformation(this.scorm.id,{cmId:this.cmId})]);this.accessInfo=e,yield this.determineAttemptAndMode(t,e);const[o]=yield Promise.all([y.a.getScormUserData(this.scorm.id,this.attempt,{cmId:this.cmId,offline:this.offline}),this.fetchToc()]);this.userData=o}catch(t){I.a.showErrorModalDefault(t,"addon.mod_scorm.errorgetscorm",!0)}}))}fetchToc(){return Object(g.a)(this,void 0,void 0,(function*(){this.loadingToc=!0;try{if(this.incomplete=yield y.a.isAttemptIncomplete(this.scorm.id,this.attempt,{offline:this.offline,cmId:this.cmId}),this.toc=yield V.a.getToc(this.scorm.id,this.attempt,this.incomplete,{organization:this.organizationId,offline:this.offline,cmId:this.cmId}),this.currentSco)return;if(this.newAttempt&&(this.initialScoId=this.scorm.launch),this.initialScoId&&this.initialScoId>0&&(this.currentSco=V.a.getScoFromToc(this.toc,this.initialScoId)),this.currentSco)return;const t=yield V.a.getFirstSco(this.scorm.id,this.attempt,{toc:this.toc,organization:this.organizationId,mode:this.mode,offline:this.offline,cmId:this.cmId});t?this.currentSco=t:this.errorMessage="addon.mod_scorm.errornovalidsco"}finally{this.loadingToc=!1}}))}loadSco(t){var e;return Object(g.a)(this,void 0,void 0,(function*(){this.dataModel?this.dataModel.loadSco(t.id):(this.dataModel=new data_model_12_AddonModScormDataModel12(this.siteId,this.scorm,t.id,this.attempt,null!==(e=this.userData)&&void 0!==e?e:{},this.mode,this.offline,this.canSaveTracks),window.API=this.dataModel),this.currentSco=t,this.title=t.title||this.scorm.name,this.calculateNavigationItems(t.id),this.loadScoSrc(t),"asset"==t.scormtype&&this.markCompleted(t),this.logEvent(t.id)}))}loadScoSrc(t){return Object(g.a)(this,void 0,void 0,(function*(){const e=yield y.a.getScoSrc(this.scorm,t);e==this.src&&(this.src="",yield w.a.nextTick()),this.src=e}))}markCompleted(t){var e;return Object(g.a)(this,void 0,void 0,(function*(){if(!this.canSaveTracks)return;const o=[{element:"cmi.core.lesson_status",value:"completed"}];try{y.a.saveTracks(t.id,this.attempt,o,this.scorm,this.offline)}catch(i){if(this.offline)return;const r=yield y.a.getScormUserData(this.scorm.id,this.attempt,{cmId:this.cmId});if(r[t.id]&&"completed"==r[t.id].userdata["cmi.core.lesson_status"])return;try{yield V.a.convertAttemptToOffline(this.scorm,this.attempt),this.offline=!0,null===(e=this.dataModel)||void 0===e||e.setOffline(!0),yield y.a.saveTracks(t.id,this.attempt,o,this.scorm,!0)}catch(t){I.a.showErrorModalDefault(t,"core.error",!0)}}finally{this.refreshToc()}}))}openToc(){return Object(g.a)(this,void 0,void 0,(function*(){const t=yield I.a.openSideModal({component:z.a,componentProps:{toc:this.toc,attemptToContinue:this.attemptToContinue,selected:this.currentSco&&this.currentSco.id,moduleId:this.cmId,courseId:this.courseId,accessInfo:this.accessInfo,mode:this.mode}});t&&this.loadSco(t)}))}refreshToc(){return Object(g.a)(this,void 0,void 0,(function*(){try{yield w.a.ignoreErrors(y.a.invalidateAllScormData(this.scorm.id)),yield this.fetchToc()}catch(t){I.a.showErrorModalDefault(t,"addon.mod_scorm.errorgetscorm",!0)}}))}setStartTime(t){return Object(g.a)(this,void 0,void 0,(function*(){if(!this.canSaveTracks)return;const e=[{element:"x.start.time",value:String(S.a.timestamp())}];yield y.a.saveTracks(t,this.attempt,e,this.scorm,this.offline),this.offline||(yield w.a.ignoreErrors(y.a.getAttemptCount(this.scorm.id,{cmId:this.cmId,readingStrategy:2})))}))}logEvent(t){return Object(g.a)(this,void 0,void 0,(function*(){yield w.a.ignoreErrors(y.a.logLaunchSco(this.scorm.id,t));let e="/mod/scorm/player.php";this.scorm.popup&&(e+=`?a=${this.scorm.id}&currentorg=${this.organizationId}&scoid=${t}&display=popup&mode=${this.mode}`),F.a.logEvent({type:F.b.VIEW_ITEM,ws:"mod_scorm_get_scorm_user_data",name:this.scorm.name,data:{id:this.scorm.id,scoid:t,organization:this.organizationId,category:"scorm"},url:e})}))}ngOnDestroy(){var t,e,o;this.src="",E.b.trigger(E.b.ACTIVITY_DATA_SENT,{module:"scorm"}),null===(t=this.tocObserver)||void 0===t||t.off(),null===(e=this.launchNextObserver)||void 0===e||e.off(),null===(o=this.launchPrevObserver)||void 0===o||o.off(),setTimeout((()=>{var t;null===(t=this.goOfflineObserver)||void 0===t?void 0:t.off()}),500),b.a.unblockOperation(y.b.COMPONENT,this.scorm.id,"player")}}return AddonModScormPlayerPage.ɵfac=function AddonModScormPlayerPage_Factory(t){return new(t||AddonModScormPlayerPage)(d.yc(j.a))},AddonModScormPlayerPage.ɵcmp=d.sc({type:AddonModScormPlayerPage,selectors:[["page-addon-mod-scorm-player"]],decls:15,vars:11,consts:[["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["slot","end"],[3,"loading",4,"ngIf"],[3,"hideUntil"],[3,"src","iframeWidth","iframeHeight","showFullscreenOnToolbar","autoFullscreenOnRotate",4,"ngIf"],[4,"ngIf"],["collapsible-footer","","appearOnBottom","","slot","fixed",3,"items","action",4,"ngIf"],[3,"loading"],["fill","clear","aria-haspopup","true",3,"click",4,"ngIf"],["fill","clear","aria-haspopup","true",3,"click"],["name","fas-bookmark","slot","icon-only","aria-hidden","true"],[3,"src","iframeWidth","iframeHeight","showFullscreenOnToolbar","autoFullscreenOnRotate"],["collapsible-footer","","appearOnBottom","","slot","fixed",3,"items","action"]],template:function AddonModScormPlayerPage_Template(t,e){1&t&&(d.Ec(0,"ion-header"),d.Ec(1,"ion-toolbar"),d.Ec(2,"ion-buttons",0),d.zc(3,"ion-back-button",1),d.Pc(4,"translate"),d.Dc(),d.Ec(5,"ion-title"),d.Ec(6,"h1"),d.zc(7,"core-format-text",2),d.Dc(),d.Dc(),d.Ec(8,"ion-buttons",3),d.nd(9,AddonModScormPlayerPage_core_button_with_spinner_9_Template,2,2,"core-button-with-spinner",4),d.Dc(),d.Dc(),d.Dc(),d.Ec(10,"ion-content"),d.Ec(11,"core-loading",5),d.nd(12,AddonModScormPlayerPage_core_iframe_12_Template,1,5,"core-iframe",6),d.nd(13,AddonModScormPlayerPage_p_13_Template,3,3,"p",7),d.Dc(),d.nd(14,AddonModScormPlayerPage_core_navigation_bar_14_Template,1,1,"core-navigation-bar",8),d.Dc()),2&t&&(d.lc(3),d.Vc("text",d.Qc(4,9,"core.back")),d.lc(4),d.Vc("text",e.title)("contextInstanceId",e.cmId)("courseId",e.courseId),d.lc(2),d.Vc("ngIf",e.showToc),d.lc(2),d.Vc("hideUntil",e.loaded),d.lc(1),d.Vc("ngIf",e.loaded&&e.src),d.lc(1),d.Vc("ngIf",!e.src&&e.errorMessage),d.lc(1),d.Vc("ngIf",e.loaded&&e.navigationItems.length>1))},directives:[l.C,l.Ab,l.m,l.h,l.i,l.yb,u.a,R.t,h.a,l.v,q.a,H.a,Q.a,l.l,l.D,G.a,W.a,X.a,B.a],pipes:[f.d],encapsulation:2}),AddonModScormPlayerPage})();const Y=[{path:":courseId/:cmId",component:_},{path:":courseId/:cmId/player",component:J}];let K=(()=>{class AddonModScormLazyModule{}return AddonModScormLazyModule.ɵmod=d.wc({type:AddonModScormLazyModule}),AddonModScormLazyModule.ɵinj=d.vc({factory:function AddonModScormLazyModule_Factory(t){return new(t||AddonModScormLazyModule)},imports:[[i.m.forChild(Y),r.a,n.a]]}),AddonModScormLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&d.kd(K,{declarations:[_,J],imports:[i.m,r.a,n.a]}))}}]);