(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{eoiU:function(e,o,s){"use strict";s.d(o,"a",(function(){return CoreSwipeNavigationItemsManager}));var i=s("mrSG"),n=s("pHTc"),t=s("CtbY");class CoreSwipeNavigationItemsManager extends t.a{start(){return Object(i.a)(this,void 0,void 0,(function*(){this.updateSelectedItem()}))}navigateToNextItem(){return Object(i.a)(this,void 0,void 0,(function*(){yield this.navigateToItemBy(1,"forward")}))}navigateToPreviousItem(){return Object(i.a)(this,void 0,void 0,(function*(){yield this.navigateToItemBy(-1,"back")}))}hasNextItem(){return Object(i.a)(this,void 0,void 0,(function*(){return!!(yield this.getItemBy(1))}))}hasPreviousItem(){return Object(i.a)(this,void 0,void 0,(function*(){return!!(yield this.getItemBy(-1))}))}getCurrentPageRoute(){return n.a.getCurrentRoute()}getSelectedItemPathFromRoute(e){const o=[];for(;e&&(o.push(...e.url),e.firstChild);)e=e.firstChild;return o.map((e=>e.path)).join("/").replace(/\/+/,"/").trim()||null}navigateToItemBy(e,o){return Object(i.a)(this,void 0,void 0,(function*(){const s=yield this.getItemBy(e);s&&(yield this.navigateToItem(s,{animationDirection:o,replace:!0}))}))}getItemBy(e){var o;return Object(i.a)(this,void 0,void 0,(function*(){const s=this.getSource().getItems(),i=null!==(o=this.selectedItem&&(null==s?void 0:s.indexOf(this.selectedItem)))&&void 0!==o?o:-1;if(-1===i||null===s)return null;const n=e>0?1:-1;let t=i,c=0;for(;c!==e;){if(t+=n,t<0)return null;if(t>=s.length)break;this.skipItemInSwipe(s[t])||(c+=n)}return c===e?s[t]:this.getSource().isCompleted()?null:(yield this.getSource().load(),this.getItemBy(e))}))}skipItemInSwipe(e){return!1}}},uSYB:function(e,o,s){"use strict";s.r(o),s.d(o,"AddonForumNewDiscussionLazyModule",(function(){return H}));var i=s("tyNb"),n=s("AzLI"),t=s("MLi9"),c=s("ekpb"),d=s("L3Fv"),a=s("mrSG"),r=s("3Pt+"),u=s("fjkH"),l=s("mWdr"),m=s("pHTc"),h=s("ZCW2"),g=s("N5Lt"),p=s("pET4"),f=s("9+EE"),_=s("3LXp"),w=s("j3ag"),D=s("uT8i"),I=s("h709"),b=s("bFG1"),v=s("VF9H"),M=s("hSQQ"),P=s("vuGA"),A=s("4reR"),y=s("nFEd"),O=s("LVzu"),C=s("baaQ"),E=s("8vmT"),N=s("D7J2"),T=s("fXoL"),F=s("46ml"),S=s("TEn/"),G=s("nt/U"),x=s("OZH1"),V=s("PgjG"),j=s("ofXK"),L=s("3CSS"),k=s("ACYt"),R=s("hMzs"),z=s("M9y5"),Q=s("sYmb");const q=["newDiscFormEl"];function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_1_Template(e,o){if(1&e){const e=T.Fc();T.Ec(0,"ion-item"),T.Ec(1,"ion-label"),T.pd(2),T.Pc(3,"translate"),T.Dc(),T.Ec(4,"ion-toggle",22),T.Mc("ngModelChange",(function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_1_Template_ion_toggle_ngModelChange_4_listener(o){T.fd(e);return T.Oc(3).newDiscussion.postToAllGroups=o})),T.Dc(),T.Dc()}if(2&e){const e=T.Oc(3);T.lc(2),T.qd(T.Qc(3,2,"addon.mod_forum.posttomygroups")),T.lc(2),T.Vc("ngModel",e.newDiscussion.postToAllGroups)}}function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_2_ion_select_option_7_Template(e,o){if(1&e&&(T.Ec(0,"ion-select-option",26),T.zc(1,"core-format-text",27),T.Dc()),2&e){const e=o.$implicit,s=T.Oc(4);T.Vc("value",e.id),T.lc(1),T.Vc("text",e.name)("contextInstanceId",s.courseId)("wsNotFiltered",!0)}}const _c1=function(e){return{header:e}};function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_2_Template(e,o){if(1&e){const e=T.Fc();T.Ec(0,"ion-item",23),T.Ec(1,"ion-label"),T.pd(2),T.Pc(3,"translate"),T.Dc(),T.Ec(4,"ion-select",24),T.Mc("ngModelChange",(function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_2_Template_ion_select_ngModelChange_4_listener(o){T.fd(e);return T.Oc(3).newDiscussion.groupId=o}))("ionChange",(function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_2_Template_ion_select_ionChange_4_listener(){T.fd(e);return T.Oc(3).calculateGroupName()})),T.Pc(5,"translate"),T.Pc(6,"translate"),T.nd(7,AddonModForumNewDiscussionPage_form_15_div_21_ion_item_2_ion_select_option_7_Template,2,4,"ion-select-option",25),T.Dc(),T.Dc()}if(2&e){const e=T.Oc(3);T.lc(2),T.qd(T.Qc(3,6,"addon.mod_forum.group")),T.lc(2),T.Vc("ngModel",e.newDiscussion.groupId)("disabled",e.newDiscussion.postToAllGroups)("interfaceOptions",T.ad(12,_c1,T.Qc(5,8,"addon.mod_forum.group")))("cancelText",T.Qc(6,10,"core.cancel")),T.lc(3),T.Vc("ngForOf",e.groups)}}function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_8_Template(e,o){if(1&e){const e=T.Fc();T.Ec(0,"ion-item"),T.Ec(1,"ion-label"),T.pd(2),T.Pc(3,"translate"),T.Dc(),T.Ec(4,"ion-toggle",28),T.Mc("ngModelChange",(function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_8_Template_ion_toggle_ngModelChange_4_listener(o){T.fd(e);return T.Oc(3).newDiscussion.pin=o})),T.Dc(),T.Dc()}if(2&e){const e=T.Oc(3);T.lc(2),T.qd(T.Qc(3,2,"addon.mod_forum.discussionpinned")),T.lc(2),T.Vc("ngModel",e.newDiscussion.pin)}}function AddonModForumNewDiscussionPage_form_15_div_21_core_attachments_9_Template(e,o){if(1&e&&T.zc(0,"core-attachments",29),2&e){const e=T.Oc(3);T.Vc("files",e.newDiscussion.files)("maxSize",e.forum.maxbytes)("maxSubmissions",e.forum.maxattachments)("component",e.component)("componentId",e.forum.cmid)("allowOffline",!0)("courseId",e.courseId)}}function AddonModForumNewDiscussionPage_form_15_div_21_Template(e,o){if(1&e){const e=T.Fc();T.Ec(0,"div",18),T.nd(1,AddonModForumNewDiscussionPage_form_15_div_21_ion_item_1_Template,5,4,"ion-item",7),T.nd(2,AddonModForumNewDiscussionPage_form_15_div_21_ion_item_2_Template,8,14,"ion-item",19),T.Ec(3,"ion-item"),T.Ec(4,"ion-label"),T.pd(5),T.Pc(6,"translate"),T.Dc(),T.Ec(7,"ion-toggle",20),T.Mc("ngModelChange",(function AddonModForumNewDiscussionPage_form_15_div_21_Template_ion_toggle_ngModelChange_7_listener(o){T.fd(e);return T.Oc(2).newDiscussion.subscribe=o})),T.Dc(),T.Dc(),T.nd(8,AddonModForumNewDiscussionPage_form_15_div_21_ion_item_8_Template,5,4,"ion-item",7),T.nd(9,AddonModForumNewDiscussionPage_form_15_div_21_core_attachments_9_Template,1,7,"core-attachments",21),T.Dc()}if(2&e){const e=T.Oc(2);T.lc(1),T.Vc("ngIf",e.showGroups&&e.groupIds.length>1&&e.accessInfo.cancanposttomygroups),T.lc(1),T.Vc("ngIf",e.showGroups),T.lc(3),T.qd(T.Qc(6,6,"addon.mod_forum.discussionsubscription")),T.lc(2),T.Vc("ngModel",e.newDiscussion.subscribe),T.lc(1),T.Vc("ngIf",e.canPin),T.lc(1),T.Vc("ngIf",e.canCreateAttachments&&e.forum&&e.forum.maxattachments>0)}}function AddonModForumNewDiscussionPage_form_15_ion_item_22_Template(e,o){if(1&e&&(T.Ec(0,"ion-item",30),T.zc(1,"ion-icon",31),T.Ec(2,"ion-label"),T.zc(3,"core-format-text",27),T.Dc(),T.Dc()),2&e){const e=T.Oc(2);T.lc(3),T.Vc("text",e.postInGroupMessage)("contextInstanceId",e.courseId)("wsNotFiltered",!0)}}function AddonModForumNewDiscussionPage_form_15_ion_col_26_Template(e,o){if(1&e){const e=T.Fc();T.Ec(0,"ion-col"),T.Ec(1,"ion-button",32),T.Mc("click",(function AddonModForumNewDiscussionPage_form_15_ion_col_26_Template_ion_button_click_1_listener(){T.fd(e);return T.Oc(2).discard()})),T.pd(2),T.Pc(3,"translate"),T.Dc(),T.Dc()}2&e&&(T.lc(2),T.qd(T.Qc(3,1,"core.discard")))}function AddonModForumNewDiscussionPage_form_15_Template(e,o){if(1&e){const e=T.Fc();T.Ec(0,"form",null,8),T.Ec(2,"ion-item"),T.Ec(3,"ion-label",9),T.pd(4),T.Pc(5,"translate"),T.Dc(),T.Ec(6,"ion-input",10),T.Mc("ngModelChange",(function AddonModForumNewDiscussionPage_form_15_Template_ion_input_ngModelChange_6_listener(o){T.fd(e);return T.Oc().newDiscussion.subject=o})),T.Pc(7,"translate"),T.Dc(),T.Dc(),T.Ec(8,"ion-item"),T.Ec(9,"ion-label",9),T.pd(10),T.Pc(11,"translate"),T.Dc(),T.Ec(12,"core-rich-text-editor",11),T.Mc("contentChanged",(function AddonModForumNewDiscussionPage_form_15_Template_core_rich_text_editor_contentChanged_12_listener(o){T.fd(e);return T.Oc().onMessageChange(o)})),T.Pc(13,"translate"),T.Dc(),T.Dc(),T.Ec(14,"ion-item",12),T.Mc("click",(function AddonModForumNewDiscussionPage_form_15_Template_ion_item_click_14_listener(){T.fd(e);return T.Oc().toggleAdvanced()})),T.Pc(15,"translate"),T.zc(16,"ion-icon",13),T.Ec(17,"ion-label"),T.Ec(18,"h2"),T.pd(19),T.Pc(20,"translate"),T.Dc(),T.Dc(),T.Dc(),T.nd(21,AddonModForumNewDiscussionPage_form_15_div_21_Template,10,8,"div",14),T.nd(22,AddonModForumNewDiscussionPage_form_15_ion_item_22_Template,4,3,"ion-item",15),T.Ec(23,"ion-item",16),T.Ec(24,"ion-label"),T.Ec(25,"ion-row"),T.nd(26,AddonModForumNewDiscussionPage_form_15_ion_col_26_Template,4,3,"ion-col",7),T.Ec(27,"ion-col"),T.Ec(28,"ion-button",17),T.Mc("click",(function AddonModForumNewDiscussionPage_form_15_Template_ion_button_click_28_listener(){T.fd(e);return T.Oc().add()})),T.pd(29),T.Pc(30,"translate"),T.Dc(),T.Dc(),T.Dc(),T.Dc(),T.Dc(),T.Dc()}if(2&e){const e=T.Oc();T.lc(4),T.qd(T.Qc(5,20,"addon.mod_forum.subject")),T.lc(2),T.Vc("ngModel",e.newDiscussion.subject)("placeholder",T.Qc(7,22,"addon.mod_forum.subject")),T.lc(4),T.qd(T.Qc(11,24,"addon.mod_forum.message")),T.lc(2),T.Vc("control",e.messageControl)("placeholder",T.Qc(13,26,"addon.mod_forum.message"))("component",e.component)("componentId",e.forum.cmid)("autoSave",!0)("contextInstanceId",e.forum.cmid),T.lc(2),T.mc("aria-expanded",e.advanced)("aria-label",T.Qc(15,28,e.advanced?"core.hideadvanced":"core.showadvanced")),T.lc(2),T.qc("expandable-status-icon-expanded",e.advanced),T.lc(3),T.qd(T.Qc(20,30,"addon.mod_forum.advanced")),T.lc(2),T.Vc("ngIf",e.advanced),T.lc(1),T.Vc("ngIf",e.showGroups&&e.postInGroupMessage&&!e.newDiscussion.postToAllGroups),T.lc(4),T.Vc("ngIf",e.hasOffline),T.lc(2),T.Vc("disabled",""==e.newDiscussion.subject||null==e.newDiscussion.message),T.lc(1),T.rd(" ",T.Qc(30,32,"addon.mod_forum.posttoforum")," ")}}let B=(()=>{class AddonModForumNewDiscussionPage{constructor(e,o){this.route=e,this.splitView=o,this.component=h.b.COMPONENT,this.messageControl=new r.g,this.groupsLoaded=!1,this.showGroups=!1,this.hasOffline=!1,this.canCreateAttachments=!0,this.canPin=!1,this.showForm=!1,this.groups=[],this.groupIds=[],this.newDiscussion={subject:"",message:null,postToAllGroups:!1,groupId:0,subscribe:!0,pin:!1,files:[]},this.advanced=!1,this.accessInfo={},this.isDestroyed=!1,this.forceLeave=!1,this.logView=E.a.once((()=>{N.a.logEvent({type:N.b.VIEW_ITEM,ws:"mod_forum_add_discussion",name:w.I.instant("addon.mod_forum.addanewdiscussion"),data:{id:this.forumId,category:"forum"},url:"/mod/forum/post.php"})}))}ngOnInit(){var e,o;return Object(a.a)(this,void 0,void 0,(function*(){try{const s=this.route.snapshot.data;if(this.courseId=m.a.getRequiredRouteNumberParam("courseId"),this.cmId=m.a.getRequiredRouteNumberParam("cmId"),this.forumId=m.a.getRequiredRouteNumberParam("forumId"),this.timeCreated=m.a.getRequiredRouteNumberParam("timeCreated"),this.initialGroupId=m.a.getRouteNumberParam("groupId"),this.initialGroupId=0===this.initialGroupId?h.b.ALL_PARTICIPANTS:this.initialGroupId,0!==this.timeCreated&&(null===(e=s.swipeEnabled)||void 0===e||e)){const e=C.a.getOrCreateSource(O.a,[this.courseId,this.cmId,null!==(o=s.discussionsPathPrefix)&&void 0!==o?o:""]);this.discussions=new new_discussion_AddonModForumNewDiscussionDiscussionsSwipeManager(e),yield this.discussions.start()}}catch(e){return _.a.showErrorModal(e),this.goBack(),void 0}this.fetchDiscussionData().finally((()=>{this.groupsLoaded=!0}))}))}ionViewDidEnter(){this.syncObserver||(this.syncObserver=u.b.on(p.b.AUTO_SYNCED,(e=>{e.forumId==this.forumId&&e.userId==f.b.getCurrentSiteUserId()&&(_.a.showAlertTranslated("core.notice","core.contenteditingsynced"),this.returnToDiscussions())}),f.b.getCurrentSiteId()))}fetchDiscussionData(e){return Object(a.a)(this,void 0,void 0,(function*(){try{const o=yield l.a.getActivityGroupMode(this.cmId),s=[];o===l.b.SEPARATEGROUPS||o===l.b.VISIBLEGROUPS?s.push(l.a.instance.getActivityAllowedGroups(this.cmId).then((e=>{let s;return s=o===l.b.VISIBLEGROUPS?this.validateVisibleGroups(e.groups):this.addAllParticipantsOption(e.groups,!0),s.then((e=>Object(a.a)(this,void 0,void 0,(function*(){if(e.length>0)return this.groups=e,this.groupIds=e.map((e=>e.id)).filter((e=>e>0)),this.newDiscussion.groupId=this.newDiscussion.groupId||this.getInitialGroupId(),this.showGroups=!0,yield this.calculateGroupName(),this.groupIds.length<=1&&(this.newDiscussion.postToAllGroups=!1),void 0;throw new Error(w.I.instant(o===l.b.SEPARATEGROUPS?"addon.mod_forum.cannotadddiscussionall":"addon.mod_forum.cannotadddiscussion"))}))))}))):(this.showGroups=!1,this.newDiscussion.postToAllGroups=!1,s.push(b.a.ignoreErrors(h.a.instance.canAddDiscussionToAll(this.forumId,{cmId:this.cmId}).then((e=>{this.canPin=!!e.canpindiscussions,this.canCreateAttachments=!!e.cancreateattachment}))))),s.push(h.a.getForum(this.courseId,this.cmId).then((e=>this.forum=e))),s.push(h.a.instance.getAccessInformation(this.forumId,{cmId:this.cmId}).then((e=>this.accessInfo=e))),yield Promise.all(s),this.timeCreated&&!e&&(this.syncId=p.a.getForumSyncId(this.forumId),yield p.a.waitForSync(this.syncId).then((()=>(this.isDestroyed||D.a.blockOperation(h.b.COMPONENT,this.syncId),I.a.instance.getNewDiscussion(this.forumId,this.timeCreated).then((e=>Object(a.a)(this,void 0,void 0,(function*(){if(this.hasOffline=!0,e.options=e.options||{},e.groupid==h.b.ALL_GROUPS?(this.newDiscussion.groupId=this.groups[0].id,this.newDiscussion.postToAllGroups=!0):(this.newDiscussion.groupId=e.groupid,this.newDiscussion.postToAllGroups=!1),this.newDiscussion.subject=e.subject,this.newDiscussion.message=e.message,this.newDiscussion.subscribe=!!e.options.discussionsubscribe,this.newDiscussion.pin=!!e.options.discussionpinned,this.messageControl.setValue(e.message),yield this.calculateGroupName(),"object"==typeof e.options.attachmentsid&&e.options.attachmentsid.offline){const e=yield v.a.getNewDiscussionStoredFiles(this.forumId,this.timeCreated);this.newDiscussion.files=e}(!this.newDiscussion.subscribe||this.newDiscussion.pin||this.newDiscussion.files.length||this.groups.length>0&&this.newDiscussion.groupId!=this.groups[0].id||this.newDiscussion.postToAllGroups)&&(this.advanced=!0)})))))))),this.originalData||(this.originalData={subject:this.newDiscussion.subject,message:this.newDiscussion.message,files:this.newDiscussion.files.slice()}),this.showForm=!0,this.logView()}catch(e){_.a.showErrorModalDefault(e,"addon.mod_forum.errorgetgroups",!0),this.showForm=!1}}))}validateVisibleGroups(e){return Object(a.a)(this,void 0,void 0,(function*(){let o;try{o=yield h.a.canAddDiscussionToAll(this.forumId,{cmId:this.cmId})}catch(e){o={status:!1,canpindiscussions:!1,cancreateattachment:!0}}if(this.canPin=!!o.canpindiscussions,this.canCreateAttachments=!!o.cancreateattachment,o.status)return this.addAllParticipantsOption(e,!1);const s=[],i=[];return e.forEach((e=>{s.push(h.a.instance.canAddDiscussion(this.forumId,e.id,{cmId:this.cmId}).catch((()=>({status:!0}))).then((o=>{o.status&&i.push(e)})))})),yield Promise.all(s),i}))}filterGroups(e,o){const s=o.map((e=>e.id));return e.filter((e=>s.indexOf(e.id)>-1))}getInitialGroupId(){return this.initialGroupId&&this.groups.find((e=>e.id===this.initialGroupId))?this.initialGroupId:this.groups[0].id}addAllParticipantsOption(e,o){let s;return s=o?h.a.canAddDiscussionToAll(this.forumId,{cmId:this.cmId}).then((e=>(this.canPin=!!e.canpindiscussions,this.canCreateAttachments=!!e.cancreateattachment,e.status))).catch((()=>!1)):Promise.resolve(!0),s.then((o=>(o&&e.unshift({courseid:this.courseId,id:h.b.ALL_PARTICIPANTS,name:w.I.instant("core.allparticipants")}),e)))}refreshGroups(e){const o=[l.a.invalidateActivityGroupMode(this.cmId),l.a.invalidateActivityAllowedGroups(this.cmId),h.a.invalidateCanAddDiscussion(this.forumId)];Promise.all(o).finally((()=>{this.fetchDiscussionData(!0).finally((()=>{null==e?void 0:e.complete()}))}))}returnToDiscussions(e,o){var s;this.forceLeave=!0,M.a.clearTmpFiles(this.newDiscussion.files),u.b.trigger(h.b.NEW_DISCUSSION_EVENT,{forumId:this.forumId,cmId:this.cmId,discussionIds:e,discTimecreated:o,groupId:this.showGroups&&!this.newDiscussion.postToAllGroups?this.newDiscussion.groupId:void 0},f.b.getCurrentSiteId()),(null===(s=this.splitView)||void 0===s?void 0:s.outletActivated)?(this.hasOffline=!1,this.newDiscussion.subject="",this.newDiscussion.message=null,this.newDiscussion.files=[],this.newDiscussion.postToAllGroups=!1,this.messageEditor.clearText(),this.originalData=b.a.clone(this.newDiscussion)):m.a.back()}onMessageChange(e){this.newDiscussion.message=null!=e?e:null}add(){return Object(a.a)(this,void 0,void 0,(function*(){const e=this.forum.name,o=this.newDiscussion.subject;let s=this.newDiscussion.message||"";const i=this.newDiscussion.pin,n=this.newDiscussion.files,t=this.timeCreated||Date.now(),c={discussionsubscribe:!!this.newDiscussion.subscribe};if(!o)return _.a.showErrorModal("addon.mod_forum.erroremptysubject",!0),void 0;if(!s)return _.a.showErrorModal("addon.mod_forum.erroremptymessage",!0),void 0;const d=yield _.a.showModalLoading("core.sending",!0);s=P.b.formatHtmlLines(s),i&&(c.discussionpinned=!0);const a=this.newDiscussion.postToAllGroups?this.groupIds:[this.newDiscussion.groupId];try{const i=yield v.a.addNewDiscussion(this.forumId,e,this.courseId,o,s,n,c,a,t);i&&(v.a.deleteNewDiscussionStoredFiles(this.forumId,t),u.b.trigger(u.b.ACTIVITY_DATA_SENT,{module:"forum"})),i&&i.length<a.length&&_.a.showErrorModalDefault(null,"addon.mod_forum.errorposttoallgroups",!0),A.a.triggerFormSubmittedEvent(this.formElement,!!i,f.b.getCurrentSiteId()),this.returnToDiscussions(i,t)}catch(e){_.a.showErrorModalDefault(e,"addon.mod_forum.cannotcreatediscussion",!0)}finally{d.dismiss()}}))}discard(){return Object(a.a)(this,void 0,void 0,(function*(){try{yield _.a.showConfirm(w.I.instant("core.areyousure"));const e=[];e.push(I.a.deleteNewDiscussion(this.forumId,this.timeCreated)),e.push(b.a.ignoreErrors(v.a.deleteNewDiscussionStoredFiles(this.forumId,this.timeCreated))),yield Promise.all(e),A.a.triggerFormCancelledEvent(this.formElement,f.b.getCurrentSiteId()),this.returnToDiscussions()}catch(e){}}))}toggleAdvanced(){this.advanced=!this.advanced}calculateGroupName(){var e;return Object(a.a)(this,void 0,void 0,(function*(){if(this.newDiscussion.groupId<=0)this.postInGroupMessage=void 0;else{const o=null===(e=this.groups.find((e=>e.id===this.newDiscussion.groupId)))||void 0===e?void 0:e.name;this.postInGroupMessage=o&&w.I.instant("addon.mod_forum.postingroup",{groupname:o})}}))}canLeave(){return Object(a.a)(this,void 0,void 0,(function*(){return this.forceLeave||(v.a.hasPostDataChanged(this.newDiscussion,this.originalData)&&(yield _.a.showConfirm(w.I.instant("core.confirmcanceledit"))),M.a.clearTmpFiles(this.newDiscussion.files),this.formElement&&A.a.triggerFormCancelledEvent(this.formElement,f.b.getCurrentSiteId())),!0}))}ionViewWillLeave(){this.syncObserver&&this.syncObserver.off(),delete this.syncObserver}goBack(){var e;(null===(e=this.splitView)||void 0===e?void 0:e.outletActivated)?m.a.navigate("../../"):m.a.back()}ngOnDestroy(){var e;this.syncId&&D.a.unblockOperation(h.b.COMPONENT,this.syncId),this.isDestroyed=!0,null===(e=this.discussions)||void 0===e||e.destroy()}}return AddonModForumNewDiscussionPage.ɵfac=function AddonModForumNewDiscussionPage_Factory(e){return new(e||AddonModForumNewDiscussionPage)(T.yc(i.a),T.yc(F.a,8))},AddonModForumNewDiscussionPage.ɵcmp=T.sc({type:AddonModForumNewDiscussionPage,selectors:[["page-addon-mod-forum-new-discussion"]],viewQuery:function AddonModForumNewDiscussionPage_Query(e,o){var s;(1&e&&(T.ud(q,!0),T.ud(g.a,!0)),2&e)&&(T.dd(s=T.Nc())&&(o.formElement=s.first),T.dd(s=T.Nc())&&(o.messageEditor=s.first))},decls:16,vars:13,consts:[["slot","start"],[3,"text"],["slot","end"],[3,"core-swipe-navigation"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[4,"ngIf"],["newDiscFormEl",""],["position","stacked"],["type","text","name","subject",3,"ngModel","placeholder","ngModelChange"],["name","addon_mod_forum_new_discussion","contextLevel","module","elementId","message",3,"control","placeholder","component","componentId","autoSave","contextInstanceId","contentChanged"],["button","","detail","false","role","heading","aria-controls","addon-mod-forum-new-discussion-advanced",1,"divider","ion-text-wrap",3,"click"],["name","fas-chevron-right","flip-rtl","","slot","start","aria-hidden","true",1,"expandable-status-icon"],["id","addon-mod-forum-new-discussion-advanced",4,"ngIf"],["class","addon-forum-group-info",4,"ngIf"],[1,"addon-forum-new-discussion-buttons"],["expand","block",3,"disabled","click"],["id","addon-mod-forum-new-discussion-advanced"],["class","core-edit-set-group",4,"ngIf"],["name","subscribe",3,"ngModel","ngModelChange"],[3,"files","maxSize","maxSubmissions","component","componentId","allowOffline","courseId",4,"ngIf"],["name","postallgroups",3,"ngModel","ngModelChange"],[1,"core-edit-set-group"],["interface","action-sheet","name","groupid",3,"ngModel","disabled","interfaceOptions","cancelText","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["contextLevel","course",3,"text","contextInstanceId","wsNotFiltered"],["name","pin",3,"ngModel","ngModelChange"],[3,"files","maxSize","maxSubmissions","component","componentId","allowOffline","courseId"],[1,"addon-forum-group-info"],["name","fas-circle-info","slot","start","aria-hidden","true"],["expand","block","fill","outline",3,"click"]],template:function AddonModForumNewDiscussionPage_Template(e,o){1&e&&(T.Ec(0,"ion-header"),T.Ec(1,"ion-toolbar"),T.Ec(2,"ion-buttons",0),T.zc(3,"ion-back-button",1),T.Pc(4,"translate"),T.Dc(),T.Ec(5,"ion-title"),T.Ec(6,"h1"),T.pd(7),T.Pc(8,"translate"),T.Dc(),T.Dc(),T.zc(9,"ion-buttons",2),T.Dc(),T.Dc(),T.Ec(10,"ion-content",3),T.Ec(11,"ion-refresher",4),T.Mc("ionRefresh",(function AddonModForumNewDiscussionPage_Template_ion_refresher_ionRefresh_11_listener(e){return o.refreshGroups(e.target)})),T.zc(12,"ion-refresher-content",5),T.Pc(13,"translate"),T.Dc(),T.Ec(14,"core-loading",6),T.nd(15,AddonModForumNewDiscussionPage_form_15_Template,31,34,"form",7),T.Dc(),T.Dc()),2&e&&(T.lc(3),T.Vc("text",T.Qc(4,7,"core.back")),T.lc(4),T.qd(T.Qc(8,9,"addon.mod_forum.addanewdiscussion")),T.lc(3),T.Vc("core-swipe-navigation",o.discussions),T.lc(1),T.Vc("disabled",!o.groupsLoaded),T.lc(1),T.Wc("pullingText",T.Qc(13,11,"core.pulltorefresh")),T.lc(2),T.Vc("hideUntil",o.groupsLoaded),T.lc(1),T.Vc("ngIf",o.showForm))},directives:[S.C,S.Ab,S.m,S.h,S.i,S.yb,G.a,S.v,x.a,S.bb,S.cb,V.a,j.t,r.H,r.s,r.t,S.I,S.O,S.H,S.Pb,r.r,r.u,g.a,S.D,L.a,S.hb,S.u,k.a,S.l,S.zb,S.d,S.lb,S.Ob,j.s,S.mb,R.a,z.a],pipes:[Q.d],styles:["[_nghost-%COMP%]   .addon-forum-group-info[_ngcontent-%COMP%] > ion-icon[slot][_ngcontent-%COMP%]{color:var(--ion-color-info);margin-right:16px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){[_nghost-%COMP%]   .addon-forum-group-info[_ngcontent-%COMP%] > ion-icon[slot][_ngcontent-%COMP%]{margin-right:unset;-webkit-margin-end:16px;margin-inline-end:16px}}[_nghost-%COMP%]   .addon-forum-new-discussion-buttons[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin-top:0}[_nghost-%COMP%]   .addon-forum-new-discussion-buttons[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding-top:0;padding-bottom:0}"]}),AddonModForumNewDiscussionPage})();class new_discussion_AddonModForumNewDiscussionDiscussionsSwipeManager extends y.a{getSelectedItemPathFromRoute(e){return`${this.getSource().DISCUSSIONS_PATH_PREFIX}new/${e.params.timeCreated}`}}const U=[{path:"",component:B,canDeactivate:[t.a]}];let H=(()=>{class AddonForumNewDiscussionLazyModule{}return AddonForumNewDiscussionLazyModule.ɵmod=T.wc({type:AddonForumNewDiscussionLazyModule}),AddonForumNewDiscussionLazyModule.ɵinj=T.vc({factory:function AddonForumNewDiscussionLazyModule_Factory(e){return new(e||AddonForumNewDiscussionLazyModule)},imports:[[i.m.forChild(U),d.a,n.a,c.a]]}),AddonForumNewDiscussionLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&T.kd(H,{declarations:[B],imports:[i.m,d.a,n.a,c.a]}))}}]);