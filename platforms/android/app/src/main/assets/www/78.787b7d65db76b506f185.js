(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{agUm:function(e,o,s){"use strict";s.r(o),s.d(o,"CoreCoursesDashboardLazyModule",(function(){return V}));var a=s("tyNb"),r=s("L3Fv"),t=s("5p9q"),n=s("mrSG"),i=s("Xzvb"),c=s("fjkH"),l=s("9+EE"),d=s("OYIH"),u=s("3LXp"),b=s("mSZx"),h=s("pHTc"),_=s("6akD"),C=s("8vmT"),g=s("D7J2"),p=s("j3ag"),m=s("bFG1"),f=s("fXoL"),D=s("ACV2"),k=s("ofXK"),v=s("nt/U"),y=s("TEn/"),I=s("PgjG"),P=s("ACYt"),w=s("3CSS"),S=s("aSim"),E=s("r8G5"),T=s("sYmb");function CoreCoursesDashboardPage_ion_button_1_Template(e,o){if(1&e){const e=f.Fc();f.Ec(0,"ion-button",8),f.Mc("click",(function CoreCoursesDashboardPage_ion_button_1_Template_ion_button_click_0_listener(){f.fd(e);return f.Oc().openSearch()})),f.Pc(1,"translate"),f.zc(2,"ion-icon",9),f.Dc()}2&e&&f.mc("aria-label",f.Qc(1,1,"core.courses.searchcourses"))}function CoreCoursesDashboardPage_ion_list_7_ng_container_1_core_block_1_Template(e,o){if(1&e&&f.zc(0,"core-block",13),2&e){const e=f.Oc().$implicit,o=f.Oc(2);f.Vc("block",e)("instanceId",o.userId)}}function CoreCoursesDashboardPage_ion_list_7_ng_container_1_Template(e,o){if(1&e&&(f.Cc(0),f.nd(1,CoreCoursesDashboardPage_ion_list_7_ng_container_1_core_block_1_Template,1,2,"core-block",12),f.Bc()),2&e){const e=o.$implicit;f.lc(1),f.Vc("ngIf",e.visible)}}function CoreCoursesDashboardPage_ion_list_7_Template(e,o){if(1&e&&(f.Ec(0,"ion-list",10),f.nd(1,CoreCoursesDashboardPage_ion_list_7_ng_container_1_Template,2,1,"ng-container",11),f.Dc()),2&e){const e=f.Oc();f.lc(1),f.Vc("ngForOf",e.blocks)}}function CoreCoursesDashboardPage_core_block_side_blocks_button_8_Template(e,o){if(1&e&&f.zc(0,"core-block-side-blocks-button",14),2&e){const e=f.Oc();f.Vc("instanceId",e.userId)}}function CoreCoursesDashboardPage_core_empty_box_9_Template(e,o){1&e&&(f.zc(0,"core-empty-box",15),f.Pc(1,"translate")),2&e&&f.Vc("message",f.Qc(1,1,"core.course.nocontentavailable"))}let B=(()=>{class CoreCoursesDashboardPage{constructor(){this.hasMainBlocks=!1,this.hasSideBlocks=!1,this.searchEnabled=!1,this.downloadCourseEnabled=!1,this.downloadCoursesEnabled=!1,this.blocks=[],this.loaded=!1,this.updateSiteObserver=c.b.on(c.b.SITE_UPDATED,(()=>{this.searchEnabled=!i.a.isSearchCoursesDisabledInSite(),this.downloadCourseEnabled=!i.a.isDownloadCourseDisabledInSite(),this.downloadCoursesEnabled=!i.a.isDownloadCoursesDisabledInSite()}),l.b.getCurrentSiteId()),this.logView=C.a.once((()=>Object(n.a)(this,void 0,void 0,(function*(){yield m.a.ignoreErrors(i.a.logView("dashboard")),g.a.logEvent({type:g.b.VIEW_ITEM,ws:"core_my_view_page",name:p.I.instant("core.courses.mymoodle"),data:{category:"course",page:"dashboard"},url:"/my/"})}))))}ngOnInit(){this.searchEnabled=!i.a.isSearchCoursesDisabledInSite(),this.downloadCourseEnabled=!i.a.isDownloadCourseDisabledInSite(),this.downloadCoursesEnabled=!i.a.isDownloadCoursesDisabledInSite(),this.loadContent()}loadContent(){return Object(n.a)(this,void 0,void 0,(function*(){const e=yield d.a.isAvailable(),o=yield d.a.isDisabled();if(e&&!o){this.userId=l.b.getCurrentSiteUserId();try{const e=yield d.a.getDashboardBlocks();this.blocks=e.mainBlocks,this.hasMainBlocks=_.a.hasSupportedBlock(e.mainBlocks),this.hasSideBlocks=_.a.hasSupportedBlock(e.sideBlocks)}catch(e){u.a.showErrorModal(e),this.loadFallbackBlocks()}}else e?this.blocks=[]:this.loadFallbackBlocks();this.loaded=!0,this.logView()}))}loadFallbackBlocks(){this.blocks=[{name:"myoverview",visible:!0},{name:"timeline",visible:!0}],this.hasMainBlocks=_.a.isBlockSupported("myoverview")||_.a.isBlockSupported("timeline")}refreshDashboard(e){var o;const s=[];s.push(d.a.invalidateDashboardBlocks()),null===(o=this.blocksComponents)||void 0===o||o.forEach((e=>{s.push(e.invalidate().catch((()=>{})))})),Promise.all(s).finally((()=>{this.loadContent().finally((()=>{null==e?void 0:e.complete()}))}))}openSearch(){return Object(n.a)(this,void 0,void 0,(function*(){h.a.navigateToSitePath("/courses/list",{params:{mode:"search"}})}))}ngOnDestroy(){this.updateSiteObserver.off()}}return CoreCoursesDashboardPage.ɵfac=function CoreCoursesDashboardPage_Factory(e){return new(e||CoreCoursesDashboardPage)},CoreCoursesDashboardPage.ɵcmp=f.sc({type:CoreCoursesDashboardPage,selectors:[["page-core-courses-dashboard"]],viewQuery:function CoreCoursesDashboardPage_Query(e,o){var s;(1&e&&f.ud(b.a,!0),2&e)&&(f.dd(s=f.Nc())&&(o.blocksComponents=s))},decls:10,vars:9,consts:[["slot","end","prepend",""],[3,"click",4,"ngIf"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["class","list-item-limited-width",4,"ngIf"],["slot","fixed","contextLevel","user",3,"instanceId",4,"ngIf"],["icon","fas-cubes",3,"message",4,"ngIf"],[3,"click"],["name","fas-magnifying-glass","slot","icon-only","aria-hidden","true"],[1,"list-item-limited-width"],[4,"ngFor","ngForOf"],["contextLevel","user",3,"block","instanceId",4,"ngIf"],["contextLevel","user",3,"block","instanceId"],["slot","fixed","contextLevel","user",3,"instanceId"],["icon","fas-cubes",3,"message"]],template:function CoreCoursesDashboardPage_Template(e,o){1&e&&(f.Ec(0,"core-navbar-buttons",0),f.nd(1,CoreCoursesDashboardPage_ion_button_1_Template,3,3,"ion-button",1),f.Dc(),f.Ec(2,"ion-content"),f.Ec(3,"ion-refresher",2),f.Mc("ionRefresh",(function CoreCoursesDashboardPage_Template_ion_refresher_ionRefresh_3_listener(e){return o.refreshDashboard(e.target)})),f.zc(4,"ion-refresher-content",3),f.Pc(5,"translate"),f.Dc(),f.Ec(6,"core-loading",4),f.nd(7,CoreCoursesDashboardPage_ion_list_7_Template,2,1,"ion-list",5),f.nd(8,CoreCoursesDashboardPage_core_block_side_blocks_button_8_Template,1,1,"core-block-side-blocks-button",6),f.nd(9,CoreCoursesDashboardPage_core_empty_box_9_Template,2,3,"core-empty-box",7),f.Dc(),f.Dc()),2&e&&(f.lc(1),f.Vc("ngIf",o.searchEnabled),f.lc(2),f.Vc("disabled",!o.loaded),f.lc(1),f.Wc("pullingText",f.Qc(5,7,"core.pulltorefresh")),f.lc(2),f.Vc("hideUntil",o.loaded),f.lc(1),f.Vc("ngIf",o.hasMainBlocks),f.lc(1),f.Vc("ngIf",o.hasSideBlocks),f.lc(1),f.Vc("ngIf",!o.hasMainBlocks))},directives:[D.a,k.t,v.a,y.v,y.bb,y.cb,I.a,P.a,y.l,y.D,w.a,y.P,k.s,b.a,S.a,E.a],pipes:[T.d],encapsulation:2}),CoreCoursesDashboardPage})();const M=[{path:"",component:B}];let V=(()=>{class CoreCoursesDashboardLazyModule{}return CoreCoursesDashboardLazyModule.ɵmod=f.wc({type:CoreCoursesDashboardLazyModule}),CoreCoursesDashboardLazyModule.ɵinj=f.vc({factory:function CoreCoursesDashboardLazyModule_Factory(e){return new(e||CoreCoursesDashboardLazyModule)},imports:[[a.m.forChild(M),r.a,t.a],a.m]}),CoreCoursesDashboardLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&f.kd(V,{declarations:[B],imports:[a.m,r.a,t.a],exports:[a.m]}))}}]);